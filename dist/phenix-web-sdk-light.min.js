/**
 * Copyright 2018 PhenixP2P Inc. All Rights Reserved.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define("phenix-web-sdk",[],e):"object"==typeof exports?exports["phenix-web-sdk"]=e():t["phenix-web-sdk"]=e()}(window,function(){return function(t){var e={};function n(i){if(e[i])return e[i].exports;var r=e[i]={i:i,l:!1,exports:{}};return t[i].call(r.exports,r,r.exports,n),r.l=!0,r.exports}return n.m=t,n.c=e,n.d=function(t,e,i){n.o(t,e)||Object.defineProperty(t,e,{configurable:!1,enumerable:!0,get:i})},n.r=function(t){Object.defineProperty(t,"__esModule",{value:!0})},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=86)}([function(t,e,n){var i,r;i=[n(85)],void 0===(r=function(t){"use strict";return t}.apply(e,i))||(t.exports=r)},function(t,e,n){var i,r;i=[n(82)],void 0===(r=function(t){return t}.apply(e,i))||(t.exports=r)},function(t,e,n){var i,r,s,o,a,u;t.exports=(i=n(0),r=n(84),s=n(1),o=n(3),a=n(7),u=n(4),function(t){function e(i){if(n[i])return n[i].exports;var r=n[i]={i:i,l:!1,exports:{}};return t[i].call(r.exports,r,r.exports,e),r.l=!0,r.exports}var n={};return e.m=t,e.c=n,e.i=function(t){return t},e.d=function(t,n,i){e.o(t,n)||Object.defineProperty(t,n,{configurable:!1,enumerable:!0,get:i})},e.n=function(t){var n=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(n,"a",n),n},e.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},e.p="",e(e.s=12)}([function(t,e,n){(function(n){var i;void 0===(i=function(){"use strict";return"object"==typeof window?window:"object"==typeof n?n:{}}.apply(e,[]))||(t.exports=i)}).call(e,n(5))},function(t,e){t.exports=i},function(t,e){t.exports=r},function(t,e,n){var i,r;i=[n(1),n(7),n(4),n(0),n(13)],void 0===(r=function(t,e,n,i,r){"use strict";function s(t,i,r,s){var a=this;this.t=t,this.e=i,this.a="phenix"===r,this.u="flash"===r,this.h=s||{},this.f={},this.v=new e.DisposableList,this.g=null;var u=function(t){a.y=!0,a.w=!0===t,t?c.call(a):p("Failed to create Phenix video element"),a.b&&a.b(a.w)};try{if(this.k=o.call(this),this.k.className=this.t.className,this.k.height=this.t.height,this.k.width=this.t.width,this.S=this.t.style.cssText,this.t.style.cssText="visibility:hidden !important;width:0px !important;height:0px !important;margin:0px !important;padding:0px !important;border-style:none !important;border-width:0px !important;max-width:0px !important;max-height:0px !important;outline:none !important",this.v.add(new e.Disposable(function(){a.t.style.cssText=a.S})),this.k.onunload=function(){a.y=!1},f.call(this),document.body&&document.body.contains||l("document.body.contains is not supported"),document.body&&document.body.contains&&document.body.contains(this.t)&&(this.t.parentNode.replaceChild(this.k,this.t),this.u&&this.g&&(this.k=this.g.finishInitializationInDom()),this.v.add(new e.Disposable(function(){a.k.parentNode&&a.k.parentNode.replaceChild(a.t,a.k)}))),!this.a)return u(!0);(new n).waitForReady(this.k,u)}catch(t){p("Error while loading Phenix RTC"+t),u(!1)}}function o(){var t=document.createElement("video");if(this.a&&((t=document.createElement("object")).type="application/x-phenix-video"),this.u){this.g=new r(this.t,this.e,this.h);var n=this;this.v.add(new e.Disposable(function(){n.g.destroy()})),t=this.g.getElement()}return t}function a(t){var e=this;e.k.phenixSetEventListener(t,function(){var n=e.f[t];if(n)for(var i=0;i<n.length;i++)n[i].apply(e,arguments)})}function u(t,e){var n;document.createEvent?(n=document.createEvent("HTMLEvents")).initEvent(e,!0,!0):(n=document.createEventObject()).eventType=e,n.eventName=e,setTimeout(function(){document.createEvent?t.dispatchEvent(n):t.fireEvent("on"+n.eventType,n)})}function c(){for(var t=Object.keys(this.f),e=0;e<t.length;e++)a.call(this,t[e]);this.hookUpEvents(),h.call(this),this.k.id=this.t.id,this.k.style.cssText=this.S,this.k.className=this.t.className,this.k.innerHtml=this.t.innerHtml,this.k.width=this.t.width,this.k.height=this.t.height,this.k.autoplay=this.t.autoplay,this.k.muted=this.t.muted,this.k.defaultMuted=this.t.defaultMuted,this.k.volume=this.t.volume,this.e&&!this.u&&(this.k.src=this.e)}function h(){var n=this,r=["style"];if(t.get(i,["MutationObserver"])){var s=new MutationObserver(function(t){t.forEach(function(t){"attributes"===t.type&&t.target===n.t&&-1===r.indexOf(t.attributeName)&&(n.k[t.attributeName]=n.t[t.attributeName])})});s.observe(n.t,{attributes:!0}),n.v.add(new e.Disposable(function(){s.disconnect()}))}else{l("Falling back to use of DOM event listeners. This results in degraded performance for further DOM modifications and does not work for IE prior to version 9. See https://developer.mozilla.org/en-US/docs/Web/Guide/Events/Mutation_events for details.");var o=function(t){n.k[t.target.tagName]=n.t[t.target.tagName]};n.t.addEventListener?(n.t.addEventListener("DOMAttrModified",o,!1),n.v.add(new e.Disposable(function(){n.t.removeEventListener("DOMAttrModified",o,!1)}))):(n.t.attachEvent("onpropertychange",o),n.v.add(new e.Disposable(function(){n.t.detachEvent("DOMAttrModified",o)})))}}function f(){var n=this;if(t.get(i,["MutationObserver"])){var r=new MutationObserver(function(t){t.forEach(function(t){if("childList"===t.type)for(var e=0;e<t.addedNodes.length;e++){var i=t.addedNodes[e];t.target!==n.k&&(i===n.t?(t.target.replaceChild(n.k,n.t),c.call(n)):d(t.target,n.t)&&(n.t.parentNode&&n.t.parentNode.replaceChild(n.k,n.t),c.call(n)))}})});r.observe(document.body,{childList:!0,attributes:!1,characterData:!1,subtree:!0}),n.v.add(new e.Disposable(function(){r.disconnect()}))}else{l("Falling back to use of DOM event listeners. This results in degraded performance for further DOM modifications and does not work for IE prior to version 9. See https://developer.mozilla.org/en-US/docs/Web/Guide/Events/Mutation_events for details.");var s=function(){n.t.parentNode&&n.t.parentNode.replaceChild(n.k,n.t)};n.addEventListener("DOMNodeInserted",s,!1),n.v.add(new e.Disposable(function(){n.removeEventListener("DOMNodeInserted",s,!1)}))}}function d(t,e){for(var n=e.parentNode;null!==n;){if(n===t)return!0;n=n.parentNode}return!1}var l=function(){console.log.apply(console,arguments)}||function(){},p=function(){console.error.apply(console,arguments)}||l;return s.prototype.hookUpEvents=function(){var t=this,n=this.t,i=function(){u(n,"error")},r=function(){n.muted=t.k.muted,u(n,"mute")},s=function(){n.muted=t.k.muted,u(n,"unmute")},o=function(){n.ended=t.k.ended,u(n,"ended")},a=function(){n.width=t.k.width,n.height=t.k.height,u(n,"loadedmetadata")},c=function(){n.width=t.k.width,n.height=t.k.height,u(n,"loadeddata")},h=function(){n.width=t.k.width,n.height=t.k.height,u(n,"resize")};this.addEventListener("error",i),this.addEventListener("mute",r),this.addEventListener("unmute",s),this.addEventListener("ended",o),this.addEventListener("loadedmetadata",a),this.addEventListener("loadeddata",c),this.addEventListener("resize",h);var f=new e.Disposable(function(){t.removeEventListener("error",i),t.removeEventListener("mute",r),t.removeEventListener("unmute",s),t.removeEventListener("ended",o),t.removeEventListener("loadedmetadata",a),t.removeEventListener("loadeddata",c),t.removeEventListener("resize",h)});return this.v.add(f),f},s.prototype.onReady=function(t){var e=this;this.y?setTimeout(function(){t(e.w)},1):this.b=t},s.prototype.getElement=function(){return this.k},s.prototype.addEventListener=function(t,e,n){(function(t,e,n){if(this.u)return this.g.addEventListener(t,e);if(this.a){var i=this.f[t];return i||(i=this.f[t]=[],this.y&&a.call(this,t)),i.push(e)}return this.k.addEventListener(t,e,n)}).call(this,t,e,n)},s.prototype.removeEventListener=function(t,e,n){(function(t,e,n){if(this.u)return this.g.removeEventListener(t,e);if(!this.a)return this.k.removeEventListener(t,e,n);var i=this.f[t];if(i){var r=i.indexOf(e);r>=0&&((i=i.splice(r,1)).length>0?this.f[t]=i:delete this.f[t])}}).call(this,t,e,n)},s.prototype.destroy=function(){this.v.dispose()},s}.apply(e,i))||(t.exports=r)},function(t,e,n){var i,r;i=[n(2)],void 0===(r=function(t){"use strict";function e(t){this.I=t||15e3}var n=new t(navigator.userAgent).detect(),i=function(){console.error.apply(console,arguments)}||console.log;return e.prototype.waitForReadyWithTimeout=function(t,e,r){var s=!1,o=1,a=o,u=function(t){s||(s=!0,e(t))};t.hasOwnProperty&&t.hasOwnProperty("onload")||"IE"!==n.browser&&i("No means of detecting when <object> is loaded"),t.onload=function(){u(!0)},function e(){4===t.readyState?u(!0):t.phenixVersion?u(!0):(o=Math.min(o+1e3,2*o),(a+=o)>r?(i("Timed out while waiting for <object> to load"),u(!1)):setTimeout(e,o))}()},e.prototype.waitForReady=function(t,e){t.phenixVersion?e(!0):this.waitForReadyWithTimeout(t,e,this.I)},e}.apply(e,i))||(t.exports=r)},function(t,e){var n;n=function(){return this}();try{n=n||Function("return this")()||(0,eval)("this")}catch(t){"object"==typeof window&&(n=window)}t.exports=n},function(t,e){t.exports=s},function(t,e){t.exports=o},function(t,e){t.exports=a},function(t,e,n){var i,r;i=[n(1),n(6),n(8),n(2),n(0),n(15),n(14)],void 0===(r=function(t,e,n,i,r,s,o){"use strict";function a(){if(t.assign(c,s()),o.isSupported()){c.phenixSupported=!0;var e=new o,n=function(){c.RTCPeerConnection=e.getRTCPeerConnectionConstructor(),c.RTCSessionDescription=e.getRTCSessionDescriptionConstructor(),c.RTCIceCandidate=e.getRTCIceCandidateConstructor(),c.getSources=e.getSourcesDelegate(),c.getUserMedia=e.getUserMediaDelegate(),c.getStats=e.getStatsDelegate(),Function.prototype.bind?(c.attachMediaStream=e.attachMediaStream.bind(e),c.reattachMediaStream=e.reattachMediaStream.bind(e),c.isPhenixEnabled=e.isEnabled.bind(e)):(c.attachMediaStream=function(){e.attachMediaStream.apply(e,arguments)},c.reattachMediaStream=function(){e.reattachMediaStream.apply(e,arguments)},c.isPhenixEnabled=function(){return e.isEnabled()}),c.webrtcSupported=!0,c.phenixSupported=!0,c.phenixVersion=e.getVersion(),c.onLoaded&&c.onLoaded.call()};e.isEnabled()?n():e.onReady(function(t){t&&(n(),c.onload&&"function"==typeof c.onload&&c.onload())}),e.onLoaded(function(){n()})}else c.phenixSupported=!1;return c}var u=new i(navigator.userAgent).detect(),c={browser:u.browser,browserVersion:u.version,phenixSupported:!1,isPhenixEnabled:function(){return!1},onLoaded:void 0,global:r};return t.assign(a(),{shim:a})}.apply(e,i))||(t.exports=r)},function(t,e,n){var i,r;i=[n(0)],void 0===(r=function(t){"use strict";return function(e){t.RTCPeerConnection=e.RTCPeerConnection,t.RTCSessionDescription=e.RTCSessionDescription,t.RTCIceCandidate=e.RTCIceCandidate}}.apply(e,i))||(t.exports=r)},function(t,e,n){(function(e){var n;!function(e){t.exports=e()}(function(){return function t(e,i,r){function s(a,u){if(!i[a]){if(!e[a]){if(!u&&("function"==typeof n&&n))return n(a,!0);if(o)return n(a,!0);var c=new Error("Cannot find module '"+a+"'");throw c.code="MODULE_NOT_FOUND",c}var h=i[a]={exports:{}};e[a][0].call(h.exports,function(t){return s(e[a][1][t]||t)},h,h.exports,t,e,i,r)}return i[a].exports}for(var o="function"==typeof n&&n,a=0;a<r.length;a++)s(r[a]);return s}({1:[function(t,e,n){},{}],2:[function(t,e,n){"use strict";var i={generateIdentifier:function(){return Math.random().toString(36).substr(2,10)}};i.localCName=i.generateIdentifier(),i.splitLines=function(t){return t.trim().split("\n").map(function(t){return t.trim()})},i.splitSections=function(t){return t.split("\nm=").map(function(t,e){return(e>0?"m="+t:t).trim()+"\r\n"})},i.getDescription=function(t){var e=i.splitSections(t);return e&&e[0]},i.getMediaSections=function(t){var e=i.splitSections(t);return e.shift(),e},i.matchPrefix=function(t,e){return i.splitLines(t).filter(function(t){return 0===t.indexOf(e)})},i.parseCandidate=function(t){for(var e,n={foundation:(e=0===t.indexOf("a=candidate:")?t.substring(12).split(" "):t.substring(10).split(" "))[0],component:parseInt(e[1],10),protocol:e[2].toLowerCase(),priority:parseInt(e[3],10),ip:e[4],port:parseInt(e[5],10),type:e[7]},i=8;i<e.length;i+=2)switch(e[i]){case"raddr":n.relatedAddress=e[i+1];break;case"rport":n.relatedPort=parseInt(e[i+1],10);break;case"tcptype":n.tcpType=e[i+1];break;case"ufrag":n.ufrag=e[i+1],n.usernameFragment=e[i+1];break;default:n[e[i]]=e[i+1]}return n},i.writeCandidate=function(t){var e=[];e.push(t.foundation),e.push(t.component),e.push(t.protocol.toUpperCase()),e.push(t.priority),e.push(t.ip),e.push(t.port);var n=t.type;return e.push("typ"),e.push(n),"host"!==n&&t.relatedAddress&&t.relatedPort&&(e.push("raddr"),e.push(t.relatedAddress),e.push("rport"),e.push(t.relatedPort)),t.tcpType&&"tcp"===t.protocol.toLowerCase()&&(e.push("tcptype"),e.push(t.tcpType)),(t.usernameFragment||t.ufrag)&&(e.push("ufrag"),e.push(t.usernameFragment||t.ufrag)),"candidate:"+e.join(" ")},i.parseIceOptions=function(t){return t.substr(14).split(" ")},i.parseRtpMap=function(t){var e=t.substr(9).split(" "),n={payloadType:parseInt(e.shift(),10)};return e=e[0].split("/"),n.name=e[0],n.clockRate=parseInt(e[1],10),n.channels=3===e.length?parseInt(e[2],10):1,n.numChannels=n.channels,n},i.writeRtpMap=function(t){var e=t.payloadType;void 0!==t.preferredPayloadType&&(e=t.preferredPayloadType);var n=t.channels||t.numChannels||1;return"a=rtpmap:"+e+" "+t.name+"/"+t.clockRate+(1!==n?"/"+n:"")+"\r\n"},i.parseExtmap=function(t){var e=t.substr(9).split(" ");return{id:parseInt(e[0],10),direction:e[0].indexOf("/")>0?e[0].split("/")[1]:"sendrecv",uri:e[1]}},i.writeExtmap=function(t){return"a=extmap:"+(t.id||t.preferredId)+(t.direction&&"sendrecv"!==t.direction?"/"+t.direction:"")+" "+t.uri+"\r\n"},i.parseFmtp=function(t){for(var e,n={},i=t.substr(t.indexOf(" ")+1).split(";"),r=0;r<i.length;r++)n[(e=i[r].trim().split("="))[0].trim()]=e[1];return n},i.writeFmtp=function(t){var e="",n=t.payloadType;if(void 0!==t.preferredPayloadType&&(n=t.preferredPayloadType),t.parameters&&Object.keys(t.parameters).length){var i=[];Object.keys(t.parameters).forEach(function(e){t.parameters[e]?i.push(e+"="+t.parameters[e]):i.push(e)}),e+="a=fmtp:"+n+" "+i.join(";")+"\r\n"}return e},i.parseRtcpFb=function(t){var e=t.substr(t.indexOf(" ")+1).split(" ");return{type:e.shift(),parameter:e.join(" ")}},i.writeRtcpFb=function(t){var e="",n=t.payloadType;return void 0!==t.preferredPayloadType&&(n=t.preferredPayloadType),t.rtcpFeedback&&t.rtcpFeedback.length&&t.rtcpFeedback.forEach(function(t){e+="a=rtcp-fb:"+n+" "+t.type+(t.parameter&&t.parameter.length?" "+t.parameter:"")+"\r\n"}),e},i.parseSsrcMedia=function(t){var e=t.indexOf(" "),n={ssrc:parseInt(t.substr(7,e-7),10)},i=t.indexOf(":",e);return i>-1?(n.attribute=t.substr(e+1,i-e-1),n.value=t.substr(i+1)):n.attribute=t.substr(e+1),n},i.parseSsrcGroup=function(t){var e=t.substr(13).split(" ");return{semantics:e.shift(),ssrcs:e.map(function(t){return parseInt(t,10)})}},i.getMid=function(t){var e=i.matchPrefix(t,"a=mid:")[0];if(e)return e.substr(6)},i.parseFingerprint=function(t){var e=t.substr(14).split(" ");return{algorithm:e[0].toLowerCase(),value:e[1]}},i.getDtlsParameters=function(t,e){return{role:"auto",fingerprints:i.matchPrefix(t+e,"a=fingerprint:").map(i.parseFingerprint)}},i.writeDtlsParameters=function(t,e){var n="a=setup:"+e+"\r\n";return t.fingerprints.forEach(function(t){n+="a=fingerprint:"+t.algorithm+" "+t.value+"\r\n"}),n},i.getIceParameters=function(t,e){var n=i.splitLines(t);return{usernameFragment:(n=n.concat(i.splitLines(e))).filter(function(t){return 0===t.indexOf("a=ice-ufrag:")})[0].substr(12),password:n.filter(function(t){return 0===t.indexOf("a=ice-pwd:")})[0].substr(10)}},i.writeIceParameters=function(t){return"a=ice-ufrag:"+t.usernameFragment+"\r\na=ice-pwd:"+t.password+"\r\n"},i.parseRtpParameters=function(t){for(var e={codecs:[],headerExtensions:[],fecMechanisms:[],rtcp:[]},n=i.splitLines(t)[0].split(" "),r=3;r<n.length;r++){var s=n[r],o=i.matchPrefix(t,"a=rtpmap:"+s+" ")[0];if(o){var a=i.parseRtpMap(o),u=i.matchPrefix(t,"a=fmtp:"+s+" ");switch(a.parameters=u.length?i.parseFmtp(u[0]):{},a.rtcpFeedback=i.matchPrefix(t,"a=rtcp-fb:"+s+" ").map(i.parseRtcpFb),e.codecs.push(a),a.name.toUpperCase()){case"RED":case"ULPFEC":e.fecMechanisms.push(a.name.toUpperCase())}}}return i.matchPrefix(t,"a=extmap:").forEach(function(t){e.headerExtensions.push(i.parseExtmap(t))}),e},i.writeRtpDescription=function(t,e){var n="";n+="m="+t+" ",n+=e.codecs.length>0?"9":"0",n+=" UDP/TLS/RTP/SAVPF ",n+=e.codecs.map(function(t){return void 0!==t.preferredPayloadType?t.preferredPayloadType:t.payloadType}).join(" ")+"\r\n",n+="c=IN IP4 0.0.0.0\r\n",n+="a=rtcp:9 IN IP4 0.0.0.0\r\n",e.codecs.forEach(function(t){n+=i.writeRtpMap(t),n+=i.writeFmtp(t),n+=i.writeRtcpFb(t)});var r=0;return e.codecs.forEach(function(t){t.maxptime>r&&(r=t.maxptime)}),r>0&&(n+="a=maxptime:"+r+"\r\n"),n+="a=rtcp-mux\r\n",e.headerExtensions&&e.headerExtensions.forEach(function(t){n+=i.writeExtmap(t)}),n},i.parseRtpEncodingParameters=function(t){var e,n=[],r=i.parseRtpParameters(t),s=-1!==r.fecMechanisms.indexOf("RED"),o=-1!==r.fecMechanisms.indexOf("ULPFEC"),a=i.matchPrefix(t,"a=ssrc:").map(function(t){return i.parseSsrcMedia(t)}).filter(function(t){return"cname"===t.attribute}),u=a.length>0&&a[0].ssrc,c=i.matchPrefix(t,"a=ssrc-group:FID").map(function(t){return t.substr(17).split(" ").map(function(t){return parseInt(t,10)})});c.length>0&&c[0].length>1&&c[0][0]===u&&(e=c[0][1]),r.codecs.forEach(function(t){if("RTX"===t.name.toUpperCase()&&t.parameters.apt){var i={ssrc:u,codecPayloadType:parseInt(t.parameters.apt,10)};u&&e&&(i.rtx={ssrc:e}),n.push(i),s&&((i=JSON.parse(JSON.stringify(i))).fec={ssrc:e,mechanism:o?"red+ulpfec":"red"},n.push(i))}}),0===n.length&&u&&n.push({ssrc:u});var h=i.matchPrefix(t,"b=");return h.length&&(h=0===h[0].indexOf("b=TIAS:")?parseInt(h[0].substr(7),10):0===h[0].indexOf("b=AS:")?1e3*parseInt(h[0].substr(5),10)*.95-16e3:void 0,n.forEach(function(t){t.maxBitrate=h})),n},i.parseRtcpParameters=function(t){var e={},n=i.matchPrefix(t,"a=ssrc:").map(function(t){return i.parseSsrcMedia(t)}).filter(function(t){return"cname"===t.attribute})[0];n&&(e.cname=n.value,e.ssrc=n.ssrc);var r=i.matchPrefix(t,"a=rtcp-rsize");e.reducedSize=r.length>0,e.compound=0===r.length;var s=i.matchPrefix(t,"a=rtcp-mux");return e.mux=s.length>0,e},i.parseMsid=function(t){var e,n=i.matchPrefix(t,"a=msid:");if(1===n.length)return{stream:(e=n[0].substr(7).split(" "))[0],track:e[1]};var r=i.matchPrefix(t,"a=ssrc:").map(function(t){return i.parseSsrcMedia(t)}).filter(function(t){return"msid"===t.attribute});return r.length>0?{stream:(e=r[0].value.split(" "))[0],track:e[1]}:void 0},i.generateSessionId=function(){return Math.random().toString().substr(2,21)},i.writeSessionBoilerplate=function(t,e){var n=void 0!==e?e:2;return"v=0\r\no=thisisadapterortc "+(t||i.generateSessionId())+" "+n+" IN IP4 127.0.0.1\r\ns=-\r\nt=0 0\r\n"},i.writeMediaSection=function(t,e,n,r){var s=i.writeRtpDescription(t.kind,e);if(s+=i.writeIceParameters(t.iceGatherer.getLocalParameters()),s+=i.writeDtlsParameters(t.dtlsTransport.getLocalParameters(),"offer"===n?"actpass":"active"),s+="a=mid:"+t.mid+"\r\n",s+=t.direction?"a="+t.direction+"\r\n":t.rtpSender&&t.rtpReceiver?"a=sendrecv\r\n":t.rtpSender?"a=sendonly\r\n":t.rtpReceiver?"a=recvonly\r\n":"a=inactive\r\n",t.rtpSender){var o="msid:"+r.id+" "+t.rtpSender.track.id+"\r\n";s+="a="+o,s+="a=ssrc:"+t.sendEncodingParameters[0].ssrc+" "+o,t.sendEncodingParameters[0].rtx&&(s+="a=ssrc:"+t.sendEncodingParameters[0].rtx.ssrc+" "+o,s+="a=ssrc-group:FID "+t.sendEncodingParameters[0].ssrc+" "+t.sendEncodingParameters[0].rtx.ssrc+"\r\n")}return s+="a=ssrc:"+t.sendEncodingParameters[0].ssrc+" cname:"+i.localCName+"\r\n",t.rtpSender&&t.sendEncodingParameters[0].rtx&&(s+="a=ssrc:"+t.sendEncodingParameters[0].rtx.ssrc+" cname:"+i.localCName+"\r\n"),s},i.getDirection=function(t,e){for(var n=i.splitLines(t),r=0;r<n.length;r++)switch(n[r]){case"a=sendrecv":case"a=sendonly":case"a=recvonly":case"a=inactive":return n[r].substr(2)}return e?i.getDirection(e):"sendrecv"},i.getKind=function(t){return i.splitLines(t)[0].split(" ")[0].substr(2)},i.isRejected=function(t){return"0"===t.split(" ",2)[1]},i.parseMLine=function(t){var e=i.splitLines(t)[0].substr(2).split(" ");return{kind:e[0],port:parseInt(e[1],10),protocol:e[2],fmt:e.slice(3).join(" ")}},i.parseOLine=function(t){var e=i.matchPrefix(t,"o=")[0].substr(2).split(" ");return{username:e[0],sessionId:e[1],sessionVersion:parseInt(e[2],10),netType:e[3],addressType:e[4],address:e[5]}},i.isValidSDP=function(t){if("string"!=typeof t||0===t.length)return!1;for(var e=i.splitLines(t),n=0;n<e.length;n++)if(e[n].length<2||"="!==e[n].charAt(1))return!1;return!0},"object"==typeof e&&(e.exports=i)},{}],3:[function(t,n,i){(function(e){"use strict";var i=t("./adapter_factory.js");n.exports=i({window:e.window})}).call(this,void 0!==e?e:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./adapter_factory.js":4}],4:[function(t,e,n){"use strict";var i=t("./utils");e.exports=function(e,n){var r=e&&e.window,s={shimChrome:!0,shimFirefox:!0,shimEdge:!0,shimSafari:!0};for(var o in n)hasOwnProperty.call(n,o)&&(s[o]=n[o]);var a=i.log,u=i.detectBrowser(r),c=t("./chrome/chrome_shim")||null,h=t("./edge/edge_shim")||null,f=t("./firefox/firefox_shim")||null,d=t("./safari/safari_shim")||null,l=t("./common_shim")||null,p={browserDetails:u,commonShim:l,extractVersion:i.extractVersion,disableLog:i.disableLog,disableWarnings:i.disableWarnings};switch(u.browser){case"chrome":if(!c||!c.shimPeerConnection||!s.shimChrome)return a("Chrome shim is not included in this adapter release."),p;a("adapter.js shimming chrome."),p.browserShim=c,l.shimCreateObjectURL(r),c.shimGetUserMedia(r),c.shimMediaStream(r),c.shimSourceObject(r),c.shimPeerConnection(r),c.shimOnTrack(r),c.shimAddTrackRemoveTrack(r),c.shimGetSendersWithDtmf(r),c.shimSenderReceiverGetStats(r),c.fixNegotiationNeeded(r),l.shimRTCIceCandidate(r),l.shimMaxMessageSize(r),l.shimSendThrowTypeError(r);break;case"firefox":if(!f||!f.shimPeerConnection||!s.shimFirefox)return a("Firefox shim is not included in this adapter release."),p;a("adapter.js shimming firefox."),p.browserShim=f,l.shimCreateObjectURL(r),f.shimGetUserMedia(r),f.shimSourceObject(r),f.shimPeerConnection(r),f.shimOnTrack(r),f.shimRemoveStream(r),f.shimSenderGetStats(r),f.shimReceiverGetStats(r),f.shimRTCDataChannel(r),l.shimRTCIceCandidate(r),l.shimMaxMessageSize(r),l.shimSendThrowTypeError(r);break;case"edge":if(!h||!h.shimPeerConnection||!s.shimEdge)return a("MS edge shim is not included in this adapter release."),p;a("adapter.js shimming edge."),p.browserShim=h,l.shimCreateObjectURL(r),h.shimGetUserMedia(r),h.shimPeerConnection(r),h.shimReplaceTrack(r),l.shimMaxMessageSize(r),l.shimSendThrowTypeError(r);break;case"safari":if(!d||!s.shimSafari)return a("Safari shim is not included in this adapter release."),p;a("adapter.js shimming safari."),p.browserShim=d,l.shimCreateObjectURL(r),d.shimRTCIceServerUrls(r),d.shimCreateOfferLegacy(r),d.shimCallbacksAPI(r),d.shimLocalStreamsAPI(r),d.shimRemoteStreamsAPI(r),d.shimTrackEventTransceiver(r),d.shimGetUserMedia(r),l.shimRTCIceCandidate(r),l.shimMaxMessageSize(r),l.shimSendThrowTypeError(r);break;default:a("Unsupported browser!")}return p}},{"./chrome/chrome_shim":5,"./common_shim":7,"./edge/edge_shim":1,"./firefox/firefox_shim":8,"./safari/safari_shim":10,"./utils":11}],5:[function(t,e,n){"use strict";function i(t,e,n){var i=n?"outbound-rtp":"inbound-rtp",r=new Map;if(null===e)return r;var s=[];return t.forEach(function(t){"track"===t.type&&t.trackIdentifier===e.id&&s.push(t)}),s.forEach(function(e){t.forEach(function(n){n.type===i&&n.trackId===e.id&&function t(e,n,i){n&&!i.has(n.id)&&(i.set(n.id,n),Object.keys(n).forEach(function(r){r.endsWith("Id")?t(e,e.get(n[r]),i):r.endsWith("Ids")&&n[r].forEach(function(n){t(e,e.get(n),i)})}))}(t,n,r)})}),r}var r=t("../utils.js"),s=r.log;e.exports={shimGetUserMedia:t("./getusermedia"),shimMediaStream:function(t){t.MediaStream=t.MediaStream||t.webkitMediaStream},shimOnTrack:function(t){if("object"!=typeof t||!t.RTCPeerConnection||"ontrack"in t.RTCPeerConnection.prototype)"RTCRtpTransceiver"in t||r.wrapPeerConnectionEvent(t,"track",function(t){return t.transceiver||(t.transceiver={receiver:t.receiver}),t});else{Object.defineProperty(t.RTCPeerConnection.prototype,"ontrack",{get:function(){return this.T},set:function(t){this.T&&this.removeEventListener("track",this.T),this.addEventListener("track",this.T=t)},enumerable:!0,configurable:!0});var e=t.RTCPeerConnection.prototype.setRemoteDescription;t.RTCPeerConnection.prototype.setRemoteDescription=function(){var n=this;return n.R||(n.R=function(e){e.stream.addEventListener("addtrack",function(i){var r;r=t.RTCPeerConnection.prototype.getReceivers?n.getReceivers().find(function(t){return t.track&&t.track.id===i.track.id}):{track:i.track};var s=new Event("track");s.track=i.track,s.receiver=r,s.transceiver={receiver:r},s.streams=[e.stream],n.dispatchEvent(s)}),e.stream.getTracks().forEach(function(i){var r;r=t.RTCPeerConnection.prototype.getReceivers?n.getReceivers().find(function(t){return t.track&&t.track.id===i.id}):{track:i};var s=new Event("track");s.track=i,s.receiver=r,s.transceiver={receiver:r},s.streams=[e.stream],n.dispatchEvent(s)})},n.addEventListener("addstream",n.R)),e.apply(n,arguments)}}},shimGetSendersWithDtmf:function(t){if("object"==typeof t&&t.RTCPeerConnection&&!("getSenders"in t.RTCPeerConnection.prototype)&&"createDTMFSender"in t.RTCPeerConnection.prototype){var e=function(t,e){return{track:e,get dtmf(){return void 0===this.C&&("audio"===e.kind?this.C=t.createDTMFSender(e):this.C=null),this.C},x:t}};if(!t.RTCPeerConnection.prototype.getSenders){t.RTCPeerConnection.prototype.getSenders=function(){return this.O=this.O||[],this.O.slice()};var n=t.RTCPeerConnection.prototype.addTrack;t.RTCPeerConnection.prototype.addTrack=function(t,i){var r=this,s=n.apply(r,arguments);return s||(s=e(r,t),r.O.push(s)),s};var i=t.RTCPeerConnection.prototype.removeTrack;t.RTCPeerConnection.prototype.removeTrack=function(t){var e=this;i.apply(e,arguments);var n=e.O.indexOf(t);-1!==n&&e.O.splice(n,1)}}var r=t.RTCPeerConnection.prototype.addStream;t.RTCPeerConnection.prototype.addStream=function(t){var n=this;n.O=n.O||[],r.apply(n,[t]),t.getTracks().forEach(function(t){n.O.push(e(n,t))})};var s=t.RTCPeerConnection.prototype.removeStream;t.RTCPeerConnection.prototype.removeStream=function(t){var e=this;e.O=e.O||[],s.apply(e,[t]),t.getTracks().forEach(function(t){var n=e.O.find(function(e){return e.track===t});n&&e.O.splice(e.O.indexOf(n),1)})}}else if("object"==typeof t&&t.RTCPeerConnection&&"getSenders"in t.RTCPeerConnection.prototype&&"createDTMFSender"in t.RTCPeerConnection.prototype&&t.RTCRtpSender&&!("dtmf"in t.RTCRtpSender.prototype)){var o=t.RTCPeerConnection.prototype.getSenders;t.RTCPeerConnection.prototype.getSenders=function(){var t=this,e=o.apply(t,[]);return e.forEach(function(e){e.x=t}),e},Object.defineProperty(t.RTCRtpSender.prototype,"dtmf",{get:function(){return void 0===this.C&&("audio"===this.track.kind?this.C=this.x.createDTMFSender(this.track):this.C=null),this.C}})}},shimSenderReceiverGetStats:function(t){if("object"==typeof t&&t.RTCPeerConnection&&t.RTCRtpSender&&t.RTCRtpReceiver){if(!("getStats"in t.RTCRtpSender.prototype)){var e=t.RTCPeerConnection.prototype.getSenders;e&&(t.RTCPeerConnection.prototype.getSenders=function(){var t=this,n=e.apply(t,[]);return n.forEach(function(e){e.x=t}),n});var n=t.RTCPeerConnection.prototype.addTrack;n&&(t.RTCPeerConnection.prototype.addTrack=function(){var t=n.apply(this,arguments);return t.x=this,t}),t.RTCRtpSender.prototype.getStats=function(){var t=this;return this.x.getStats().then(function(e){return i(e,t.track,!0)})}}if(!("getStats"in t.RTCRtpReceiver.prototype)){var s=t.RTCPeerConnection.prototype.getReceivers;s&&(t.RTCPeerConnection.prototype.getReceivers=function(){var t=this,e=s.apply(t,[]);return e.forEach(function(e){e.x=t}),e}),r.wrapPeerConnectionEvent(t,"track",function(t){return t.receiver.x=t.srcElement,t}),t.RTCRtpReceiver.prototype.getStats=function(){var t=this;return this.x.getStats().then(function(e){return i(e,t.track,!1)})}}if("getStats"in t.RTCRtpSender.prototype&&"getStats"in t.RTCRtpReceiver.prototype){var o=t.RTCPeerConnection.prototype.getStats;t.RTCPeerConnection.prototype.getStats=function(){var e=this;if(arguments.length>0&&arguments[0]instanceof t.MediaStreamTrack){var n,i,r,s=arguments[0];return e.getSenders().forEach(function(t){t.track===s&&(n?r=!0:n=t)}),e.getReceivers().forEach(function(t){return t.track===s&&(i?r=!0:i=t),t.track===s}),r||n&&i?Promise.reject(new DOMException("There are more than one sender or receiver for the track.","InvalidAccessError")):n?n.getStats():i?i.getStats():Promise.reject(new DOMException("There is no sender or receiver for the track.","InvalidAccessError"))}return o.apply(e,arguments)}}}},shimSourceObject:function(t){var e=t&&t.URL;"object"==typeof t&&(!t.HTMLMediaElement||"srcObject"in t.HTMLMediaElement.prototype||Object.defineProperty(t.HTMLMediaElement.prototype,"srcObject",{get:function(){return this.P},set:function(t){var n=this;return this.P=t,this.src&&e.revokeObjectURL(this.src),t?(this.src=e.createObjectURL(t),t.addEventListener("addtrack",function(){n.src&&e.revokeObjectURL(n.src),n.src=e.createObjectURL(t)}),void t.addEventListener("removetrack",function(){n.src&&e.revokeObjectURL(n.src),n.src=e.createObjectURL(t)})):void(this.src="")}}))},shimAddTrackRemoveTrackWithNative:function(t){t.RTCPeerConnection.prototype.getLocalStreams=function(){var t=this;return this.M=this.M||{},Object.keys(this.M).map(function(e){return t.M[e][0]})};var e=t.RTCPeerConnection.prototype.addTrack;t.RTCPeerConnection.prototype.addTrack=function(t,n){if(!n)return e.apply(this,arguments);this.M=this.M||{};var i=e.apply(this,arguments);return this.M[n.id]?-1===this.M[n.id].indexOf(i)&&this.M[n.id].push(i):this.M[n.id]=[n,i],i};var n=t.RTCPeerConnection.prototype.addStream;t.RTCPeerConnection.prototype.addStream=function(t){var e=this;this.M=this.M||{},t.getTracks().forEach(function(t){if(e.getSenders().find(function(e){return e.track===t}))throw new DOMException("Track already exists.","InvalidAccessError")});var i=e.getSenders();n.apply(this,arguments);var r=e.getSenders().filter(function(t){return-1===i.indexOf(t)});this.M[t.id]=[t].concat(r)};var i=t.RTCPeerConnection.prototype.removeStream;t.RTCPeerConnection.prototype.removeStream=function(t){return this.M=this.M||{},delete this.M[t.id],i.apply(this,arguments)};var r=t.RTCPeerConnection.prototype.removeTrack;t.RTCPeerConnection.prototype.removeTrack=function(t){var e=this;return this.M=this.M||{},t&&Object.keys(this.M).forEach(function(n){var i=e.M[n].indexOf(t);-1!==i&&e.M[n].splice(i,1),1===e.M[n].length&&delete e.M[n]}),r.apply(this,arguments)}},shimAddTrackRemoveTrack:function(t){function e(t,e){var n=e.sdp;return Object.keys(t.D||[]).forEach(function(e){var i=t.D[e],r=t.q[i.id];n=n.replace(new RegExp(r.id,"g"),i.id)}),new RTCSessionDescription({type:e.type,sdp:n})}var n=r.detectBrowser(t);if(t.RTCPeerConnection.prototype.addTrack&&n.version>=65)return this.shimAddTrackRemoveTrackWithNative(t);var i=t.RTCPeerConnection.prototype.getLocalStreams;t.RTCPeerConnection.prototype.getLocalStreams=function(){var t=this,e=i.apply(this);return t.D=t.D||{},e.map(function(e){return t.D[e.id]})};var s=t.RTCPeerConnection.prototype.addStream;t.RTCPeerConnection.prototype.addStream=function(e){var n=this;if(n.q=n.q||{},n.D=n.D||{},e.getTracks().forEach(function(t){if(n.getSenders().find(function(e){return e.track===t}))throw new DOMException("Track already exists.","InvalidAccessError")}),!n.D[e.id]){var i=new t.MediaStream(e.getTracks());n.q[e.id]=i,n.D[i.id]=e,e=i}s.apply(n,[e])};var o=t.RTCPeerConnection.prototype.removeStream;t.RTCPeerConnection.prototype.removeStream=function(t){var e=this;e.q=e.q||{},e.D=e.D||{},o.apply(e,[e.q[t.id]||t]),delete e.D[e.q[t.id]?e.q[t.id].id:t.id],delete e.q[t.id]},t.RTCPeerConnection.prototype.addTrack=function(e,n){var i=this;if("closed"===i.signalingState)throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");var r=[].slice.call(arguments,1);if(1!==r.length||!r[0].getTracks().find(function(t){return t===e}))throw new DOMException("The adapter.js addTrack polyfill only supports a single  stream which is associated with the specified track.","NotSupportedError");if(i.getSenders().find(function(t){return t.track===e}))throw new DOMException("Track already exists.","InvalidAccessError");i.q=i.q||{},i.D=i.D||{};var s=i.q[n.id];if(s)s.addTrack(e),Promise.resolve().then(function(){i.dispatchEvent(new Event("negotiationneeded"))});else{var o=new t.MediaStream([e]);i.q[n.id]=o,i.D[o.id]=n,i.addStream(o)}return i.getSenders().find(function(t){return t.track===e})},["createOffer","createAnswer"].forEach(function(n){var i=t.RTCPeerConnection.prototype[n];t.RTCPeerConnection.prototype[n]=function(){var t=this,n=arguments;return arguments.length&&"function"==typeof arguments[0]?i.apply(t,[function(i){var r=e(t,i);n[0].apply(null,[r])},function(t){n[1]&&n[1].apply(null,t)},arguments[2]]):i.apply(t,arguments).then(function(n){return e(t,n)})}});var a=t.RTCPeerConnection.prototype.setLocalDescription;t.RTCPeerConnection.prototype.setLocalDescription=function(){var t=this;return arguments.length&&arguments[0].type?(arguments[0]=function(t,e){var n=e.sdp;return Object.keys(t.D||[]).forEach(function(e){var i=t.D[e],r=t.q[i.id];n=n.replace(new RegExp(i.id,"g"),r.id)}),new RTCSessionDescription({type:e.type,sdp:n})}(t,arguments[0]),a.apply(t,arguments)):a.apply(t,arguments)};var u=Object.getOwnPropertyDescriptor(t.RTCPeerConnection.prototype,"localDescription");Object.defineProperty(t.RTCPeerConnection.prototype,"localDescription",{get:function(){var t=u.get.apply(this);return""===t.type?t:e(this,t)}}),t.RTCPeerConnection.prototype.removeTrack=function(t){var e,n=this;if("closed"===n.signalingState)throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");if(!t.x)throw new DOMException("Argument 1 of RTCPeerConnection.removeTrack does not implement interface RTCRtpSender.","TypeError");if(!(t.x===n))throw new DOMException("Sender was not created by this connection.","InvalidAccessError");n.q=n.q||{},Object.keys(n.q).forEach(function(i){n.q[i].getTracks().find(function(e){return t.track===e})&&(e=n.q[i])}),e&&(1===e.getTracks().length?n.removeStream(n.D[e.id]):e.removeTrack(t.track),n.dispatchEvent(new Event("negotiationneeded")))}},shimPeerConnection:function(t){var e=r.detectBrowser(t);if(!t.RTCPeerConnection&&t.webkitRTCPeerConnection)t.RTCPeerConnection=function(e,n){return s("PeerConnection"),e&&e.iceTransportPolicy&&(e.iceTransports=e.iceTransportPolicy),new t.webkitRTCPeerConnection(e,n)},t.RTCPeerConnection.prototype=t.webkitRTCPeerConnection.prototype,t.webkitRTCPeerConnection.generateCertificate&&Object.defineProperty(t.RTCPeerConnection,"generateCertificate",{get:function(){return t.webkitRTCPeerConnection.generateCertificate}});else{var n=t.RTCPeerConnection;t.RTCPeerConnection=function(t,e){if(t&&t.iceServers){for(var i=[],s=0;s<t.iceServers.length;s++){var o=t.iceServers[s];!o.hasOwnProperty("urls")&&o.hasOwnProperty("url")?(r.deprecated("RTCIceServer.url","RTCIceServer.urls"),(o=JSON.parse(JSON.stringify(o))).urls=o.url,i.push(o)):i.push(t.iceServers[s])}t.iceServers=i}return new n(t,e)},t.RTCPeerConnection.prototype=n.prototype,Object.defineProperty(t.RTCPeerConnection,"generateCertificate",{get:function(){return n.generateCertificate}})}var i=t.RTCPeerConnection.prototype.getStats;t.RTCPeerConnection.prototype.getStats=function(t,e,n){var r=this,s=arguments;if(arguments.length>0&&"function"==typeof t)return i.apply(this,arguments);if(0===i.length&&(0===arguments.length||"function"!=typeof arguments[0]))return i.apply(this,[]);var o=function(t){var e={};return t.result().forEach(function(t){var n={id:t.id,timestamp:t.timestamp,type:{localcandidate:"local-candidate",remotecandidate:"remote-candidate"}[t.type]||t.type};t.names().forEach(function(e){n[e]=t.stat(e)}),e[n.id]=n}),e},a=function(t){return new Map(Object.keys(t).map(function(e){return[e,t[e]]}))};return arguments.length>=2?i.apply(this,[function(t){s[1](a(o(t)))},arguments[0]]):new Promise(function(t,e){i.apply(r,[function(e){t(a(o(e)))},e])}).then(e,n)},e.version<51&&["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach(function(e){var n=t.RTCPeerConnection.prototype[e];t.RTCPeerConnection.prototype[e]=function(){var t=arguments,e=this,i=new Promise(function(i,r){n.apply(e,[t[0],i,r])});return t.length<2?i:i.then(function(){t[1].apply(null,[])},function(e){t.length>=3&&t[2].apply(null,[e])})}}),e.version<52&&["createOffer","createAnswer"].forEach(function(e){var n=t.RTCPeerConnection.prototype[e];t.RTCPeerConnection.prototype[e]=function(){var t=this;if(arguments.length<1||1===arguments.length&&"object"==typeof arguments[0]){var e=1===arguments.length?arguments[0]:void 0;return new Promise(function(i,r){n.apply(t,[i,r,e])})}return n.apply(this,arguments)}}),["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach(function(e){var n=t.RTCPeerConnection.prototype[e];t.RTCPeerConnection.prototype[e]=function(){return arguments[0]=new("addIceCandidate"===e?t.RTCIceCandidate:t.RTCSessionDescription)(arguments[0]),n.apply(this,arguments)}});var o=t.RTCPeerConnection.prototype.addIceCandidate;t.RTCPeerConnection.prototype.addIceCandidate=function(){return arguments[0]?o.apply(this,arguments):(arguments[1]&&arguments[1].apply(null),Promise.resolve())}},fixNegotiationNeeded:function(t){r.wrapPeerConnectionEvent(t,"negotiationneeded",function(t){if("stable"===t.target.signalingState)return t})},shimGetDisplayMedia:function(t,e){if(!("getDisplayMedia"in t.navigator))return"function"!=typeof e?void console.error("shimGetDisplayMedia: getSourceId argument is not a function"):void(navigator.getDisplayMedia=function(t){return e(t).then(function(e){return t.video={mandatory:{chromeMediaSource:"desktop",chromeMediaSourceId:e,maxFrameRate:t.video.frameRate||3}},navigator.mediaDevices.getUserMedia(t)})})}}},{"../utils.js":11,"./getusermedia":6}],6:[function(t,e,n){"use strict";var i=t("../utils.js"),r=i.log;e.exports=function(t){var e=i.detectBrowser(t),n=t&&t.navigator,s=function(t){if("object"!=typeof t||t.mandatory||t.optional)return t;var e={};return Object.keys(t).forEach(function(n){if("require"!==n&&"advanced"!==n&&"mediaSource"!==n){var i="object"==typeof t[n]?t[n]:{ideal:t[n]};void 0!==i.exact&&"number"==typeof i.exact&&(i.min=i.max=i.exact);var r=function(t,e){return t?t+e.charAt(0).toUpperCase()+e.slice(1):"deviceId"===e?"sourceId":e};if(void 0!==i.ideal){e.optional=e.optional||[];var s={};"number"==typeof i.ideal?(s[r("min",n)]=i.ideal,e.optional.push(s),(s={})[r("max",n)]=i.ideal,e.optional.push(s)):(s[r("",n)]=i.ideal,e.optional.push(s))}void 0!==i.exact&&"number"!=typeof i.exact?(e.mandatory=e.mandatory||{},e.mandatory[r("",n)]=i.exact):["min","max"].forEach(function(t){void 0!==i[t]&&(e.mandatory=e.mandatory||{},e.mandatory[r(t,n)]=i[t])})}}),t.advanced&&(e.optional=(e.optional||[]).concat(t.advanced)),e},o=function(t,i){if(e.version>=61)return i(t);if((t=JSON.parse(JSON.stringify(t)))&&"object"==typeof t.audio){var o=function(t,e,n){e in t&&!(n in t)&&(t[n]=t[e],delete t[e])};o((t=JSON.parse(JSON.stringify(t))).audio,"autoGainControl","googAutoGainControl"),o(t.audio,"noiseSuppression","googNoiseSuppression"),t.audio=s(t.audio)}if(t&&"object"==typeof t.video){var a=t.video.facingMode;a=a&&("object"==typeof a?a:{ideal:a});var u,c=e.version<66;if(a&&("user"===a.exact||"environment"===a.exact||"user"===a.ideal||"environment"===a.ideal)&&(!n.mediaDevices.getSupportedConstraints||!n.mediaDevices.getSupportedConstraints().facingMode||c)&&(delete t.video.facingMode,"environment"===a.exact||"environment"===a.ideal?u=["back","rear"]:"user"!==a.exact&&"user"!==a.ideal||(u=["front"]),u))return n.mediaDevices.enumerateDevices().then(function(e){var n=(e=e.filter(function(t){return"videoinput"===t.kind})).find(function(t){return u.some(function(e){return-1!==t.label.toLowerCase().indexOf(e)})});return!n&&e.length&&-1!==u.indexOf("back")&&(n=e[e.length-1]),n&&(t.video.deviceId=a.exact?{exact:n.deviceId}:{ideal:n.deviceId}),t.video=s(t.video),r("chrome: "+JSON.stringify(t)),i(t)});t.video=s(t.video)}return r("chrome: "+JSON.stringify(t)),i(t)},a=function(t){return e.version>=64?t:{name:{PermissionDeniedError:"NotAllowedError",PermissionDismissedError:"NotAllowedError",InvalidStateError:"NotAllowedError",DevicesNotFoundError:"NotFoundError",ConstraintNotSatisfiedError:"OverconstrainedError",TrackStartError:"NotReadableError",MediaDeviceFailedDueToShutdown:"NotAllowedError",MediaDeviceKillSwitchOn:"NotAllowedError",TabCaptureError:"AbortError",ScreenCaptureError:"AbortError",DeviceCaptureError:"AbortError"}[t.name]||t.name,message:t.message,constraint:t.constraint||t.constraintName,toString:function(){return this.name+(this.message&&": ")+this.message}}};n.getUserMedia=function(t,e,i){o(t,function(t){n.webkitGetUserMedia(t,e,function(t){i&&i(a(t))})})};var u=function(t){return new Promise(function(e,i){n.getUserMedia(t,e,i)})};if(n.mediaDevices||(n.mediaDevices={getUserMedia:u,enumerateDevices:function(){return new Promise(function(e){var n={audio:"audioinput",video:"videoinput"};return t.MediaStreamTrack.getSources(function(t){e(t.map(function(t){return{label:t.label,kind:n[t.kind],deviceId:t.id,groupId:""}}))})})},getSupportedConstraints:function(){return{deviceId:!0,echoCancellation:!0,facingMode:!0,frameRate:!0,height:!0,width:!0}}}),n.mediaDevices.getUserMedia){var c=n.mediaDevices.getUserMedia.bind(n.mediaDevices);n.mediaDevices.getUserMedia=function(t){return o(t,function(t){return c(t).then(function(e){if(t.audio&&!e.getAudioTracks().length||t.video&&!e.getVideoTracks().length)throw e.getTracks().forEach(function(t){t.stop()}),new DOMException("","NotFoundError");return e},function(t){return Promise.reject(a(t))})})}}else n.mediaDevices.getUserMedia=function(t){return u(t)};void 0===n.mediaDevices.addEventListener&&(n.mediaDevices.addEventListener=function(){r("Dummy mediaDevices.addEventListener called.")}),void 0===n.mediaDevices.removeEventListener&&(n.mediaDevices.removeEventListener=function(){r("Dummy mediaDevices.removeEventListener called.")})}},{"../utils.js":11}],7:[function(t,e,n){"use strict";var i=t("sdp"),r=t("./utils");e.exports={shimRTCIceCandidate:function(t){if(t.RTCIceCandidate&&!(t.RTCIceCandidate&&"foundation"in t.RTCIceCandidate.prototype)){var e=t.RTCIceCandidate;t.RTCIceCandidate=function(t){if("object"==typeof t&&t.candidate&&0===t.candidate.indexOf("a=")&&((t=JSON.parse(JSON.stringify(t))).candidate=t.candidate.substr(2)),t.candidate&&t.candidate.length){var n=new e(t),r=i.parseCandidate(t.candidate),s=Object.assign(n,r);return s.toJSON=function(){return{candidate:s.candidate,sdpMid:s.sdpMid,sdpMLineIndex:s.sdpMLineIndex,usernameFragment:s.usernameFragment}},s}return new e(t)},t.RTCIceCandidate.prototype=e.prototype,r.wrapPeerConnectionEvent(t,"icecandidate",function(e){return e.candidate&&Object.defineProperty(e,"candidate",{value:new t.RTCIceCandidate(e.candidate),writable:"false"}),e})}},shimCreateObjectURL:function(t){var e=t&&t.URL;if("object"==typeof t&&t.HTMLMediaElement&&"srcObject"in t.HTMLMediaElement.prototype&&e.createObjectURL&&e.revokeObjectURL){var n=e.createObjectURL.bind(e),i=e.revokeObjectURL.bind(e),s=new Map,o=0;e.createObjectURL=function(t){if("getTracks"in t){var e="polyblob:"+ ++o;return s.set(e,t),r.deprecated("URL.createObjectURL(stream)","elem.srcObject = stream"),e}return n(t)},e.revokeObjectURL=function(t){i(t),s.delete(t)};var a=Object.getOwnPropertyDescriptor(t.HTMLMediaElement.prototype,"src");Object.defineProperty(t.HTMLMediaElement.prototype,"src",{get:function(){return a.get.apply(this)},set:function(t){return this.srcObject=s.get(t)||null,a.set.apply(this,[t])}});var u=t.HTMLMediaElement.prototype.setAttribute;t.HTMLMediaElement.prototype.setAttribute=function(){return 2===arguments.length&&"src"===(""+arguments[0]).toLowerCase()&&(this.srcObject=s.get(arguments[1])||null),u.apply(this,arguments)}}},shimMaxMessageSize:function(t){if(!t.RTCSctpTransport&&t.RTCPeerConnection){var e=r.detectBrowser(t);"sctp"in t.RTCPeerConnection.prototype||Object.defineProperty(t.RTCPeerConnection.prototype,"sctp",{get:function(){return void 0===this.A?null:this.A}});var n=function(t){var e=i.splitSections(t.sdp);return e.shift(),e.some(function(t){var e=i.parseMLine(t);return e&&"application"===e.kind&&-1!==e.protocol.indexOf("SCTP")})},s=function(t){var n=65536;return"firefox"===e.browser&&(n=e.version<57?-1===t?16384:2147483637:e.version<60?57===e.version?65535:65536:2147483637),n},o=function(t,n){var r=65536;"firefox"===e.browser&&57===e.version&&(r=65535);var s=i.matchPrefix(t.sdp,"a=max-message-size:");return s.length>0?r=parseInt(s[0].substr(19),10):"firefox"===e.browser&&-1!==n&&(r=2147483637),r},a=t.RTCPeerConnection.prototype.setRemoteDescription;t.RTCPeerConnection.prototype.setRemoteDescription=function(){var t=this;if(t.A=null,n(arguments[0])){var e,i=function(t){var e=t.sdp.match(/mozilla...THIS_IS_SDPARTA-(\d+)/);if(null===e||e.length<2)return-1;var n=parseInt(e[1],10);return n!=n?-1:n}(arguments[0]),r=s(i),u=o(arguments[0],i);e=0===r&&0===u?Number.POSITIVE_INFINITY:0===r||0===u?Math.max(r,u):Math.min(r,u);var c={};Object.defineProperty(c,"maxMessageSize",{get:function(){return e}}),t.A=c}return a.apply(t,arguments)}}},shimSendThrowTypeError:function(t){function e(t,e){var n=t.send;t.send=function(){var i=arguments[0],r=i.length||i.size||i.byteLength;if("open"===t.readyState&&e.sctp&&r>e.sctp.maxMessageSize)throw new TypeError("Message too large (can send a maximum of "+e.sctp.maxMessageSize+" bytes)");return n.apply(t,arguments)}}if(t.RTCPeerConnection&&"createDataChannel"in t.RTCPeerConnection.prototype){var n=t.RTCPeerConnection.prototype.createDataChannel;t.RTCPeerConnection.prototype.createDataChannel=function(){var t=n.apply(this,arguments);return e(t,this),t},r.wrapPeerConnectionEvent(t,"datachannel",function(t){return e(t.channel,t.target),t})}}}},{"./utils":11,sdp:2}],8:[function(t,e,n){"use strict";var i=t("../utils");e.exports={shimGetUserMedia:t("./getusermedia"),shimOnTrack:function(t){"object"!=typeof t||!t.RTCPeerConnection||"ontrack"in t.RTCPeerConnection.prototype||Object.defineProperty(t.RTCPeerConnection.prototype,"ontrack",{get:function(){return this.T},set:function(t){this.T&&(this.removeEventListener("track",this.T),this.removeEventListener("addstream",this.R)),this.addEventListener("track",this.T=t),this.addEventListener("addstream",this.R=function(t){t.stream.getTracks().forEach(function(e){var n=new Event("track");n.track=e,n.receiver={track:e},n.transceiver={receiver:n.receiver},n.streams=[t.stream],this.dispatchEvent(n)}.bind(this))}.bind(this))},enumerable:!0,configurable:!0}),"object"==typeof t&&t.RTCTrackEvent&&"receiver"in t.RTCTrackEvent.prototype&&!("transceiver"in t.RTCTrackEvent.prototype)&&Object.defineProperty(t.RTCTrackEvent.prototype,"transceiver",{get:function(){return{receiver:this.receiver}}})},shimSourceObject:function(t){"object"==typeof t&&(!t.HTMLMediaElement||"srcObject"in t.HTMLMediaElement.prototype||Object.defineProperty(t.HTMLMediaElement.prototype,"srcObject",{get:function(){return this.mozSrcObject},set:function(t){this.mozSrcObject=t}}))},shimPeerConnection:function(t){var e=i.detectBrowser(t);if("object"==typeof t&&(t.RTCPeerConnection||t.mozRTCPeerConnection)){t.RTCPeerConnection||(t.RTCPeerConnection=function(n,i){if(e.version<38&&n&&n.iceServers){for(var r=[],s=0;s<n.iceServers.length;s++){var o=n.iceServers[s];if(o.hasOwnProperty("urls"))for(var a=0;a<o.urls.length;a++){var u={url:o.urls[a]};0===o.urls[a].indexOf("turn")&&(u.username=o.username,u.credential=o.credential),r.push(u)}else r.push(n.iceServers[s])}n.iceServers=r}return new t.mozRTCPeerConnection(n,i)},t.RTCPeerConnection.prototype=t.mozRTCPeerConnection.prototype,t.mozRTCPeerConnection.generateCertificate&&Object.defineProperty(t.RTCPeerConnection,"generateCertificate",{get:function(){return t.mozRTCPeerConnection.generateCertificate}}),t.RTCSessionDescription=t.mozRTCSessionDescription,t.RTCIceCandidate=t.mozRTCIceCandidate),["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach(function(e){var n=t.RTCPeerConnection.prototype[e];t.RTCPeerConnection.prototype[e]=function(){return arguments[0]=new("addIceCandidate"===e?t.RTCIceCandidate:t.RTCSessionDescription)(arguments[0]),n.apply(this,arguments)}});var n=t.RTCPeerConnection.prototype.addIceCandidate;t.RTCPeerConnection.prototype.addIceCandidate=function(){return arguments[0]?n.apply(this,arguments):(arguments[1]&&arguments[1].apply(null),Promise.resolve())};var r={inboundrtp:"inbound-rtp",outboundrtp:"outbound-rtp",candidatepair:"candidate-pair",localcandidate:"local-candidate",remotecandidate:"remote-candidate"},s=t.RTCPeerConnection.prototype.getStats;t.RTCPeerConnection.prototype.getStats=function(t,n,i){return s.apply(this,[t||null]).then(function(t){if(e.version<48&&(t=function(t){var e=new Map;return Object.keys(t).forEach(function(n){e.set(n,t[n]),e[n]=t[n]}),e}(t)),e.version<53&&!n)try{t.forEach(function(t){t.type=r[t.type]||t.type})}catch(e){if("TypeError"!==e.name)throw e;t.forEach(function(e,n){t.set(n,Object.assign({},e,{type:r[e.type]||e.type}))})}return t}).then(n,i)}}},shimSenderGetStats:function(t){if("object"==typeof t&&t.RTCPeerConnection&&t.RTCRtpSender&&!(t.RTCRtpSender&&"getStats"in t.RTCRtpSender.prototype)){var e=t.RTCPeerConnection.prototype.getSenders;e&&(t.RTCPeerConnection.prototype.getSenders=function(){var t=this,n=e.apply(t,[]);return n.forEach(function(e){e.x=t}),n});var n=t.RTCPeerConnection.prototype.addTrack;n&&(t.RTCPeerConnection.prototype.addTrack=function(){var t=n.apply(this,arguments);return t.x=this,t}),t.RTCRtpSender.prototype.getStats=function(){return this.track?this.x.getStats(this.track):Promise.resolve(new Map)}}},shimReceiverGetStats:function(t){if("object"==typeof t&&t.RTCPeerConnection&&t.RTCRtpSender&&!(t.RTCRtpSender&&"getStats"in t.RTCRtpReceiver.prototype)){var e=t.RTCPeerConnection.prototype.getReceivers;e&&(t.RTCPeerConnection.prototype.getReceivers=function(){var t=this,n=e.apply(t,[]);return n.forEach(function(e){e.x=t}),n}),i.wrapPeerConnectionEvent(t,"track",function(t){return t.receiver.x=t.srcElement,t}),t.RTCRtpReceiver.prototype.getStats=function(){return this.x.getStats(this.track)}}},shimRemoveStream:function(t){!t.RTCPeerConnection||"removeStream"in t.RTCPeerConnection.prototype||(t.RTCPeerConnection.prototype.removeStream=function(t){var e=this;i.deprecated("removeStream","removeTrack"),this.getSenders().forEach(function(n){n.track&&-1!==t.getTracks().indexOf(n.track)&&e.removeTrack(n)})})},shimRTCDataChannel:function(t){t.DataChannel&&!t.RTCDataChannel&&(t.RTCDataChannel=t.DataChannel)},shimGetDisplayMedia:function(t,e){"getDisplayMedia"in t.navigator||(navigator.getDisplayMedia=function(t){if(!t||!t.video){var n=new DOMException("getDisplayMedia without video constraints is undefined");return n.name="NotFoundError",n.code=8,Promise.reject(n)}return!0===t.video?t.video={mediaSource:e}:t.video.mediaSource=e,navigator.mediaDevices.getUserMedia(t)})}}},{"../utils":11,"./getusermedia":9}],9:[function(t,e,n){"use strict";var i=t("../utils"),r=i.log;e.exports=function(t){var e=i.detectBrowser(t),n=t&&t.navigator,s=t&&t.MediaStreamTrack,o=function(t){return{name:{InternalError:"NotReadableError",NotSupportedError:"TypeError",PermissionDeniedError:"NotAllowedError",SecurityError:"NotAllowedError"}[t.name]||t.name,message:{"The operation is insecure.":"The request is not allowed by the user agent or the platform in the current context."}[t.message]||t.message,constraint:t.constraint,toString:function(){return this.name+(this.message&&": ")+this.message}}},a=function(t,i,s){var a=function(t){if("object"!=typeof t||t.require)return t;var e=[];return Object.keys(t).forEach(function(n){if("require"!==n&&"advanced"!==n&&"mediaSource"!==n){var i=t[n]="object"==typeof t[n]?t[n]:{ideal:t[n]};if(void 0===i.min&&void 0===i.max&&void 0===i.exact||e.push(n),void 0!==i.exact&&("number"==typeof i.exact?i.min=i.max=i.exact:t[n]=i.exact,delete i.exact),void 0!==i.ideal){t.advanced=t.advanced||[];var r={};"number"==typeof i.ideal?r[n]={min:i.ideal,max:i.ideal}:r[n]=i.ideal,t.advanced.push(r),delete i.ideal,Object.keys(i).length||delete t[n]}}}),e.length&&(t.require=e),t};return t=JSON.parse(JSON.stringify(t)),e.version<38&&(r("spec: "+JSON.stringify(t)),t.audio&&(t.audio=a(t.audio)),t.video&&(t.video=a(t.video)),r("ff37: "+JSON.stringify(t))),n.mozGetUserMedia(t,i,function(t){s(o(t))})};if(n.mediaDevices||(n.mediaDevices={getUserMedia:function(t){return new Promise(function(e,n){a(t,e,n)})},addEventListener:function(){},removeEventListener:function(){}}),n.mediaDevices.enumerateDevices=n.mediaDevices.enumerateDevices||function(){return new Promise(function(t){t([{kind:"audioinput",deviceId:"default",label:"",groupId:""},{kind:"videoinput",deviceId:"default",label:"",groupId:""}])})},e.version<41){var u=n.mediaDevices.enumerateDevices.bind(n.mediaDevices);n.mediaDevices.enumerateDevices=function(){return u().then(void 0,function(t){if("NotFoundError"===t.name)return[];throw t})}}if(e.version<49){var c=n.mediaDevices.getUserMedia.bind(n.mediaDevices);n.mediaDevices.getUserMedia=function(t){return c(t).then(function(e){if(t.audio&&!e.getAudioTracks().length||t.video&&!e.getVideoTracks().length)throw e.getTracks().forEach(function(t){t.stop()}),new DOMException("The object can not be found here.","NotFoundError");return e},function(t){return Promise.reject(o(t))})}}if(!(e.version>55&&"autoGainControl"in n.mediaDevices.getSupportedConstraints())){var h=function(t,e,n){e in t&&!(n in t)&&(t[n]=t[e],delete t[e])},f=n.mediaDevices.getUserMedia.bind(n.mediaDevices);if(n.mediaDevices.getUserMedia=function(t){return"object"==typeof t&&"object"==typeof t.audio&&(t=JSON.parse(JSON.stringify(t)),h(t.audio,"autoGainControl","mozAutoGainControl"),h(t.audio,"noiseSuppression","mozNoiseSuppression")),f(t)},s&&s.prototype.getSettings){var d=s.prototype.getSettings;s.prototype.getSettings=function(){var t=d.apply(this,arguments);return h(t,"mozAutoGainControl","autoGainControl"),h(t,"mozNoiseSuppression","noiseSuppression"),t}}if(s&&s.prototype.applyConstraints){var l=s.prototype.applyConstraints;s.prototype.applyConstraints=function(t){return"audio"===this.kind&&"object"==typeof t&&(t=JSON.parse(JSON.stringify(t)),h(t,"autoGainControl","mozAutoGainControl"),h(t,"noiseSuppression","mozNoiseSuppression")),l.apply(this,[t])}}}n.getUserMedia=function(t,r,s){return e.version<44?a(t,r,s):(i.deprecated("navigator.getUserMedia","navigator.mediaDevices.getUserMedia"),void n.mediaDevices.getUserMedia(t).then(r,s))}}},{"../utils":11}],10:[function(t,e,n){"use strict";var i=t("../utils");e.exports={shimLocalStreamsAPI:function(t){if("object"==typeof t&&t.RTCPeerConnection){if("getLocalStreams"in t.RTCPeerConnection.prototype||(t.RTCPeerConnection.prototype.getLocalStreams=function(){return this.N||(this.N=[]),this.N}),"getStreamById"in t.RTCPeerConnection.prototype||(t.RTCPeerConnection.prototype.getStreamById=function(t){var e=null;return this.N&&this.N.forEach(function(n){n.id===t&&(e=n)}),this.F&&this.F.forEach(function(n){n.id===t&&(e=n)}),e}),!("addStream"in t.RTCPeerConnection.prototype)){var e=t.RTCPeerConnection.prototype.addTrack;t.RTCPeerConnection.prototype.addStream=function(t){this.N||(this.N=[]),-1===this.N.indexOf(t)&&this.N.push(t);var n=this;t.getTracks().forEach(function(i){e.call(n,i,t)})},t.RTCPeerConnection.prototype.addTrack=function(t,n){return n&&(this.N?-1===this.N.indexOf(n)&&this.N.push(n):this.N=[n]),e.call(this,t,n)}}"removeStream"in t.RTCPeerConnection.prototype||(t.RTCPeerConnection.prototype.removeStream=function(t){this.N||(this.N=[]);var e=this.N.indexOf(t);if(-1!==e){this.N.splice(e,1);var n=this,i=t.getTracks();this.getSenders().forEach(function(t){-1!==i.indexOf(t.track)&&n.removeTrack(t)})}})}},shimRemoteStreamsAPI:function(t){if("object"==typeof t&&t.RTCPeerConnection&&("getRemoteStreams"in t.RTCPeerConnection.prototype||(t.RTCPeerConnection.prototype.getRemoteStreams=function(){return this.F?this.F:[]}),!("onaddstream"in t.RTCPeerConnection.prototype))){Object.defineProperty(t.RTCPeerConnection.prototype,"onaddstream",{get:function(){return this.j},set:function(t){this.j&&this.removeEventListener("addstream",this.j),this.addEventListener("addstream",this.j=t)}});var e=t.RTCPeerConnection.prototype.setRemoteDescription;t.RTCPeerConnection.prototype.setRemoteDescription=function(){var t=this;return this.U||this.addEventListener("track",this.U=function(e){e.streams.forEach(function(e){if(t.F||(t.F=[]),!(t.F.indexOf(e)>=0)){t.F.push(e);var n=new Event("addstream");n.stream=e,t.dispatchEvent(n)}})}),e.apply(t,arguments)}}},shimCallbacksAPI:function(t){if("object"==typeof t&&t.RTCPeerConnection){var e=t.RTCPeerConnection.prototype,n=e.createOffer,i=e.createAnswer,r=e.setLocalDescription,s=e.setRemoteDescription,o=e.addIceCandidate;e.createOffer=function(t,e){var i=arguments.length>=2?arguments[2]:arguments[0],r=n.apply(this,[i]);return e?(r.then(t,e),Promise.resolve()):r},e.createAnswer=function(t,e){var n=arguments.length>=2?arguments[2]:arguments[0],r=i.apply(this,[n]);return e?(r.then(t,e),Promise.resolve()):r};var a=function(t,e,n){var i=r.apply(this,[t]);return n?(i.then(e,n),Promise.resolve()):i};e.setLocalDescription=a,a=function(t,e,n){var i=s.apply(this,[t]);return n?(i.then(e,n),Promise.resolve()):i},e.setRemoteDescription=a,a=function(t,e,n){var i=o.apply(this,[t]);return n?(i.then(e,n),Promise.resolve()):i},e.addIceCandidate=a}},shimGetUserMedia:function(t){var e=t&&t.navigator;e.getUserMedia||(e.webkitGetUserMedia?e.getUserMedia=e.webkitGetUserMedia.bind(e):e.mediaDevices&&e.mediaDevices.getUserMedia&&(e.getUserMedia=function(t,n,i){e.mediaDevices.getUserMedia(t).then(n,i)}.bind(e)))},shimRTCIceServerUrls:function(t){var e=t.RTCPeerConnection;t.RTCPeerConnection=function(t,n){if(t&&t.iceServers){for(var r=[],s=0;s<t.iceServers.length;s++){var o=t.iceServers[s];!o.hasOwnProperty("urls")&&o.hasOwnProperty("url")?(i.deprecated("RTCIceServer.url","RTCIceServer.urls"),(o=JSON.parse(JSON.stringify(o))).urls=o.url,delete o.url,r.push(o)):r.push(t.iceServers[s])}t.iceServers=r}return new e(t,n)},t.RTCPeerConnection.prototype=e.prototype,"generateCertificate"in t.RTCPeerConnection&&Object.defineProperty(t.RTCPeerConnection,"generateCertificate",{get:function(){return e.generateCertificate}})},shimTrackEventTransceiver:function(t){"object"==typeof t&&t.RTCPeerConnection&&"receiver"in t.RTCTrackEvent.prototype&&!t.RTCTransceiver&&Object.defineProperty(t.RTCTrackEvent.prototype,"transceiver",{get:function(){return{receiver:this.receiver}}})},shimCreateOfferLegacy:function(t){var e=t.RTCPeerConnection.prototype.createOffer;t.RTCPeerConnection.prototype.createOffer=function(t){var n=this;if(t){void 0!==t.offerToReceiveAudio&&(t.offerToReceiveAudio=!!t.offerToReceiveAudio);var i=n.getTransceivers().find(function(t){return t.sender.track&&"audio"===t.sender.track.kind});!1===t.offerToReceiveAudio&&i?"sendrecv"===i.direction?i.setDirection?i.setDirection("sendonly"):i.direction="sendonly":"recvonly"===i.direction&&(i.setDirection?i.setDirection("inactive"):i.direction="inactive"):!0!==t.offerToReceiveAudio||i||n.addTransceiver("audio"),void 0!==t.offerToReceiveVideo&&(t.offerToReceiveVideo=!!t.offerToReceiveVideo);var r=n.getTransceivers().find(function(t){return t.sender.track&&"video"===t.sender.track.kind});!1===t.offerToReceiveVideo&&r?"sendrecv"===r.direction?r.setDirection("sendonly"):"recvonly"===r.direction&&r.setDirection("inactive"):!0!==t.offerToReceiveVideo||r||n.addTransceiver("video")}return e.apply(n,arguments)}}}},{"../utils":11}],11:[function(t,e,n){"use strict";function i(t,e,n){var i=t.match(e);return i&&i.length>=n&&parseInt(i[n],10)}var r=!0,s=!0;e.exports={extractVersion:i,wrapPeerConnectionEvent:function(t,e,n){if(t.RTCPeerConnection){var i=t.RTCPeerConnection.prototype,r=i.addEventListener;i.addEventListener=function(t,i){if(t!==e)return r.apply(this,arguments);var s=function(t){var e=n(t);e&&i(e)};return this.L=this.L||{},this.L[i]=s,r.apply(this,[t,s])};var s=i.removeEventListener;i.removeEventListener=function(t,n){if(t!==e||!this.L||!this.L[n])return s.apply(this,arguments);var i=this.L[n];return delete this.L[n],s.apply(this,[t,i])},Object.defineProperty(i,"on"+e,{get:function(){return this["_on"+e]},set:function(t){this["_on"+e]&&(this.removeEventListener(e,this["_on"+e]),delete this["_on"+e]),t&&this.addEventListener(e,this["_on"+e]=t)},enumerable:!0,configurable:!0})}},disableLog:function(t){return"boolean"!=typeof t?new Error("Argument type: "+typeof t+". Please use a boolean."):(r=t,t?"adapter.js logging disabled":"adapter.js logging enabled")},disableWarnings:function(t){return"boolean"!=typeof t?new Error("Argument type: "+typeof t+". Please use a boolean."):(s=!t,"adapter.js deprecation warnings "+(t?"disabled":"enabled"))},log:function(){if("object"==typeof window){if(r)return;"undefined"!=typeof console&&"function"==typeof console.log&&console.log.apply(console,arguments)}},deprecated:function(t,e){s&&console.warn(t+" is deprecated, please use "+e+" instead.")},detectBrowser:function(t){var e=t&&t.navigator,n={browser:null,version:null};if(void 0===t||!t.navigator)return n.browser="Not a browser.",n;if(e.mozGetUserMedia)n.browser="firefox",n.version=i(e.userAgent,/Firefox\/(\d+)\./,1);else if(e.webkitGetUserMedia)n.browser="chrome",n.version=i(e.userAgent,/Chrom(e|ium)\/(\d+)\./,2);else if(e.mediaDevices&&e.userAgent.match(/Edge\/(\d+).(\d+)$/))n.browser="edge",n.version=i(e.userAgent,/Edge\/(\d+).(\d+)$/,2);else{if(!t.RTCPeerConnection||!e.userAgent.match(/AppleWebKit\/(\d+)\./))return n.browser="Not a supported browser.",n;n.browser="safari",n.version=i(e.userAgent,/AppleWebKit\/(\d+)\./,1)}return n}}},{}]},{},[3])(3)})}).call(e,n(5))},function(t,e,n){"use strict";var i,r;i=[n(9),n(10),n(3)],void 0===(r=function(t,e,n){return t.PhenixVideo=n,t.onLoaded=function(){e(t)},t.onLoaded(),t}.apply(e,i))||(t.exports=r)},function(t,e,n){var i,r;i=[n(1),n(2),n(7),n(16),n(4),n(0)],void 0===(r=function(t,e,n,i,r,s){"use strict";function o(e,r,s){this.v=new n.DisposableList,this.f=new i.NamedEvents,this.B="video"===e.tagName,this.W=s.swfSrc,this.V=e.id||s.streamId,this.z=e.clientWidth,this.G=e.clientHeight,this.t=e,this.J=null,this.H=[],this.K=["uid="+this.V,"autoplay="+(!!t.isUndefined(e.autoplay)||e.autoplay),"allowScriptAccess=always","preload=true","src="+JSON.stringify(r)];var o=this;this.v.add(new n.Disposable(function(){d.call(o,"fire_stop")}));try{this.J=y||w?function(){return document.createElement("div")}.call(this):function(){var t=document.createElement("embed");return t.setAttribute("id","__"+this.V),t.setAttribute("name","__"+this.V),t.setAttribute("play","true"),t.setAttribute("loop","false"),t.setAttribute("quality","high"),t.setAttribute("bgcolor","#000000"),t.setAttribute("wmode","transparent"),t.setAttribute("allowScriptAccess","always"),t.setAttribute("allowFullScreen","true"),t.setAttribute("type","application/x-shockwave-flash"),t.setAttribute("pluginspage","//www.macromedia.com/go/getflashplayer"),t.setAttribute("src",this.W),t.setAttribute("flashvars",this.K.join("&")),this.B&&(t.setAttribute("width",this.z.toString()),t.setAttribute("height",this.G.toString())),t}.call(this),c.call(this)}catch(t){p("Error while loading Flash Player"+t)}}function a(e,n){return t.findIndex(this.H,function(t){return t.name===e&&t.listener===n})}function u(t,e){var n=document.createElement("param");return n.setAttribute("name",t),n.setAttribute("value",e),n}function c(){t.assign(this.J,m,{id:this.V,width:this.z,height:this.G,videoWidth:this.z,videoHeight:this.G}),function(){var e=this;s["__event__"+this.V]=function(t,n){var i=function(t,e){var n=t.match(/([a-z]+\.([a-z]+))/i),i={target:e};if(null!==n&&(t=n[1],i.namespace=n[2]),"IE"===g.browser&&g.version>8){var r=s.document.createEvent("CustomEvent");return r.initCustomEvent(t,!1,!1,i),r}return s.CustomEvent?new s.CustomEvent(t,{detail:i}):i}(t,e.J);if(n)try{i.data=JSON.parse(n),i.details.data=i.data}catch(t){i.message=n}switch(t){case"ended":break;case"error":e.J.error=i.data,e.J.dispatchEvent&&e.J.dispatchEvent(i);break;case"loadeddata":case"loadedmetadata":case"loadstart":e.J.dispatchEvent&&e.J.dispatchEvent(i);break;case"pause":e.J.paused=!0;break;case"play":case"playing":e.J.paused=!1;break;case"progress":case"seeked":case"seeking":case"stalled":case"suspend":e.J.dispatchEvent&&e.J.dispatchEvent(i);break;case"timeupdate":e.J.currentTime=f.call(e,"currentTime"),e.J.dispatchEvent&&e.J.dispatchEvent(i)}e.f.fireAsync(t,[i])};var i=this.J.requestFullscreen||this.J.mozRequestFullScreen||this.J.webkitRequestFullScreen||this.J.msRequestFullscreen;this.v.add(new n.Disposable(function(){delete s["__event__"+e.V]})),this.J.play=function(){d.call(e,"fire_play")},this.J.load=function(){d.call(e,"fire_load")},this.J.seek=function(){d.call(e,"fire_seek")},this.J.pause=function(){d.call(e,"fire_pause")},this.J.requestFullscreen=function(){if(e.Q=!0,function(){function t(){document.webkitIsFullScreen||document.mozFullScreen||document.msFullscreenElement||document.fullscreenElement||(document.removeEventListener("webkitfullscreenchange",t),document.removeEventListener("mozfullscreenchange",t),document.removeEventListener("fullscreenchange",t),document.removeEventListener("MSFullscreenChange",t),document.removeEventListener("keydown",e),n.Q=!1,n.J.style.position=n.X,n.J.style.height=n.Z,n.J.style.width=n.$)}function e(e){var n=e||s.event;("key"in n?"Escape"===n.key||"Esc"===n.key:27===n.keyCode)&&t()}var n=this;document.addEventListener("webkitfullscreenchange",t,!1),document.addEventListener("mozfullscreenchange",t,!1),document.addEventListener("fullscreenchange",t,!1),document.addEventListener("MSFullscreenChange",t,!1),document.addEventListener("keydown",e,!1)}.call(e),e.Z=e.J.style.height,e.$=e.J.style.width,e.X=e.J.style.position,e.J.style.position="absolute",e.J.style.height="100%",e.J.style.width="100%",void 0!==s.ActiveXObject){var t=new s("WScript.Shell");null!==t&&t.SendKeys("{F11}")}i.call(e.J)};var r=function(){d.call(e,"set_size",e.Q?screen.width:e.J.clientWidth,e.Q?screen.height:e.J.clientHeight)};t.addEventListener(s,"resize",r),this.v.add(new n.Disposable(function(){t.removeEventListener(s,"resize",r)}))}.call(this),function(){var e=this,i=["currentTime","paused","error","src"];if(t.get(s,["MutationObserver"])){var r=new MutationObserver(function(n){n.forEach(function(n){"attributes"!==n.type||n.target!==e.J||t.includes(i,n.attributeName)||h.call(e,n.attributeName,e.J[n.attributeName])})});r.observe(e.J,{attributes:!0}),e.v.add(new n.Disposable(function(){r.disconnect()}))}else{l("Falling back to use of DOM event listeners. This results in degraded performance for further DOM modifications and does not work for IE prior to version 9. See https://developer.mozilla.org/en-US/docs/Web/Guide/Events/Mutation_events for details.");var o=function(n){t.includes(i,n.target.tagName)||h.call(e,n.target.tagName,e.J[n.target.tagName])};e.J.addEventListener?(e.J.addEventListener("DOMAttrModified",o,!1),e.v.add(new n.Disposable(function(){e.J.removeEventListener("DOMAttrModified",o,!1)}))):(e.J.attachEvent("onpropertychange",o),e.v.add(new n.Disposable(function(){e.J.detachEvent("DOMAttrModified",o)})))}}.call(this),function(){var t=function(){var t=this,e=t.t.muted,n=t.J.muted;return function(){var i=t.J.muted,r=t.J.muted;i===e&&r===n||(i!==e&&(e=i,n=i,r=i),r!==n&&(e=i,n=i),t.J.muted=r,t.t.muted=r,h.call(t,"muted",r))}}.call(this),e=function(){var t=this,e=t.t.volume,n=t.J.volume;return function(){var i=t.J.volume,r=t.J.volume;i===e&&r===n||(i!==e&&(e=i,n=i,r=i),r!==n&&(e=i,n=i),t.J.volume=r,t.t.volume=r,h.call(t,"volume",r))}}.call(this),i=setInterval(function(){t(),e()},v);this.v.add(new n.Disposable(function(){clearInterval(i)}))}.call(this)}function h(e,n){return(this.J["set_"+e]||t.noop).call(this.J,n)}function f(e){return(this.J["get_"+e]||t.noop).call(this.J)}function d(t){var e=this.J[t];if([].shift.apply(arguments),e)return e.apply(this.J,arguments)}var l=function(){console.log.apply(console,arguments)}||function(){},p=function(){console.error.apply(console,arguments)}||l,m={width:480,height:360,videoWidth:480,videoHeight:360,muted:!1,volume:1,currentTime:0,duration:1/0,readyState:0,ended:!1,buffered:null,autoplay:!0},v=300,g=new e(navigator.userAgent).detect(),y="IE"===g.browser&&/(trident|microsoft)/i.test(t.get(s.navigator,["appName"],"")),w="Edge"===g.browser&&t.get(s.navigator,"msLaunchUri")&&!t.get(s.document,"documentMode");return o.prototype.finishInitializationInDom=function(){return function(){if(!y&&!w)return this.J;var e=(w?"__"+this.V:this.V)+t.uniqueId(),n=document.createElement("object"),i=document.createElement("div"),r=[u("movie",this.W+"?x="+t.now()),u("flashvars",this.K.join("&")),u("quality",2),u("bgcolor","#000000"),u("wmode","transparent"),u("allowScriptAccess","always"),u("allowFullScreen","true"),i];return i.innerHTML="You are using a browser that does not have Flash player enabled or installed. Please turn on your Flash player plugin or download the latest version from https://get.adobe.com/flashplayer/",w?(n.setAttribute("type","application/x-shockwave-flash"),n.setAttribute("data",this.W),n.setAttribute("id",e),n.setAttribute("width","__"+this.z.toString()),n.setAttribute("height","__"+this.G.toString())):(n.setAttribute("classid","clsid:D27CDB6E-AE6D-11cf-96B8-444553540000"),n.setAttribute("codebase","//download.macromedia.com/pub/shockwave/cabs/flash/swflash.cab"),n.setAttribute("id",e),n.setAttribute("width",this.z.toString()),n.setAttribute("height",this.G.toString())),n.object?(t.forEach(r,function(e){t.isNullOrUndefined(t.get(n.object,[e.name]))||(n.object[e.name]=e.value)}),n.appendChild(i)):t.forEach(r,function(e){var i=t.find(n.children,function(t){return t.name===e.name});return i?n.replaceChild(e,i):n.appendChild(e)}),this.J.outerHTML=n.outerHTML,s.document.getElementById&&(this.J=s.document.getElementById(e),c.call(this)),this.J}.call(this)},o.prototype.getElement=function(){return this.J},o.prototype.addEventListener=function(t,e){if(!(a.call(this,t,e)>-1)){var n=this.f.listen(t,e);this.v.add(n),this.H.push({name:t,listener:e,disposable:n})}},o.prototype.removeEventListener=function(t,e){var n=a.call(this,t,e);n>-1&&this.H.splice(n,1)[0].disposable.dispose()},o.prototype.destroy=function(){this.v.dispose()},o}.apply(e,i))||(t.exports=r)},function(t,e,n){var i,r;i=[n(1),n(6),n(8),n(4),n(3)],void 0===(r=function(t,e,n,i,r){"use strict";function s(){var t=this;this.Y=function(){var t=document.createElement("div");return t.id="phenixRTC",t.style.cssText="visibility:hidden !important;width:0px !important;height:0px !important;margin:0px !important;padding:0px !important;border-style:none !important;border-width:0px !important;max-width:0px !important;max-height:0px !important;outline:none !important",document.body.appendChild(t),t}(),this.tt="?";try{this.et=function(t){var e=document.createElement("object");return e.type="application/x-phenix-rtc",t.appendChild(e),e}(this.Y),this.et.onunload=function(){t.y=!1},(new i).waitForReady(this.et,function(e){t.y=!0,t.w=!0===e,t.tt=t.et.phenixVersion||"?.?.?.?",d(e?"Phenix RTC "+t.tt:"No Phenix RTC"),t.b&&t.b(t.w)})}catch(t){l("Error while loading Phenix RTC"+t)}}function o(){this.Y&&document.getElementById("phenixRTC")!==this.Y&&(document.body.appendChild(this.Y),this.nt&&this.nt.call(this))}function a(e){var n=function(){var n=null;switch(arguments.length){case 0:n=new e;break;case 1:n=new e(arguments[0]);break;case 2:n=new e(arguments[0],arguments[1]);break;case 3:n=new e(arguments[0],arguments[1],arguments[2]);break;case 4:n=new e(arguments[0],arguments[1],arguments[2],arguments[3]);break;case 5:n=new e(arguments[0],arguments[1],arguments[2],arguments[3],arguments[4]);break;default:throw new Error("Unsupported number of arguments in Phenix Object Constructor")}return n.phenixAddEventListener=t.bind(u,n),n.phenixRemoveEventListener=t.bind(c,n),n};return t.forOwn(e,function(t,e){n[e]=t}),n}function u(t,n){e.it(t,"name"),e.rt(n,"listener"),h.call(this,t),function(t,e){if(!this.events||!this.events[t])throw new Error("No event observable for event: "+name);this.events[t].listeners.push(e)}.call(this,t,n)}function c(t,e){f.call(this,t,e)}function h(e){if(!this.events||!this.events[e]){this.events||(this.events={});var i=this.events;i[e]={observable:(new n.Observable).extend({timeout:0}),subscription:null,listeners:[]},this.phenixSetEventListener(e,t.bind(i[e].observable.setValue,i[e].observable)),i[e].subscription=i[e].observable.subscribe(function(n){var r=i[e].listeners;t.forEach(r,function(t){t(n)})})}}function f(e,n){this.events&&this.events.events[e]&&(this.events[e].listeners=t.filter(this.events[e].listeners,function(t){return n!==t}))}var d=function(){console.log.apply(console,arguments)}||function(){},l=function(){console.error.apply(console,arguments)}||d;return s.prototype.onReady=function(t){var e=this;this.y?setTimeout(function(){t(e.w)},1):this.b=t},s.prototype.onLoaded=function(t){this.nt=t},s.prototype.isLoaded=function(){return!0===this.y},s.isSupported=function(){if(navigator.plugins)for(var t=navigator.plugins,e=0;e<t.length;e++)if(t[e].name.indexOf("PhenixRTC")>=0)return!0;if(navigator.userAgent&&(navigator.userAgent.match(/MSIE/)||navigator.userAgent.match(/Trident/)))try{return new window.ActiveXObject("PhenixP2P.RTC"),!0}catch(t){return!1}return!1},s.prototype.isEnabled=function(){return o.call(this),this.et&&void 0!==this.et.phenixVersion},s.prototype.getVersion=function(){return o.call(this),this.tt},s.prototype.getRTCPeerConnectionConstructor=function(){return o.call(this),a(this.et.RTCPeerConnection)},s.prototype.getRTCSessionDescriptionConstructor=function(){return o.call(this),a(this.et.RTCSessionDescription)},s.prototype.getRTCIceCandidateConstructor=function(){return o.call(this),a(this.et.RTCIceCandidate)},s.prototype.getSourcesDelegate=function(){var t=this;return function(e){return o.call(t),t.et.getSources(e)}},s.prototype.getUserMediaDelegate=function(){var t=this;return function(e,n,i){return o.call(t),t.et.getUserMedia(e,n,i)}},s.prototype.getStatsDelegate=function(){return function(t,e,n,i){return t.getStats(e,n,i)}},s.prototype.attachMediaStream=function(t,e){return o.call(this),function(t,e){if(!t)throw new Error("Can not attach a stream to a undefined element");if(t.phenixVersion)return t.src=e,t;var n=new r(t,e,!0);return n.getElement().phenixPresenter=n,n.getElement()}.call(this,t,e)},s.prototype.reattachMediaStream=function(t,e){return o.call(this),this.attachMediaStream(t,e.src)},s}.apply(e,i))||(t.exports=r)},function(t,e,n){var i,r;i=[n(1),n(2),n(11),n(0),n(3)],void 0===(r=function(t,e,n,i,r){"use strict";function s(){if(w=i.RTCPeerConnection,b=i.RTCSessionDescription,k=i.RTCIceCandidate,navigator.mediaDevices&&navigator.mediaDevices.enumerateDevices&&(S=t.bind(c,null,"input")),navigator.mediaDevices&&navigator.mediaDevices.enumerateDevices&&(I=t.bind(c,null,"output")),(navigator.mediaDevices&&navigator.mediaDevices.getUserMedia||i.getUserMedia)&&(E=o),!i.RTCPeerConnection)return g("[%s] browser version [%s] does not appear to be WebRTC-capable",y.browser,y.version);switch(y.browser){case"Firefox":g("Firefox detected",y),R=function(t,e){g("Attaching media stream");var n=t.muted;return y.version>57&&(t.srcObject=e),t.mozSrcObject=e,t.play(),!0===n&&(t.muted=!0),t},x=function(t,e){g("Reattaching media stream");var n=t.muted;return y.version>57&&(t.srcObject=e.srcObject),t.mozSrcObject=e.mozSrcObject,t.play(),!0===n&&(t.muted=!0),t},T=function(e,n,i,r){e.getStats(n,t.bind(l,this,e,i),r)},O=!0;break;case"Opera":g("Opera detected",y),R=h,x=d,T=function(e,n,i,r){e.getStats(t.bind(l,this,e,i),n,r)},O=!0;break;case"Chrome":g("Webkit detected",y),R=h,x=d,T=function(e,n,i,r){e.getStats(t.bind(l,this,e,i),n,r)},O=!0;break;case"Edge":g("Edge detected",y),R=h,x=d,T=function(e,n,i,r){e.getStats(n,t.bind(l,this,e,i),r)},O=!0;break;case"Safari":g("Safari detected",y),R=function(e,n){return t.st(n)&&(e.__phenixHasPlayedWebRtc=!0),h(e,n)},C=function(t,e){return t.__phenixHasPlayedWebRtc?((t=new r(t,e,!1).getElement()).play(),t):f(t,e)},x=d,T=function(e,n,i,r){e.getStats(n).then(t.bind(l,this,e,i),r)},O=!0;break;case"ReactNative":g("React Native detected",y),R=function(){g("attachMediaStream not supported in React Native environment")},C=function(){g("attachUriStream not supported in React Native environment")},x=function(){g("reattachMediaStream not supported in React Native environment")},T=function(e,n,i,r){e.getStats(n).then(t.bind(l,this,e,i),r)},O=!0;break;default:g("Browser does not appear to be WebRTC-capable",y)}}function o(e,n,r){var s=t.bind(a,this,e,n,r);return navigator&&t.rt(navigator.getUserMedia)?navigator.getUserMedia(e,s,r):i&&t.rt(i.getUserMedia)?i.getUserMedia(e,s,r):void 0}function a(t,e,n,i){setTimeout(function(){for(var r=i.getTracks(),s=0;s<r.length;s++){var o=r[s];if(o.onended=function(t){g(t.timeStamp,"Track",o.id,o.label,"ended")},g("Track",o.id,o.label,r[s].kind,"readyState=",r[s].readyState),"ended"===o.readyState)return u("User media not available",n,r)}var a=(t.audio?1:0)+(t.video?1:0);return r.length!==a?u("Unable to get all requested user media.",n,r):void e(i)},100)}function u(t,e,n){try{var i=new Error(t);i.code="unavailable",e(i)}finally{!function(t){for(var e=0;e<t.length;e++)t[e].stop()}(n)}}function c(t,e){if("input"!==t&&"output"!==t)throw new Error("Unsupported device type "+t);navigator.mediaDevices&&navigator.mediaDevices.enumerateDevices().then(function(n){var i=[];n.forEach(function(e){e.kind==="audio"+t?i.push({kind:"audio",id:e.deviceId,label:e.label}):e.kind==="video"+t&&i.push({kind:"video",id:e.deviceId,label:e.label})}),e(i)})}function h(t,e){return void 0!==t.srcObject?t.srcObject=e:void 0!==t.mozSrcObject?t.mozSrcObject=e:void 0!==t.src?t.src=URL.createObjectURL(e):g("Error attaching stream to element."),t.play(),t}function f(t,e){return t.src=e,t.play(),t}function d(t,e){return t.src=e.src,t}function l(t,e,n){e(p(t,n))}function p(e,n){switch(y.browser){case"Edge":n.forEach(function(t){t.mediaType=m(e,t.codecId),t.bytesSent=v(t.packetsSent,t.mediaType),t.bytesReceived=v(t.packetsReceived,t.mediaType)});break;case"Safari":n.forEach(function(e){t.includes(e.id.toLowerCase(),"audio")&&t.includes(e.id.toLowerCase(),"rtp")&&(e.mediaType="audio"),t.includes(e.id.toLowerCase(),"video")&&t.includes(e.id.toLowerCase(),"rtp")&&(e.mediaType="video")})}return n}function m(e,n){var i;if(n)return function(e,n){var i=e.localDescription.sdp.split("m="),r=e.remoteDescription.sdp.split("m=");i.length===r.length&&t.findIndex(i,function(t,e){return n(t)})}(e,function(e){t.startsWith(e,"video")&&t.includes(e.toLowerCase(),n.toLowerCase())&&(i="video"),t.startsWith(e,"audio")&&t.includes(e.toLowerCase(),n.toLowerCase())&&(i="audio")}),i}function v(t,e){var n=parseInt(t)||0;return"audio"===e?100*n:"video"===e?1080*n:void 0}var g=function(){console.log.apply(console,arguments)},y=new e(navigator.userAgent).detect(),w=i.RTCPeerConnection,b=i.RTCSessionDescription,k=i.RTCIceCandidate,S=null,I=null,E=null,T=null,R=null,C=null,x=null,O=!1;return function(){s();var t={RTCPeerConnection:w,RTCSessionDescription:b,RTCIceCandidate:k,getSources:S,getDestinations:I,getUserMedia:E,getStats:T,attachMediaStream:R,attachUriStream:C||f,reattachMediaStream:x,webrtcSupported:O,exportGlobal:function(){i.RTCPeerConnection=t.RTCPeerConnection,i.RTCSessionDescription=t.RTCSessionDescription,i.RTCIceCandidate=t.RTCIceCandidate}};return t}}.apply(e,i))||(t.exports=r)},function(t,e){t.exports=u}]))},function(t,e,n){var i,r;i=[n(81),n(80)],void 0===(r=function(t,e){return{Disposable:t,DisposableList:e}}.apply(e,i))||(t.exports=r)},function(t,e,n){var i,r;i=[n(26),n(77)],void 0===(r=function(t,e){return{Event:t,NamedEvents:e}}.apply(e,i))||(t.exports=r)},function(t,e,n){var i;void 0===(i=function(){"use strict";return{networkStates:{networkEmpty:{id:0,name:"NETWORK_EMPTY"},networkIdle:{id:1,name:"NETWORK_IDLE"},networkLoading:{id:2,name:"NETWORK_LOADING"},networkNoSource:{id:3,name:"NETWORK_NO_SOURCE"}},types:{realTime:{id:0,name:"real-time"},dash:{id:1,name:"dash"},hls:{id:2,name:"hls"},rtmp:{id:0,name:"rtmp"}},streamEvents:{playerEnded:{id:0,name:"playerended"},playerError:{id:1,name:"playererror"},stopped:{id:2,name:"stopped"}},rendererEvents:{ended:{id:0,name:"ended"},error:{id:1,name:"error"}}}}.apply(e,[]))||(t.exports=i)},function(t,e,n){var i,r;i=[n(55)],void 0===(r=function(t){"use strict";return t}.apply(e,i))||(t.exports=r)},function(t,e,n){var i,r;i=[n(27),n(79),n(78)],void 0===(r=function(t,e,n){"use strict";return{Observable:t,ObservableArray:e,ObservableMonitor:n}}.apply(e,i))||(t.exports=r)},function(t,e,n){var i,r;i=[n(0),n(1),n(4)],void 0===(r=function(t,e,n){"use strict";var i=500,r=15;function s(t,s){e.st(t,"logger"),this.ot=t,this.at=new n.Event,this.ut=null,this.ct=!1,this.ht=null,this.ft={pollFrequency:i,previousWidth:0,previousHeight:0},s&&s.pollFrequency&&(this.ft.pollFrequency=s.pollFrequency>=r?s.pollFrequency:r),this.dt=null}function o(){if(this.ct&&!this.ut&&0!==this.at.size()){var t=this;this.ft.previousWidth=this.ht.videoWidth,this.ft.previousHeight=this.ht.videoHeight,this.ut=setInterval(function(){t.ht.videoWidth===t.ft.previousWidth&&t.ht.videoHeight===t.ft.previousHeight||(t.ft.previousWidth=t.ht.videoWidth,t.ft.previousHeight=t.ht.videoHeight,t.at.fireAsync([t.dt,{width:t.ht.videoWidth,height:t.ht.videoHeight}]))},t.ft.pollFrequency)}}return s.prototype.start=function(e,n){(function(e,n){n&&!t.isUndefined(n.videoWidth)||this.ot.warn("Attempting to start dimensions changed monitor without providing proper 'video' element."),this.dt=e,this.ht=n,this.ct=!0,o.call(this)}).call(this,e,n)},s.prototype.stop=function(){(function(){this.ct=!1,this.ut&&(clearInterval(this.ut),this.ut=null),this.at.dispose()}).call(this)},s.prototype.addVideoDisplayDimensionsChangedCallback=function(t){return e.rt(t,"addVideoDisplayDimensionsChangedCallback"),o.call(this),this.at.listen(t)},s.prototype.toString=function(){return"DimensionsChangedMonitor[pollFrequency="+this.ft.pollFrequency+", previousHeight="+this.ft.previousHeight+", previousWidth="+this.ft.previousHeight+", state="+(this.ut?"running":"stopped")+"]"},s}.apply(e,i))||(t.exports=r)},function(t,e,n){var i,r;i=[n(75)],void 0===(r=function(t){"use strict";return t()}.apply(e,i))||(t.exports=r)},function(t,e,n){var i,r;i=[n(76),n(73),n(15)],void 0===(r=function(t,e,n){"use strict";return{createLogger:function(){return new t},Logger:t,ConsoleAppender:e,level:n.level}}.apply(e,i))||(t.exports=r)},function(t,e,n){var i;void 0===(i=function(){"use strict";return{isSupported:!1}}.apply(e,[]))||(t.exports=i)},function(t,e,n){var i,r;i=[n(0),n(2)],void 0===(r=function(t,e){"use strict";function n(){}function i(e){return t.includes(e.id,"send")||t.includes(e.id,"outbound")||"outboundrtp"===e.type||"outbound-rtp"===e.type||"kOutboundRtp"===e.type}function r(e){return t.includes(e.id,"recv")||"inboundrtp"===e.type||"inbound-rtp"===e.type||"kInboundRtp"===e.type}return n.convertPeerConnectionStats=function(n,s){return function(n,s){if(!n)return null;var o=[],a=function(n){var s={};switch(e.browser){case"Firefox":return t.forOwn(n,function(e,i){t.includes(i,"rtcp")&&t.forOwn(n,function(n,i){t.includes(i,"rtp")&&e.mediaType===n.mediaType&&(n.jitter=1e3*(e.jitter||n.jitter),n.roundTripTime=e.roundTripTime)})}),n;case"IE":return t.forOwn(n,function(e,n){t.startsWith(n,"ssrc")&&(s[e.id]=e)}),s;case"Edge":return n.forEach(function(e){s[e.id]=e,t.hasIndexOrKey(e,"jitter")&&(e.jitter*=1e3)}),t.forOwn(s,function(e){"track"===e.type&&t.hasIndexOrKey(e,"framesPerSecond")&&t.forOwn(s,function(t){"video"===t.mediaType&&(t.framesPerSecond=parseInt(e.framesPerSecond,10))})}),s;case"Safari":return n.forEach(function(t){s[t.id]=t}),t.forOwn(s,function(e){if(t.hasIndexOrKey(e,"id")&&r(e)){var n=parseInt(t.get(e.id.split("_"),[1]),10);e.ssrc=n||e.ssrc}t.hasIndexOrKey(e,"jitter")&&(e.jitter*=1e3),"candidate-pair"===e.type&&t.forOwn(s,function(t){"audio"!==t.mediaType&&"video"!==t.mediaType||(t.currentRoundTripTime=1e3*e.currentRoundTripTime)}),"track"===e.type&&t.forOwn(s,function(t){"audio"===t.mediaType&&r(t)?t.audioOutputLevel=1e5*e.audioLevel:"audio"===t.mediaType&&i(t)&&(t.audioInputLevel=1e5*e.audioLevel)})}),s;case"ReactNative":return(t.lt(n)?JSON.parse(n):n).forEach(function(e){var n={id:e.id,type:e.type};e.values.forEach(function(e){t.keys(e).forEach(function(t){n[t]=e[t]})}),s[n.id]=n}),s;case"Chrome":default:return n.result().forEach(function(t){var e={id:t.id,type:t.type};t.names().forEach(function(n){e[n]=t.stat(n)}),e.timestamp=t.timestamp.getTime(),s[e.id]=e}),s}}(n);return t.forOwn(a,function(e){if(t.hasIndexOrKey(e,"ssrc")&&e.ssrc&&!t.includes(e.id,"rtcp")){var n=e.id||e.ssrc;t.hasIndexOrKey(s,n)||(s[n]={timestamp:t.now()});var a="?",u=parseFloat(e.timestamp)-s[n].timestamp,c=function(e,n,i){if(!t.isUndefined(n))return e?8*(e-(n||0))/i:0}(parseFloat(e.bytesSent),s[n].bytesSent,u),h=function(e,n,i){if(!t.isUndefined(n))return e?8*(e-(n||0))/i:0}(parseFloat(e.bytesReceived),s[n].bytesReceived,u),f=function(e,n,i){if(!t.isUndefined(n))return(e-n)/(i/1e3)}(parseFloat(e.framesEncoded||e.framesDecoded),s[n].framesEncoded||s[n].framesDecoded,u);i(e)&&(a="upload"),r(e)&&(a="download");var d={uploadRate:c,downloadRate:h,mediaType:e.mediaType,ssrc:e.ssrc,direction:a,nativeReport:e,rtt:e.rtt||e.googRtt||e.roundTripTime||e.currentRoundTripTime||"?",bitrateMean:parseInt(e.bitrateMean,10)||1e3*(i(e)?c:h)||void 0,targetDelay:parseInt(e.targetDelay||e.googTargetDelayMs,10)||void 0,currentDelay:parseInt(e.currentDelay||e.currentDelayMs||e.googCurrentDelayMs,10)||void 0};t.assign(s[n],e),"video"===e.mediaType&&(d=t.assign(d,{droppedFrames:parseInt(e.droppedFrames,10)||0,framerateMean:parseInt(e.framerateMean||f,10)||e.framesPerSecond||0,cpuLimitedResolution:e.cpuLimitedResolution||e.googCpuLimitedResolution,avgEncode:parseInt(e.avgEncode||e.avgEncodeMs||e.googAvgEncodeMs,10)})),"audio"===e.mediaType&&(d=t.assign(d,{audioInputLevel:e.audioInputLevel||e.googAudioInputLevel,audioOutputLevel:e.audioOutputLevel||e.googAudioOutputLevel,jitter:parseInt(e.jitter||e.jitterReceived||e.googJitterReceived,10)||void 0,jitterBuffer:parseInt(e.jitterBuffer||e.jitterBufferMs||e.googJitterBufferMs,10)||void 0})),o.push(d)}}),o}(n,s)},n}.apply(e,i))||(t.exports=r)},function(t,e,n){var i,r;i=[n(69),n(58),n(23)],void 0===(r=function(t,e,n){return{MQWebSocket:t,BatchHttpProto:e,MQService:n}}.apply(e,i))||(t.exports=r)},function(t,e,n){var i,r;i=[n(0)],void 0===(r=function(t){"use strict";return{parseEnvFromPcastBaseUri:function(e){return e=e.toLowerCase(),t.includes(e,"local")?"local":t.includes(e,"stg")?"staging":"production"}}}.apply(e,i))||(t.exports=r)},function(t,e,n){var i;void 0===(i=function(){"use strict";return{level:{TRACE:0,DEBUG:1,INFO:2,WARN:3,ERROR:4,FATAL:5}}}.apply(e,[]))||(t.exports=i)},function(t,e,n){var i,r;i=[n(0),n(1),n(6),n(3)],void 0===(r=function(t,e,n,i){"use strict";var r=2e4,s={timeout:r,retryOptions:{backoff:1.5,delay:1e3,maxAttempts:3,additionalRetryErrorCodes:[0]}},o={body:{id:1,name:"body"},header:{id:2,name:"header"}},a={createStreamTokenPath:"/stream",createAuthTokenPath:"/auth"},u={auth:{id:1,name:"auth"},stream:{id:2,name:"stream"}};function c(){this.pt=null,this.mt="",this.vt=a,this.gt={},this.yt=o.body.name,this.v=new i.DisposableList}function h(e,n){var s=null,o=e(t.bind(d,this,function(t,e){clearTimeout(s),n(t,e)}));return s=setTimeout(function(){o.dispose(),n(new Error("timeout"))},r),this.v.add(o),this.v.add(new i.Disposable(function(){clearTimeout(s)})),o}function f(e,n,i,r,s){switch(this.yt){case o.body.name:r=function(e){return t.assign({},e,this.gt)}.call(this,r);break;case o.header.name:s=function(e){return e.headers?(e.headers=t.assign({},this.gt,e.headers),e):t.assign({},{headers:this.gt},e)}.call(this,s);break;default:throw new Error("Unsupported Authentication Mode "+this.yt)}return t.bind(e,n,i,JSON.stringify(r),s)}function d(t,e,n){if(e)return t(e,{});var i=JSON.parse(n.data);return"ok"!==i.status?t(null,{status:i.status}):t(null,i)}function l(t,e,n,i){if(!i||n)return e(n,{status:"failed"});var r={status:"ok"};switch(t){case u.auth.name:r.authenticationToken=i;break;case u.stream.name:r.streamToken=i;break;default:throw new Error("Unsupported request type "+t)}return e(n,r)}return c.prototype.dispose=function(){return this.v.dispose()},c.prototype.toString=function(){return"AdminApiProxyClient[customRequestHandler="+(!!this.pt).toString()+",backendUri="+this.mt+",authenticationDataLocationInPayload="+this.yt+",customEndpointPaths="+(this.vt===a).toString()+",customAuthenticationData="+(t.keys(this.gt).length>0).toString()+"]"},c.prototype.getBackendUri=function(){return this.mt},c.prototype.setBackendUri=function(t){e.lt(t,"backendUri"),this.mt=t},c.prototype.getEndpointPaths=function(){return t.assign({},this.vt)},c.prototype.setEndpointPaths=function(n){e.st(n,"endpointPaths"),n.createStreamTokenPath&&e.wt(n.createStreamTokenPath,"endpointPaths.createStreamTokenPath"),n.createAuthTokenPath&&e.wt(n.createAuthTokenPath,"endpointPaths.createAuthTokenPath"),this.vt=t.assign({},a,n)},c.prototype.getAuthenticationData=function(){return t.assign({},this.gt)},c.prototype.setAuthenticationData=function(t){e.st(t,"authenticationData"),this.gt=t},c.prototype.getAuthenticationDataLocationInPayload=function(){return this.yt},c.prototype.setAuthenticationDataLocationInPayload=function(t){e.bt(t,o,"authenticationDataLocationInPayload"),this.yt=t},c.prototype.getRequestHandler=function(){return this.pt},c.prototype.setRequestHandler=function(n){if(e.rt(n,"callback"),this.mt)throw new Error("Conflicting parameter [backendUri]");if(t.keys(this.gt).length>0)throw new Error("Conflicting parameter [authenticationData]");if(this.yt!==o.body.name)throw new Error("Conflicting parameter [authenticationDataLocationInPayload]");if(this.vt!==a)throw new Error("Conflicting parameter [endpointPaths]");this.pt=n},c.prototype.createAuthenticationToken=function(e){if(this.pt)return this.pt(u.auth.name,{},t.bind(l,this,u.auth.name,e));var i=f.call(this,n.postWithRetry,n,this.mt+this.vt.createAuthTokenPath,{},s);return h.call(this,i,e)},c.prototype.createStreamTokenForPublishing=function(i,r,o){e.wt(i,"sessionId"),e.st(r,"capabilities");var a={sessionId:i,capabilities:r};if(this.pt)return this.pt(u.stream.name,a,t.bind(l,this,u.stream.name,o));var c=f.call(this,n.postWithRetry,n,this.mt+this.vt.createStreamTokenPath,a,s);return h.call(this,c,o)},c.prototype.createStreamTokenForPublishingToExternal=function(t,e,n,i){this.createStreamTokenForSubscribing(t,e,n,null,i)},c.prototype.createStreamTokenForSubscribing=function(i,r,o,a,c){e.wt(i,"sessionId"),e.st(r,"capabilities"),t.isNullOrUndefined(a)||(e.isArray(a,"additionalStreamIds"),t.forEach(a,function(t){e.wt(t,"alternateOriginStreamId")}));var d={sessionId:i,capabilities:r,originStreamId:o};if(a&&a.length>0&&(d.alternateOriginStreamIds=a),this.pt)return this.pt(u.stream.name,d,t.bind(l,this,u.stream.name,c));var p=f.call(this,n.postWithRetry,n,this.mt+this.vt.createStreamTokenPath,d,s);return h.call(this,p,c)},c}.apply(e,i))||(t.exports=r)},function(t,e,n){var i,r;i=[n(0),n(1),n(2),n(30)],void 0===(r=function(t,e,n,i){"use strict";function r(n,i){e.st(n,"pcast"),i&&e.st(i,"options"),i&&i.screenShare&&e.rt(i.screenShare,"options.screenShare"),this.kt=n,this.ot=n.getLogger(),this.h=i||{},this.St=t.get(i,["onScreenShare"])}return r.prototype.getUserMedia=function(r,s){e.st(r,"deviceOptions");var o=new i(this.h),a=o.getDefaultResolution(),u=o.getDefaultFrameRate();(function e(i,r,s,o,a){var u=this.getVendorSpecificConstraints(i,r||{},s),c=!!u.video,h=this;this.kt.getUserMedia(u,function(u,f,d,l){if("ok"===f)return a(null,{userMedia:d,options:{frameRate:c?s:null,resolution:c?t.get(r,["height"],null):null,aspectRatio:c?t.get(r,["aspectRatio"],null):null}});var p=r,m=s,v=function(t){return t.constraintName?t.constraintName:t.constraint?t.constraint:""}(l);if(l&&("ConstraintNotSatisfiedError"===l.name||"OverconstrainedError"===l.name||"OverconstrainedError"===l.constructor.name||"unavailable"===l.code&&"Edge"===n.browser))switch(v.toLowerCase()){case"width":case"height":if(!r||!o.canResolveNextResolution())break;return h.ot.warn("Unable to get user media with constraint [%s] with height [%s] and width [%s]. Retrying with next closest resolution.",v,p.height,p.width),p=o.getNextResolution(r.height,r.aspectRatio),e.call(h,i,p,m,o,a);case"framerate":default:if(s)return h.ot.warn("Unable to get user media with constraint [%s] and framerate [%s]. Retrying without frame rate constraint.",v,s),e.call(h,i,p,m=null,o,a);if(!r||!o.canResolveNextResolution())break;return h.ot.warn("Unable to get user media with constraint [%s] with height [%s] and width [%s]. Retrying with next closest resolution.",v,p.height,p.width),p=o.getNextResolution(r.height,r.aspectRatio),e.call(h,i,p,m,o,a)}return h.ot.error("Unable to get user media with status [%s]",f,l),a(l)},function(e){var i=e;if(h.St&&"Chrome"===n.browser){var r,s=function(e){var n=t.get(e,["video","mandatory","chromeMediaSource"]),i=t.get(e,["audio","mandatory","chromeMediaSource"]),r=t.get(e,["video","mandatory","chromeMediaSourceId"]),s=t.get(e,["audio","mandatory","chromeMediaSourceId"]),o={};return(n||s)&&(t.set(o,["screen","mediaSource"],n),t.set(o,["screen","mediaSourceId"],r)),(i||s)&&(t.set(o,["screenAudio","mediaSource"],i),t.set(o,["screenAudio","mediaSourceId"],s)),o}(e);(i=h.St(s)).resolutionHeight&&i.aspectRatio&&(r={width:o.calculateWidthByAspectRatio(i.resolution,i.aspectRatio),height:i.resolutionHeight}),i=function(e,n,i){var r=this.getVendorSpecificConstraints(e,n,i);r.screen&&(r.video=r.screen,delete r.screen),r.screenAudio&&(r.audio=r.screenAudio,delete r.screenAudio);var s=t.get(r,["video","mandatory","mediaSource"]),o=t.get(r,["audio","mandatory","mediaSource"]),a=t.get(r,["video","mandatory","mediaSourceId"]),u=t.get(r,["audio","mandatory","mediaSourceId"]);return(s||a)&&(t.set(r,["video","mandatory","chromeMediaSource"],s),t.set(r,["video","mandatory","chromeMediaSourceId"],a),delete r.video.mandatory.mediaSource,delete r.video.mandatory.mediaSourceId),(o||u)&&(t.set(r,["audio","mandatory","chromeMediaSource"],o),t.set(r,["audio","mandatory","chromeMediaSourceId"],u),delete r.audio.mandatory.mediaSource,delete r.audio.mandatory.mediaSourceId),r}.call(h,s,r,i.frameRate)}return i})}).call(this,r,a,u,o,s)},r.prototype.getVendorSpecificConstraints=function(t,e,i){if(e=e||{},!t||!t.audio&&!t.video&&!t.screen&&!t.screenAudio)throw new Error("Invalid device options. Must pass in at least one device option.");return"Firefox"===n.browser&&n.browserVersion>38||"Chrome"===n.browser&&n.browserVersion>52&&!t.screen&&!t.screenAudio||"Safari"===n.browser&&n.browserVersion>10||"Opera"===n.browser&&n.browserVersion>40?function(t,e,n){var i=t.video,r=t.audio,s=t.screen,o=t.screenAudio,a=e.width,u=e.height,c={};return i&&(c.video={height:{min:u,ideal:u,max:u},width:{min:a,ideal:a,max:a},frameRate:{ideal:n,max:n}},i.deviceId&&(c.video.deviceId={exact:i.deviceId}),i.facingMode&&(c.video.facingMode=i.facingMode),a||delete c.video.width,u||delete c.video.height,n||delete c.video.frameRate,a||u||n||i.deviceId||i.facingMode||(c.video=!0)),r&&(c.audio={},r.deviceId&&(c.audio.deviceId={exact:r.deviceId}),r.mediaSource&&(c.audio.mediaSource=r.mediaSource),r.mediaSourceId&&(c.audio.mediaSourceId=r.mediaSourceId),r.deviceId||r.mediaSource||r.mediaSourceId||(c.audio=!0)),o&&(c.screenAudio={},o.deviceId&&(c.screenAudio.deviceId={exact:o.deviceId}),o.mediaSource&&(c.screenAudio.mediaSource=o.mediaSource),o.mediaSourceId&&(c.screenAudio.mediaSourceId=o.mediaSourceId),o.deviceId||o.mediaSource||o.mediaSourceId||(c.screenAudio=!0)),s&&(c.screen={height:{min:u,ideal:u,max:u},width:{min:a,ideal:a,max:a},frameRate:{ideal:n,max:n}},a||delete c.screen.width,u||delete c.screen.height,n||delete c.screen.frameRate,s.mediaSource&&(c.screen.mediaSource=s.mediaSource),a||u||n||s.mediaSource||(c.screen=!0)),s&&i&&(c.screen=!0),c}(t,e,i):"Edge"===n.browser?function(t,e,n){var i=t.video,r=t.audio,s=t.screen,o=e.width,a=e.height,u={};return i&&(u.video={height:{min:a,max:a,exact:a},width:{min:o,max:o,exact:o},frameRate:n},i.deviceId&&(u.video.deviceId=i.deviceId),i.facingMode&&(u.video.facingMode=i.facingMode),o||delete u.video.width,a||delete u.video.height,n||delete u.video.frameRate,o||a||n||i.deviceId||i.facingMode||(u.video=!0)),r&&(u.audio=!0,r.deviceId&&(u.audio={deviceId:r.deviceId})),s&&(u.screen=!0),u}(t,e,i):function(t,e,n){var i=t.video,r=t.audio,s=t.screen,o=t.screenAudio,a=e.width,u=e.height,c={};return i&&(c.video={mandatory:{minHeight:u,maxHeight:u,minWidth:a,maxWidth:a,maxFrameRate:n}},i.deviceId&&(c.video.mandatory.sourceId=i.deviceId),i.facingMode&&(c.video.facingMode=i.facingMode),i.mediaSource&&(c.video.mandatory.mediaSource=i.mediaSource),i.mediaSourceId&&(c.video.mandatory.mediaSourceId=i.mediaSourceId),a||(delete c.video.mandatory.minWidth,delete c.video.mandatory.maxWidth),u||(delete c.video.mandatory.minHeight,delete c.video.mandatory.maxHeight),n||delete c.video.mandatory.maxFrameRate,a||u||n||i.deviceId||i.facingMode||i.mediaSource||i.mediaSourceId||(c.video=!0)),r&&(c.audio={mandatory:{}},r.deviceId&&(c.audio.mandatory.sourceId=r.deviceId),r.mediaSource&&(c.audio.mandatory.mediaSource=r.mediaSource),r.mediaSourceId&&(c.audio.mandatory.mediaSourceId=r.mediaSourceId),r.deviceId||r.mediaSource||r.mediaSourceId||(c.audio=!0)),o&&(c.screenAudio={mandatory:{}},o.deviceId&&(c.screenAudio.mandatory.sourceId=o.deviceId),o.mediaSource&&(c.screenAudio.mandatory.mediaSource=o.mediaSource),o.mediaSourceId&&(c.screenAudio.mandatory.mediaSourceId=o.mediaSourceId),o.deviceId||o.mediaSource||o.mediaSourceId||(c.screenAudio=!0)),s&&(c.screen={mandatory:{minHeight:u,maxHeight:u,minWidth:a,maxWidth:a,maxFrameRate:n}},a||(delete c.screen.mandatory.minWidth,delete c.screen.mandatory.maxWidth),u||(delete c.screen.mandatory.minHeight,delete c.screen.mandatory.maxHeight),n||delete c.screen.mandatory.maxFrameRate,s.mediaSource&&(c.screen.mandatory.mediaSource=s.mediaSource),s.mediaSourceId&&(c.screen.mandatory.mediaSourceId=s.mediaSourceId),a||u||n||s.mediaSource||(c.screen=!0)),s&&i&&(c.screen=!0),c}(t,e,i)},r}.apply(e,i))||(t.exports=r)},function(t,e,n){var i,r;i=[n(0),n(1),n(4),n(2),n(11),n(36),n(35),n(34),n(5)],void 0===(r=function(t,e,n,i,r,s,o,a,u){"use strict";function c(t,e,i,r,s,o,a){this.It=t,this.Et=e,this.Tt=i,this.Rt=r,this.h=s,this.Ct=o,this.ot=a,this.xt=[],this.Ot=null,this.Pt=new n.NamedEvents}return c.prototype.on=function(t,e){this.Pt.listen(t,e)},c.prototype.createRenderer=function(){var e=null;switch(this.It){case u.types.dash.name:e=this.Ct?new s(this.Et,this.Tt,this.Rt,this.h,this.Ct,this.ot):new o(this.Et,this.Tt,this.Rt,this.h,this.ot);break;case u.types.hls.name:e=new o(this.Et,this.Tt,this.Rt,this.h,this.ot);break;case u.types.rtmp.name:e=new a(this.Et,this.Tt,this.Rt,this.h,this.ot);break;default:throw new Error("Unsupported Live stream Type "+this.It)}var n=this;return e.on(u.rendererEvents.error.name,function(t,e){n.Pt.fire(u.streamEvents.playerError.name,[t,e])}),e.on(u.rendererEvents.ended.name,function(i){n.xt=t.filter(n.xt,function(t){return t!==e}),0===n.xt.length&&(n.Rt.stop(),n.Pt.fire(u.streamEvents.playerEnded.name,[i]))}),this.xt.push(e),e},c.prototype.select=function(t){return this.ot.warn("[%s] selection of tracks not supported for [%s] live streams",this.Et,this.It),this},c.prototype.setStreamEndedCallback=function(t){e.rt(t,"callback"),this.streamEndedCallback=t},c.prototype.setStreamErrorCallback=function(t){e.rt(t,"callback"),this.streamErrorCallback=t},c.prototype.stop=function(t){this.isActive()&&(this.ot.info("[%s] stop [live] media stream with reason [%s]",this.Et,t),this.Pt.fire(u.streamEvents.stopped.name,[t]),this.Mt=!0)},c.prototype.monitor=function(t,n){e.st(t,"options"),e.rt(n,"callback")},c.prototype.getMonitor=function(){return null},c.prototype.getStream=function(){return this.ot.debug("[%s] stream not available for [%s] live streams",this.Et,this.It),null},c.prototype.isActive=function(){return!this.Mt},c.prototype.getStreamId=function(){return this.Et},c.prototype.getStats=function(){return this.ot.debug("[%s] stats not available for [%s] live streams",this.Et,this.It),null},c.prototype.getRenderer=function(){return t.get(this.xt,[0],null)},c.canPlaybackType=function(t){switch(t){case u.types.dash.name:return r.WebPlayer.deviceSupportsDashPlayback;case u.types.hls.name:return r.WebPlayer.deviceSupportsHlsPlayback;case u.types.rtmp.name:return a.isSupported();default:return!1}},c}.apply(e,i))||(t.exports=r)},function(t,e,n){var i,r;i=[n(0),n(1)],void 0===(r=function(t,e){"use strict";var n=/profile-level-id=[^;\n]*/,i=/vp8/i,r=/vp9/i,s=/h264/i,o=/h265/i;function a(){}return a.prototype.getH264ProfileIds=function(i){e.wt(i,"offerSdp");for(var r=[],s=i.match(n),o=i;s;){var a=t.get(s,"0","");r.push(a.split("=")[1]),s=(o=o.substring(s.index+a.length,i.length)).match(n)}return r},a.prototype.replaceH264ProfileId=function(n,i,r){e.wt(n,"offerSdp"),e.wt(r,"newProfileId");var s=this.getH264ProfileIds(n);return t.includes(s,i)?n.replace("profile-level-id="+i,"profile-level-id="+r):n},a.prototype.getH264ProfileIdWithSameProfileAndEqualToOrHigherLevel=function(e,n){if(t.includes(e,n))return n;var i=t.reduce(e,function(t,e){var n=parseInt(t.substring(0,2),16),i=parseInt(t.substring(4,6),16),r=parseInt(e.substring(0,2),16),s=parseInt(e.substring(4,6),16);return n!==r?t:i>=s?t:e},n);return i===n?null:i},a.prototype.getH264ProfileIdWithSameOrHigherProfileAndEqualToOrHigherLevel=function(e,n){var i=this.getH264ProfileIdWithSameProfileAndEqualToOrHigherLevel(e,n);if(i)return i;var r=t.reduce(e,function(t,e){var n=parseInt(t.substring(0,2),16),i=parseInt(t.substring(4,6),16),r=parseInt(e.substring(0,2),16),s=parseInt(e.substring(4,6),16);return n<r?e:r<n?t:i>s?t:e},n);return r===n?null:r},a.prototype.getSupportedCodecs=function(t){e.wt(t,"offerSdp");var n=[];return i.test(t)&&n.push("VP8"),r.test(t)&&n.push("VP9"),s.test(t)&&n.push("H264"),o.test(t)&&n.push("H265"),n},a.prototype.hasMediaSectionsInLocalSdp=function(e){var n=this.findInSdpSections(e,function(e){return t.startsWith(e,"video")||t.startsWith(e,"audio")});return t.Dt(n)},a.prototype.hasActiveAudio=function(e){var n=this.findInSdpSections(e,function(e,n,i){return!!t.startsWith(e,"audio")&&!t.includes(e,"a=inactive")&&!t.includes(i[n],"a=inactive")});return t.Dt(n)},a.prototype.hasActiveVideo=function(e){var n=this.findInSdpSections(e,function(e,n,i){return!!t.startsWith(e,"video")&&!t.includes(e,"a=inactive")&&!t.includes(i[n],"a=inactive")});return t.Dt(n)},a.prototype.findInSdpSections=function(e,n){var i=this.getLocalSdp(e).split("m="),r=this.getRemoteSdp(e).split("m=");return i.length===r.length&&t.findIndex(i,function(t,e){return n(t,e,r)})},a.prototype.getNumberOfActiveSections=function(e){var n=(this.getLocalSdp(e)||this.getRemoteSdp(e)).split("m=");return t.filter(n,function(e){return!t.includes(e,"a=inactive")&&(t.startsWith(e,"audio")||t.startsWith(e,"video"))}).length},a.prototype.getLocalSdp=function(e){return t.get(e,["localDescription","sdp"],"")},a.prototype.getRemoteSdp=function(e){return t.get(e,["remoteDescription","sdp"],"")},new a}.apply(e,i))||(t.exports=r)},function(t,e,n){var i,r;i=[n(0),n(1),n(2),n(19),n(12)],void 0===(r=function(t,e,n,i,r){"use strict";function s(t,n,i){e.lt(t,"name"),e.st(n,"peerConnection"),e.st(i,"logger"),this.qt=t,this.At=n,this.ot=i,this.Nt={}}function o(e){var n=function(e){var n=e.getSenders?t.map(e.getSenders(),function(t){return t.track}):[];if(0===(n=t.filter(n,function(e){return!t.isNullOrUndefined(e)})).length){var i=e.getLocalStreams?e.getLocalStreams():[];return t.reduce(i,function(t,e){return t.concat(e.getTracks())},[])}return n}(e),i=function(e){var n=e.getReceivers?t.map(e.getReceivers(),function(t){return t.track}):[];if(0===(n=t.filter(n,function(e){return!t.isNullOrUndefined(e)})).length){var i=e.getRemoteStreams?e.getRemoteStreams():[];return t.reduce(i,function(t,e){return t.concat(e.getTracks())},[])}return n}(e);if(0!==n.length&&0!==i.length)throw this.ot.error("Invalid State. PeerConnection contains [%s] local and [%s] remote tracks.",n.length,i.length),new Error("Invalid State. PeerConnection contains both local and remote streams.");return 0!==n.length?n:0!==i.length?i:[]}function a(e){var n=o.call(this,this.At),i=t.filter(n,function(t){return t.kind===e}),r=t.filter(this.Ft,function(t){return t.kind===e});return t.reduce(i,function(e,n){if(!e)return e;var i=!!t.find(r,function(t){return t.id===n.id});return!n.enabled||i},!0)}return s.prototype.start=function(s,u,c){if(e.st(s,"options"),e.rt(u,"activeCallback"),e.rt(c,"monitorCallback"),"inbound"!==s.direction&&"outbound"!==s.direction)throw new Error("Invalid monitoring direction");if(this.jt=s.frameRateThreshold||2,this.Ut=s.videoBitRateThreshold||6e3,this.Lt=s.audioBitRateThreshold||5e3,this._t=s.conditionCountForNotificationThreshold||3,this.Bt=s.monitoringInterval||4e3,this.Wt=s.monitoringInterval||1500,this.Vt=!s.hasOwnProperty("monitorFrameRate")||s.monitorFrameRate,this.zt=!s.hasOwnProperty("monitorBitRate")||s.monitorBitRate,this.Gt=!s.hasOwnProperty("monitorState")||s.monitorState,this.Ft=[],"Edge"===n.browser){var h=this.Wt*this._t;this.Bt=Math.max(this.Bt,6e3),this.Wt=Math.max(this.Wt,6e3),this._t=Math.max(Math.ceil(h/this.Bt),2),this.ot.info("Using modified options for optimal monitoring of PeerConnection on [Edge]. Monitor Interval [%s], Condition Monitor Interval [%s], Condition Count For Notification [%s]",this.Bt,this.Wt,this._t)}return function(e,s,u,c,h){var f=this,d=0,l=void 0,p=void 0,m=void 0,v=null;setTimeout(function g(y){(function(e,i,s,o,a,u){if(!o())return this.ot.info("[%s] Finished monitoring of peer connection",this.qt);var c=this;n.getStats(e,null,function(e){var n=r.convertPeerConnectionStats(e,c.Nt);n=t.filter(n,function(t){return"inbound"===i.direction&&"download"===t.direction||"outbound"===i.direction&&"upload"===t.direction}),a(n)},function(t){u(t)})}).call(f,s,u,null,c,function(r){var w=!1,b=!1,k=!1;if(!c())return f.ot.info("[%s] Finished monitoring of peer connection",e);if(!r)throw new Error("Report must be a valid PeerConnection.getStats Report");if(t.forEach(r,function(t){var i="";if("outbound"===u.direction&&"upload"===t.direction)switch(t.mediaType){case"video":t.avgEncode&&(i+=" with average encoding time ["+t.avgEncode+"] ms"),t.cpuLimitedResolution&&(i+=" (CPU limited=["+t.cpuLimitedResolution+"])"),f.ot.debug("[%s] [%s] [%s] [%s] with bitrate [%s], droppedFrames [%s] and frame rate [%s] and RTT [%s]"+i,e,u.direction,t.mediaType,t.ssrc,t.bitrateMean,t.droppedFrames,t.framerateMean,t.rtt),l=t.framerateMean,p=t.uploadRate?1e3*t.uploadRate:t.uploadRate,w=!0,b=!0,"Edge"===n.browser&&(w=!1);break;case"audio":f.ot.debug("[%s] [%s] [%s] [%s] and RTT [%s] and jitter [%s] and audio input level [%s]",e,u.direction,t.mediaType,t.ssrc,t.rtt,t.jitter,t.audioInputLevel),k=!0,m=t.uploadRate?1e3*t.uploadRate:t.uploadRate}if("inbound"===u.direction&&"download"===t.direction)switch(t.mediaType){case"video":t.currentDelay&&(i+=" with current delay ["+t.currentDelay+"] ms"),t.targetDelay&&(i+=" and target delay ["+t.targetDelay+"] ms"),f.ot.debug("[%s] [%s] [%s] [%s] with framerate [%s]"+i,e,u.direction,t.mediaType,t.ssrc,t.framerateMean),w=!0,l=t.framerateMean||0,b=!0,p=t.downloadRate?1e3*t.downloadRate:t.downloadRate,"Edge"===n.browser&&(w=!1);break;case"audio":t.jitterBuffer&&(i+=" with jitter buffer ["+t.jitterBuffer+"] ms"),f.ot.debug("[%s] [%s] [%s] [%s] with jitter [%s]  with output level [%s]"+i,e,u.direction,t.mediaType,t.ssrc,t.jitter,t.audioOutputLevel),k=!0,m=t.downloadRate?1e3*t.downloadRate:t.downloadRate}}),t.isUndefined(m)&&t.isUndefined(p))return setTimeout(g,f.Bt);var S=i.hasActiveAudio(s),I=i.hasActiveVideo(s);if((b&&0===p||k&&0===m||w&&0===l)&&(b=b&&I,k=k&&S,w=w&&I),(k||b||w)&&f.ot.debug("[%s] [%s] Current bit rate is [%s] bps for audio and [%s] bps for video with [%s] FPS",e,u.direction,Math.ceil(m||0),Math.ceil(p||0),l||"?"),!f.Gt||"closed"!==s.connectionState&&"failed"!==s.connectionState&&"failed"!==s.iceConnectionState)f.Vt&&w&&l<=f.jt&&!a.call(f,"video")?d++:f.zt&&k&&m<=f.Lt&&!a.call(f,"audio")?d++:f.zt&&b&&p<=f.Ut&&!a.call(f,"video")?d++:d=0;else{var E=S&&I,T=o.call(f,s);if(!E&&i.hasMediaSectionsInLocalSdp(s))return void f.ot.info("[%s] [%s] Finished monitoring of peer connection with [%s] inactive tracks",e,u.direction,T.length);d++}var R=!(0!==p&&b||0!==m&&k||function(){var e=this;return t.reduce(o.call(this,this.At),function(n,i){if(!n)return n;var r=!!t.find(e.Ft,function(t){return t.id===i.id});return!i.enabled||r},!0)}.call(f));R&&!v?v=setTimeout(t.bind(g,this,!0),5e3):R||(clearTimeout(v),v=null);var C=y&&R&&v,x=function(){f.ot.info("[%s] [%s] Failure has been acknowledged",e,u.direction),d=Number.MIN_VALUE,setTimeout(g,f.Bt)};if(d>=f._t||C){var O="["+e+"] ["+u.direction+"] Failure detected with frame rate ["+l+"] FPS, audio bit rate ["+m+"] bps, video bit rate ["+p+"] bps, connection state ["+s.connectionState+"], and ice connection state ["+s.iceConnectionState+"]",P="["+e+"] ["+u.direction+"] Failure detected with 0 bps audio and video for [5] seconds",M=C?P:O;h(null,{type:"condition",message:M,report:r,frameRate:l,videoBitRate:p,audioBitRate:m,acknowledgeFailure:x})?x():f.ot.error(M+": [%s]",r)}else setTimeout(g,d>0?f.Wt:f.Bt)},function(t){h(t,{type:"error",message:"Unable to get Connection statistics. Connection may have failed."})})},f.Bt)}.call(this,this.qt,this.At,s,u,c)},s.prototype.setMonitorTrackState=function(n,i){e.st(n,"track"),e.Jt(i,"state");var r=o.call(this,this.At);if(!t.find(r,function(t){return t.id===n.id}))return this.ot.warn("[%s] Unable to find track [%s] [%s] in peer connection",this.qt,n.kind,n.id);if(!i)return this.ot.info("[%s] Pausing monitoring of track [%s] [%s]",this.qt,n.kind,n.id),this.Ft.push(n);var s=this.Ft.length;this.Ft=t.filter(this.Ft,function(t){return t.id!==n.id}),s!==this.Ft.length&&this.ot.info("[%s] Starting monitoring of track [%s] [%s] after it was paused",this.qt,n.kind,n.id)},s.prototype.toString=function(){return"PeerConnectionMonitor["+this.qt+"]"},s}.apply(e,i))||(t.exports=r)},function(t,e,n){var i;void 0===(i=function(){"use strict";return{package:"telemetry",messages:[{name:"LogData",fields:[{rule:"required",type:"LogLevel",name:"level",id:1},{rule:"required",type:"string",name:"timestamp",id:2},{rule:"required",type:"string",name:"category",id:3},{rule:"required",type:"string",name:"message",id:4},{rule:"optional",type:"string",name:"source",id:5},{rule:"optional",type:"string",name:"fullQualifiedName",id:11},{rule:"optional",type:"string",name:"sessionId",id:6},{rule:"optional",type:"string",name:"userId",id:7},{rule:"optional",type:"string",name:"environment",id:8},{rule:"optional",type:"string",name:"version",id:9},{rule:"optional",type:"float",name:"runtime",id:10}]},{name:"StoreLogRecords",fields:[{rule:"repeated",type:"LogData",name:"records",id:1}]},{name:"StoreLogRecordsResponse",fields:[{rule:"required",type:"string",name:"status",id:1},{rule:"required",type:"uint64",name:"storedRecords",id:2}]},{name:"MetricValue",fields:[{rule:"optional",type:"string",name:"string",id:1},{rule:"optional",type:"float",name:"float",id:2},{rule:"optional",type:"uint64",name:"uint64",id:3},{rule:"optional",type:"int64",name:"int64",id:4},{rule:"optional",type:"bool",name:"boolean",id:5},{rule:"optional",type:"string",name:"timestamp",id:6}]},{name:"MetricData",fields:[{rule:"required",type:"string",name:"timestamp",id:1},{rule:"optional",type:"string",name:"sessionId",id:2},{rule:"optional",type:"string",name:"streamId",id:3},{rule:"optional",type:"string",name:"source",id:4},{rule:"optional",type:"string",name:"resource",id:5},{rule:"optional",type:"string",name:"kind",id:6},{rule:"required",type:"Metric",name:"metric",id:7},{rule:"optional",type:"MetricValue",name:"value",id:8},{rule:"optional",type:"MetricValue",name:"previousValue",id:9},{rule:"optional",type:"uint64",name:"elapsed",id:10},{rule:"optional",type:"string",name:"fullQualifiedName",id:11},{rule:"optional",type:"string",name:"environment",id:12},{rule:"optional",type:"string",name:"version",id:13},{rule:"optional",type:"string",name:"tool",id:14},{rule:"optional",type:"string",name:"toolVersion",id:15},{rule:"required",type:"float",name:"runtime",id:16}]},{name:"SubmitMetricRecords",fields:[{rule:"repeated",type:"MetricData",name:"records",id:1}]},{name:"SubmitMetricRecordsResponse",fields:[{rule:"required",type:"string",name:"status",id:1},{rule:"required",type:"uint64",name:"storedRecords",id:2}]}],enums:[{name:"LogLevel",values:[{name:"Trace",id:0},{name:"Debug",id:1},{name:"Info",id:2},{name:"Warn",id:3},{name:"Error",id:4},{name:"Fatal",id:5}]},{name:"Metric",values:[{name:"RoundTripTime",id:0},{name:"DownlinkThroughputCapacity",id:26},{name:"Initialized",id:1},{name:"Provisioned",id:2},{name:"SetupCompleted",id:3},{name:"Offset",id:4},{name:"TimeToFirstFrame",id:5},{name:"Playing",id:6},{name:"Stalled",id:7},{name:"Buffering",id:8},{name:"Seeking",id:22},{name:"Stopped",id:9},{name:"BitRateAdaptation",id:10},{name:"ResolutionChanged",id:11},{name:"DisplayResolutionChanged",id:23},{name:"VideoBitRate",id:28},{name:"AudioBitRate",id:29},{name:"FrameRateChanged",id:12},{name:"FramesDropped",id:13},{name:"PacketsLost",id:14},{name:"PictureLost",id:15},{name:"PlayoutDelayChanged",id:16},{name:"CodecChanged",id:17},{name:"PlayerEvent",id:21},{name:"MetricDropped",id:18},{name:"NetworkOffline",id:19},{name:"NetworkOnline",id:20},{name:"NetworkType",id:27},{name:"ApplicationForeground",id:24},{name:"ApplicationBackground",id:25}]}]}}.apply(e,[]))||(t.exports=i)},function(t,e,n){var i,r;i=[n(0),n(65),n(63),n(62)],void 0===(r=function(t,e,n,i){"use strict";function r(e,r){var s=this;this.Ht={},this.Ht[i.package]=new n(i),t.forEach(e,function(t){s.Ht[t.package]=new n(t)}),this.Kt=r||3}return r.prototype.getApiVersion=function(){return this.Kt},r.prototype.encode=function(n,i){if("string"!=typeof n)throw new Error("'type' must be a string");if("object"!=typeof i)throw new Error("'data' must be an object");var r=n.split("."),s=t.get(r,[0]),o=t.get(r,[1]),a=t.get(this.Ht,[s]),u=new e;return a.write(o,i,u),u.finish()},r.prototype.decode=function(n,i){if("string"!=typeof n)throw new Error("'type' must be a string");var r=n.split("."),s=t.get(r,[0]),o=t.get(r,[1]),a=t.get(this.Ht,[s]),u=new e(i);return a.read(o,u)},r}.apply(e,i))||(t.exports=r)},function(t,e,n){var i,r;i=[n(0),n(1),n(4),n(3),n(22),n(61)],void 0===(r=function(t,e,n,i,r,s){"use strict";var o="continuation",a=2e3,u=3e5,c=18e3;function h(i,s,o,a,u){e.st(i,"logger"),e.rt(s,"sendCallback"),e.rt(o,"receiveCallback"),this.ot=i,this.Qt=new r(a,u),this.Xt=0,this.Pt=new n.NamedEvents,this.Zt={},this.$t={},this.Yt={},this.te={},this.ee={},this.ne={},this.ie=o,this.re=s,o(t.bind(f,this))}function f(e){if(this.se)return this.ot.warn("Proto already disposed of. Unable process message");var n,i,r;try{n=this.Qt.decode("mq.Message",s.toByteArray(e.data)),r=this.Zt[n.requestId],this.ot.info(">> [%s] [%s]",n.messageType,n.type),i=this.Qt.decode(n.type,n.payload)}catch(t){if(this.ot.error(t),r)return r(t);throw t}switch(function(e,n,i){var r=t.now(),s=this.ee[e.requestId];if(t.Dt(s)){var o=r-s;e.wallTime=[o].concat(e.wallTime)}this.Pt.fireAsync("received",[{key:e.requestId,messageType:e.messageType,type:e.type,wallTime:e.wallTime,received:r,bytes:i,payload:n}]),delete this.ee[e.requestId]}.call(this,n,i,e.data.length),n.messageType){case"Response":if(i.status!==o&&delete this.Zt[n.requestId],clearTimeout(this.te[n.requestId]),delete this.te[n.requestId],!r)return;return"mq.Error"===n.type?r(i,null):r(null,i);case"Request":var a=t.bind(this.sendResponse,this,n.requestId,n.type+"Response"),u=this.Yt[n.type];this.$t[n.requestId]=t.now(),u?u(i,a):this.ot.info("Received request without a subscribed listener");break;case"Event":return function(t,e){this.Pt.fire(t,e,this)}.call(this,n.type,[i]);default:return this.ot.warn(">> Unsupported message type [%s]",n.messageType)}}function d(e,n,i,r,s,c,h){return h&&h.status===o?(!this.ne[e]&&this.Zt[e]&&(this.ne[e]=function(e,n){return setTimeout(t.bind(m,this,e,u,n),u)}.call(this,e,s)),function(e,n,i,r,s,o){if(!r||!r.continuationId&&!r.routeKey)return this.ot.warn("Received request for continuation without a continuationId or routeKey"),o();var u=t.assign({},i,{continuationId:r.continuationId,routeKey:r.routeKey}),c={requestId:e,type:n,payload:this.Qt.encode(n,u),messageType:"Request"},h=this;return setTimeout(function(){if(h.Zt[e])return l.call(h,e,c,u,s,o)},a)}.call(this,e,n,i,h,r,s)):(clearTimeout(this.ne[e]),delete this.ne[e],s(c,h))}function l(e,n,i,r,s){this.te[e]&&clearTimeout(this.te[e]);var o=r||c;return this.te[e]=setTimeout(t.bind(m,this,e,o,s),o),p.call(this,n,i)}function p(e,n){var i=s.toString(this.Qt.encode("mq.Message",e));return function(e,n,i){var r=t.now();this.ee[e.requestId]=r,this.Pt.fireAsync("sent",[{key:e.requestId,messageType:e.messageType,type:e.type,received:r,bytes:i,payload:n}])}.call(this,e,n,i.length),this.re(i)}function m(t,e,n){if(this.Zt[t])return function(t,e){this.Pt.fireAsync("timeout",[{key:t,timeout:e}]),delete this.ee[t]}.call(this,t,e),this.ot.warn("Request [%s] has not completed in [%s] ms. Dropping request.",t,e),delete this.Zt[t],n(null,{status:"timeout"})}return h.prototype.onEvent=function(t,n){return this.se?this.ot.warn("Proto already disposed of. Unable to listen for event"):(e.wt(t,"eventName"),e.rt(n,"handler"),this.Pt.listen(t,n))},h.prototype.onRequest=function(t,n){if(this.se)return this.ot.warn("Proto already disposed of. Unable to listen for request");e.wt(t,"requestName"),e.rt(n,"handler"),this.Yt[t]&&this.ot.warn("May not set multiple handlers for the same request. Overriding existing handlers for request [%s]",t),this.Yt[t]=n;var r=this;return new i.Disposable(function(){r.Yt[t]=null})},h.prototype.sendRequest=function(n,i,r,s){if(this.se)return this.ot.warn("Proto already disposed of. Unable to send request"),r(null,{status:"proto-disposed"});s=s||{},e.wt(n,"type"),e.st(i,"message"),e.st(s,"settings"),r&&e.rt(r,"callback"),s.timeout&&e.Dt(s.timeout,"settings.timeout");var o="C"+(this.Xt++).toString(),a={requestId:o,type:n,payload:this.Qt.encode(n,i),messageType:"Request"};return this.Zt[o]=t.bind(d,this,o,n,i,s.timeout,r),l.call(this,o,a,i,s.timeout,r)},h.prototype.sendResponse=function(n,i,r,s){if(this.se)return this.ot.warn("Proto already disposed of. Unable to send response"),s(null,{status:"proto-disposed"});e.wt(n,"requestId"),e.wt(i,"type"),e.st(r,"message");var o=this.$t[n];o||(this.ot.error("Already responded to request [%s]",n),s(new Error("no-response-handler")));var a={requestId:n,type:i,payload:this.Qt.encode(i,r),messageType:"Response",wallTime:[t.now()-o]};return p.call(this,a,r),delete this.$t[n],s(null,{status:"ok"})},h.prototype.disposeOfRequests=function(){t.forOwn(this.te,function(t){clearTimeout(t)}),t.forOwn(this.ne,function(t){clearTimeout(t)}),this.Zt={},this.$t={},this.Yt={},this.te={},this.ee={},this.ne={}},h.prototype.dispose=function(){this.se=!0,this.ie=null,this.re=null,this.disposeOfRequests(),this.Pt.dispose()},h.prototype.getApiVersion=function(){return this.Qt.getApiVersion()},h.prototype.toString=function(){return"Proto["+this.oe.toString()+"]"},h}.apply(e,i))||(t.exports=r)},function(t,e,n){var i,r;i=[n(66)],void 0===(r=function(t){"use strict";return t}.apply(e,i))||(t.exports=r)},function(t,e,n){var i,r;i=[n(0),n(1),n(7),n(3),n(72),n(6),n(14),n(53),n(52),n(49),n(46),n(45),n(20),n(8),n(44),n(42),n(41),n(12),n(37),n(18),n(33),n(31),n(5),n(2),n(19)],void 0===(r=function(t,e,n,i,r,s,o,a,u,c,h,f,d,l,p,m,v,g,y,w,b,k,S,I,E){"use strict";var T="2018-09-17T15:08:57Z";function R(s){s=s||{},e.st(s,"options"),s.streamingSourceMapping&&(e.st(s.streamingSourceMapping,"options.streamingSourceMapping"),e.wt(s.streamingSourceMapping.replacement,"options.streamingSourceMapping.replacement"),s.streamingSourceMapping.patternToReplace instanceof RegExp||e.wt(s.streamingSourceMapping.patternToReplace,"options.streamingSourceMapping.patternToReplace")),t.isNullOrUndefined(s.disableMultiplePCastInstanceWarning)||e.Jt(s.disableMultiplePCastInstanceWarning,"options.disableMultiplePCastInstanceWarning"),t.isNullOrUndefined(s.disableGlobalErrorListener)||e.Jt(s.disableGlobalErrorListener,"options.disableGlobalErrorListener"),t.isNullOrUndefined(s.disableBeforeUnload)||e.Jt(s.disableBeforeUnload,"options.disableBeforeUnload"),t.isNullOrUndefined(s.disableConsoleLogging)||e.Jt(s.disableConsoleLogging,"options.disableConsoleLogging"),this.ae=new n.Observable("offline"),this.ue=s.uri||c.DefaultPCastUri,this.ce=s.deviceId||"",this.tt=T,this.ot=s.logger||r.createPCastLogger(this.ue,s.disableConsoleLogging),this.he=s.metricsTransmitter||p.createMetricsTransmitter(this.ue),this.fe=new h(s,this.ot),this.Ct=s.shaka,this.de=s.videojs||I.global.videojs,this.le=s.rtmp||{},this.pe=s.streamingSourceMapping,this.v=new i.DisposableList,this.me=s.disableMultiplePCastInstanceWarning,this.ve=!0,this.ge=[],this.ye=[],this.we=new k(s.features);var o=this,a=t.filter(this.we.getFeatures(),k.isFeatureSupported),u=function(t){o.ot.error("Window Error Event Triggered with pcast in [%s] state",o.ae.getValue(),t?t.error:"Unknown Error")};this.ot.info("Device supports features [%s], user selected [%s]",a,this.we.getFeatures()),t.addEventListener(I.global,"unload",function(){return o.ot.info("Window Unload Event Triggered"),o.stop("window-unload")}),s.disableGlobalErrorListener||(t.addEventListener(I.global,"error",u),I.global.__phenixGlobalErrorListenerDisposable&&I.global.__phenixGlobalErrorListenerDisposable.dispose(),I.global.__phenixGlobalErrorListenerDisposable=new i.Disposable(function(){t.removeEventListener(I.global,"unload",u)})),s.disableBeforeUnload||t.addEventListener(I.global,"beforeunload",function(){return o.ot.info("Window Before Unload Event Triggered"),o.stop("window-beforeunload")}),I.webrtcSupported||"ReactNative"!==I.browser||I.shim(),I.webrtcSupported&&(function(){var t=this,e=new I.RTCPeerConnection;"Safari"===I.browser&&I.browserVersion>10&&(e.addTransceiver("audio"),e.addTransceiver("video"));try{var n=function(n){var i=E.getH264ProfileIds(n.sdp);if(t.ye=E.getSupportedCodecs(n.sdp),t.ot.info("Supported WebRTC video codecs [%s]",t.ye),0===i.length)return t.ot.info("Unable to find local h264 profile level id",n.sdp);t.ot.info("Found local h264 profile level ids [%s]",i,n.sdp),t.ge=i,e.close&&e.close()},i=function(n){t.ot.error("Unable to create offer to get local h264 profile level id",n),e.close&&e.close()},r={offerToReceiveAudio:!0,offerToReceiveVideo:!0};if("function"==typeof I.global.Promise)return e.createOffer(r).then(n).catch(i);e.createOffer(n,i,r)}catch(n){t.ot.error("Failed to set environment defaults. Creating the Offer failed",n),e.close&&e.close()}}.call(this),L.call(this))}function C(){if(M.call(this)&&"offline"===this.ae.getValue())return this.ot.warn("[PCast] connected after being offline. Going offline."),K.call(this,"critical-network-issue"),this.stop("critical-network-issue");var t=this;this.be=!0,t.ke||t.Se.authenticate(t.Ie,function(e,n){t.Ee&&(e?(t.ot.error("Failed to authenticate [%s]",e),K.call(t,"unauthorized"),t.Ee.call(t,t,"unauthorized","")):"ok"!==n.status?(t.ot.warn("Failed to authenticate, status [%s]",n.status),K.call(t,"unauthorized"),t.Ee.call(t,t,"unauthorized","")):(K.call(t,"online"),t.Ee.call(t,t,n.status,n.sessionId)))})}function x(){K.call(this,"reconnecting")}function O(){K.call(this,"reconnected"),this.ot.info("Attempting to re-authenticate after reconnect event"),function(){var t=this;t.ke||t.Se.authenticate(t.Ie,function(e,n){var i=!0===t.be;if(e)return t.ot.error("Unable to authenticate after reconnect to WebSocket [%s]",e),K.call(t,"reconnect-failed");if("ok"!==n.status){t.ot.warn("Unable to authenticate after reconnect to WebSocket, status [%s]",n.status);var r="capacity"===n.status?n.status:"reconnect-failed";return K.call(t,r)}return t.be=!0,t.ot.info("Successfully authenticated after reconnect to WebSocket"),K.call(t,"online",null,i)})}.call(this)}function P(){if(M.call(this)&&"reconnecting"===this.ae.getValue())return this.ot.warn("[PCast] disconnected after attempting to reconnect. Going offline."),K.call(this,"critical-network-issue"),this.stop("critical-network-issue");this.be=!1,K.call(this,"offline")}function M(){return t.reduce(this.Te,function(t,e){return t?"closed"===e.iceConnectionState:t},!0)}function D(t){switch(t){case"":case"none":case"ended":return"ended";case"server-error":case"session-error":case"not-ready":case"error":case"died":return"failed";case"censored":return"censored";case"maintenance":return"maintenance";case"capacity":return"capacity";case"app-background":return"app-background";case"egress-failed":return"egress-failed";case"egress-setup-failed":return"egress-setup-failed";default:return"custom"}}function q(t){var e=t.streamId,n=t.reason;return N.call(this,e,n)}function A(e){var n=e.streamId,i=e.status,r=e.reason,s=this.Re[n];s&&s.dataQualityChangedCallback(i,r);var o=this.Ce[n];o&&t.rt(o.dataQualityChangedCallback)&&o.dataQualityChangedCallback(o,i,r)}function N(e,n){this.ot.info("[%s] Stream ended with reason [%s]",e,n);var i=this.Re[e];i&&i.streamEndedCallback(D(n),n,!0),delete this.Re[e];var r=this.Ce[e];r&&t.rt(r.publisherEndedCallback)&&r.publisherEndedCallback(r,D(n),n),delete this.Ce[e];var s=this.Te[e];s&&Q.call(this,e,s,"ended"),delete this.Te[e]}function F(e,n,i,r,s,o){var a,u=this,c=!1,h=function(h){if(!n.failed&&!c){var f=E.getNumberOfActiveSections(i),d=h.stream||t.get(h,["streams",0]),l="real-time";if(!d)return n.failed=!0,u.ot.warn("[%s] No remote stream",e),s.call(u,void 0,"failed");if(a&&clearTimeout(a),f===d.getTracks().length){c=!0,u.ot.info("[%s] Got remote stream",e),r.setProperty("kind",l);var p=t.assign({networkLag:u.xe},o),m=new b(e,d,i,r,p,u.ot),v=new y(l,m,u.ot);v.on(S.streamEvents.playerError.name,function(t,e){u.ot.warn("Phenix Real-Time Stream Error [%s] [%s]",t,e),v.streamErrorCallback(l,e)}),v.on(S.streamEvents.stopped.name,function(t){!n.stopped&&u.Se&&(u.ot.info("[%s] media stream has stopped with reason",e,t),Q.call(u,e,i,"stop"),u.Se.destroyStream(e,t||"",function(t,n){t?u.ot.error("[%s] failed to destroy stream [%s]",e,t):"ok"===n.status?u.ot.info("[%s] destroyed stream",e):u.ot.warn("[%s] failed to destroy stream, status [%s]",e,n.status)}),n.stopped=!0)}),u.Re[e]=v,s.call(u,m)}else a=setTimeout(function(){return n.failed=!0,u.ot.warn("[%s] Did not receive all tracks within [%s] ms",e,3e3),s.call(u,void 0,"failed")},3e3)}};t.addEventListener(i,"addstream",h),t.addEventListener(i,"track",h)}function j(e,n,i){var r=this;t.addEventListener(n,"icecandidate",function(t){var n=t.candidate;n?r.ot.info("[%s] ICE candidate: [%s] [%s] [%s]",e,n.sdpMid,n.sdpMLineIndex,n.candidate):r.ot.info("[%s] ICE candidate discovery complete",e),i&&i(n)})}function U(e,n){var i=this;t.addEventListener(n,"negotiationneeded",function(t){i.ot.info("[%s] Negotiation needed")}),t.addEventListener(n,"iceconnectionstatechange",function(t){i.ot.info("[%s] ICE connection state changed [%s]",e,n.iceConnectionState)}),t.addEventListener(n,"icegatheringstatechange ",function(t){i.ot.info("[%s] ICE gathering state changed [%s]",e,n.iceGatheringState)}),t.addEventListener(n,"signalingstatechange",function(t){i.ot.info("[%s] Signaling state changed [%s]",e,n.signalingState)}),t.addEventListener(n,"connectionstatechange",function(t){i.ot.info("[%s] Connection state changed [%s]",e,n.connectionState)})}function L(e){var n=this;switch(I.browser){case"Edge":return I.getDestinations(function(i){0===t.filter(i,function(t){return"audio"===t.kind}).length?(n.ve&&n.ot.info("Detected no audio devices attached to machine"),n.ve=!1):n.ve=!0,e&&e()});default:e&&e()}}function _(e,n,i,r,s,o){if("IE"===I.browser)throw new Error("Subscribing in real-time not supported on IE without the PhenixP2P Plugin");var a=this,u={failed:!1,stopped:!1},c=i.match(/a=crypto:/i),h=i.match(/m=application /i),f=new I.RTCPeerConnection(e,{optional:[{DtlsSrtpKeyAgreement:!c},{RtpDataChannels:h}]});if(nt(f),a.Te[n]=f,"Firefox"===I.browser||"Edge"===I.browser){if(i.match(/(\nm=video)/g)&&i.match(/(\nm=audio)/g)){var d=/(a=candidate)((.|\n)*)(?=m=)/g;i=i.replace(d,i.match(d)+"a=end-of-candidates\n")}i=(i+="a=end-of-candidates").replace(/(\na=ice-options:trickle)/g,"")}"ReactNative"===I.browser&&(i=et(i));var l=function(t){u.failed||(u.failed=!0,u.stopped=!0,delete a.Te[n],delete a.Re[n],delete a.Oe[n],Q.call(a,n,f,"failure"),s.call(a,void 0,t||"failed"))};F.call(a,n,u,f,r,s,o),j.call(a,n,f,function(t){a.Oe[n]&&a.Oe[n](t)}),U.call(a,n,f);var p=new I.RTCSessionDescription({type:"offer",sdp:i}),m={mandatory:{}};if("Chrome"===I.browser||"ReactNative"===I.browser?(m.mandatory.OfferToReceiveVideo=!1!==o.receiveVideo,m.mandatory.OfferToReceiveAudio=!1!==o.receiveAudio):(m.mandatory.offerToReceiveVideo=!1!==o.receiveVideo,m.mandatory.offerToReceiveAudio=!1!==o.receiveAudio),"function"==typeof I.global.Promise)return f.setRemoteDescription(p).then(t.bind(W,a)).then(function(){return f.createAnswer(m)}).then(t.bind(V,a)).then(function(t){return new I.global.Promise(function(e,i){z.call(a,n,t,e,i)})}).then(function(t){return f.setLocalDescription(t)}).then(t.bind(B,a)).catch(l);f.setRemoteDescription(p,function(){W.call(a),f.createAnswer(function(e){V.call(a,e),z.call(a,n,e,function(e){f.setLocalDescription(e,t.bind(B,a),l)},l)},l,m)},l)}function B(){this.ot.debug("Set local description (answer)")}function W(){this.ot.debug("Set remote description (offer)")}function V(t){return this.ot.info("Created answer [%s]",t.sdp),t}function z(e,n,i,r){var s=this;s.Se.setAnswerDescription(e,n.sdp,function(n,o){if(n)return s.ot.error("Failed to set answer description [%s]",n),r();if("ok"!==o.status)return s.ot.warn("Failed to set answer description, status [%s]",o.status),r(o.status);o&&t.includes(o.options,"ice-candidates")&&(s.Oe=t.bind(G,s,e));var a=o.sessionDescription.sdp;if(tt()){var u=t.get(function(){var e=t.get(I,["global","navigator","userAgent"],"");if(/iP(hone|od|ad)/.test(e)){var n=e.match(/.*OS (\d+)_(\d+)_?(\d+)? like Mac OS X/);return{major:parseInt(t.get(n,[1],0),10),minor:parseInt(t.get(n,[2],0),10),patch:parseInt(t.get(n,[3],0),10)}}}(),["major"]);s.ot.info("iOS Version is [%s]",u),u<11&&(a=a.replace("BUNDLE audio video","BUNDLE video audio"))}var c=new I.RTCSessionDescription({type:"answer",sdp:a});i(c)})}function G(e,n){var i=this,r=[];n?[].push(n):r.push("completed"),i.Se.addIceCandidates(e,n,r,function(n,r){return n?i.ot.error("Failed to add ICE candidate [%s]",n):"ok"!==r.status?i.ot.warn("Failed to add ICE candidate, status [%s]",r.status):void(t.includes(r.options,"cancel")&&delete i.Oe[e])})}function J(n,i,r,s,a){var u=/a=x-rtmp:(rtmp:\/\/[^\n]*)/m,c=i.match(u),h=i.match(/a=x-playlist:([^\n]*[.]mpd\??[^\s]*)/m),f=i.match(/a=x-playlist:([^\n]*[.]m3u8\??[^\s]*)/m),d=t.get(h,[1],""),l=t.get(f,[1],""),p=h&&2===h.length,m=f&&2===f.length,v=!!c,g=[];(p||m)&&g.push("streaming"),v&&g.push("rtmp");var y=this.we.getPreferredFeatureFromPublisherCapabilities(g,!0);switch(this.pe&&(d=d.replace(this.pe.patternToReplace,this.pe.replacement),l=l.replace(this.pe.patternToReplace,this.pe.replacement)),y){case S.types.rtmp.name:var w=[],b=o.parseEnvFromPcastBaseUri(this.ue);for(this.ot.info("Selecting flash playback for rtmp.");c;){var I=t.get(c,[1],""),E=t.get(I.match(/(rtmp:\/\/[^\n\s]*)/),[0]),T=t.get(I.match(/bitrate=([^\n\s;]*)/),[1]),R=t.get(I.match(/resolution=([^\n\s;]*)/),[1]);i=i.replace(I,""),E&&w.push({uri:E,bitrate:T,resolution:R}),c=i.match(u)}return H.call(this,n,w,S.types.rtmp.name,r,s,t.assign({env:b},this.le,a));case S.types.dash.name:return this.ot.info("Selecting dash playback for live stream."),a.isDrmProtectedContent=/[?&]drmToken=([^&]*)/.test(d)||/x-widevine-service-certificate/.test(i),a.isDrmProtectedContent&&(a.widevineServiceCertificateUrl=i.match(/a=x-widevine-service-certificate:([^\n][^\s]*)/m)[1],a.playreadyLicenseUrl=i.match(/a=x-playready-license-url:([^\n][^\s]*)/m)[1]),this.Ct&&!this.Ct.Player.isBrowserSupported()?(this.ot.warn("[%s] Shaka does not support this browser",n),s.call(this,void 0,"browser-unsupported")):H.call(this,n,d,S.types.dash.name,r,s,a);case S.types.hls.name:return this.ot.info("Selecting hls playback for live stream."),a.isDrmProtectedContent=/[?&]drmToken=([^&]*)/.test(l),a.hlsTargetDuration&&(e.Dt(a.hlsTargetDuration,"options.hlsTargetDuration"),l=l+(l.indexOf("?")>-1?"&":"?")+"targetDuration="+a.hlsTargetDuration),H.call(this,n,l,S.types.hls.name,r,s,t.assign({preferNative:k.shouldUseNativeHls},a))}return this.ot.warn("[%s] Device does not support [%s] playback. Creating live viewer stream failed.",n,k.mapPCastCapabilitiesToFeatures(g)),s.call(this,void 0,"failed")}function H(t,e,n,i,r,s){var o=this,a=new w(n,t,e,i,s,this.Ct,this.ot),u=new y(n,a,this.ot);i.setProperty("kind",n),u.on(S.streamEvents.playerError.name,function(t,e){o.ot.warn("Phenix Live Stream Player Error [%s] [%s]",t,e),u.streamErrorCallback(t,e)}),u.on(S.streamEvents.stopped.name,function(e){if(!o.Se)return o.ot.warn("Unable to destroy stream [%s]",t);o.Se.destroyStream(t,e||"",function(e,n){e?o.ot.error("[%s] failed to destroy stream, [%s]",t,e):"ok"===n.status||o.ot.warn("[%s] failed to destroy stream, status [%s]",t,n.status)})}),this.Re[t]=u,r.call(this,u.getPhenixMediaStream())}function K(t,e,n){var i,r=this.getStatus();if(r!==t&&("critical-network-issue"!==(i=r)&&"offline"!==i||"offline"!==t)){if(this.ae.setValue(t),n)return;switch(t){case"connecting":case"reconnecting":case"reconnected":break;case"critical-network-issue":case"unauthorized":case"reconnect-failed":case"offline":return this.Pe.call(this);case"online":return this.Me.call(this)}}}function Q(t,e,n){"closed"===e.signalingState||e.__closing||(this.ot.debug("[%s] close peer connection [%s]",t,n),e.close(),e.__closing=!0)}function X(e){if(!e)return e;var n=t.isArray(e)?[]:{},i=t.bind(Z,null,n);return t.isArray(e)?t.forEach(e,i):t.forOwn(e,i),n}function Z(e,n,i){if(null!==n){if(t.st(n)||t.isArray(n))return e[i]=X(n);if(!t.lt(n)||!t.lt(i))return e[i]=n;var r=t.startsWith(n.toLowerCase(),i.toLowerCase())?n.substring(i.length,n.length).toLowerCase():n;e[i]=r}}function $(e){return"Firefox"===I.browser&&function(e){if(!e)return e;t.forEach(e.iceServers,function(e){e.urls=t.filter(e.urls,function(e){return!t.startsWith(e,"turns")})})}(e),e}R.prototype.getBaseUri=function(){return this.ue},R.prototype.getStatus=function(){return this.ae.getValue()},R.prototype.getObservableStatus=function(){return this.ae},R.prototype.isStarted=function(){return this.De},R.prototype.reAuthenticate=function(t){if(e.wt(t,"authToken"),"online"===this.ae.getValue())return this.ot.warn("Already authenticated. Denying request to re-authenticate");this.ot.info("Attempting to re-authenticate with new auth token [%s]",t),this.Ie=t,O.call(this)},R.prototype.start=function(n,i,r,s){if(e.wt(n,"authToken"),e.rt(i,"authenticationCallback"),e.rt(r,"onlineCallback"),e.rt(s,"offlineCallback"),this.De)throw new Error('"Already started"');t.Dt(I.global.__phenixInstantiatedPCastCount)?I.global.__phenixInstantiatedPCastCount++:I.global.__phenixInstantiatedPCastCount=1,I.global.__phenixInstantiatedPCastCount>1&&!this.me&&this.ot.warn("Avoid using multiple instances of PCast as this uses unnecessary resources and will reduce performance. This is your [%s] simultaneous instance. Remember to dispose all resources when done with them by calling .stop() or .dispose()",I.global.__phenixInstantiatedPCastCount),this.ke=!1,this.De=!0,this.Ie=n,this.Ee=i,this.Me=r,this.Pe=s,this.qe=new v(this.ot,this.he),this.Ae=new c(this.tt,this.ue,this.ot,this.qe),K.call(this,"connecting"),this.Te={},this.Re={},this.Oe={},this.Ce={},this.Ne=[],this.v.add(this.Ae),this.v.add(this.qe);var o=this;o.Ae.resolveUri(function(e,n){if(e){switch(o.ot.error("Failed to connect to [%s]",o.ue,e),K.call(o,"offline"),e.code){case 0:o.Ee.call(o,o,"network-unavailable","");break;case 503:o.Ee.call(o,o,"capacity","");break;default:o.Ee.call(o,o,"failed","")}return o.ke=!0,void(o.De=!1)}o.ot.info("Discovered end point [%s] with RTT [%s]",n.uri,n.roundTripTime),o.xe=n.roundTripTime/2,o.Fe=n.uri,function(e){this.Se=new u(e,this.ce,this.tt,this.ot),this.Se.onEvent("connected",t.bind(C,this)),this.Se.onEvent("reconnecting",t.bind(x,this)),this.Se.onEvent("reconnected",t.bind(O,this)),this.Se.onEvent("disconnected",t.bind(P,this)),this.Se.onEvent("pcast.StreamEnded",t.bind(q,this)),this.Se.onEvent("pcast.StreamDataQuality",t.bind(A,this)),this.ot.setObservableSessionId&&this.ot.setObservableSessionId(this.Se.getObservableSessionId()),this.je&&(this.je.dispose(),this.qe.setSessionId(null)),this.je=this.Se.getObservableSessionId().subscribe(t.bind(this.qe.setSessionId,this.qe))}.call(o,n.uri)})},R.prototype.stop=function(n){if(n=n||"",e.lt(n,"reason"),this.De){this.ot.info("Stopping pcast instance with reason [%s]",n),this.ke=!0,this.De=!1,delete this.Ee;try{var i=this;t.forOwn(this.Re,function(t,e){N.call(i,e,n)}),t.forOwn(this.Ce,function(e,r){N.call(i,r,n),t.includes(e.getOptions(),"detached")||e.stop(n,!0)}),t.forOwn(this.Te,function(t,e){N.call(i,e,n)}),t.forEach(this.Ne,function(e){var n=e.getTracks();t.forEach(n,function(t){t.stop()})})}finally{this.Se&&(this.Se.disconnect(),this.Se=null),this.ot.setObservableSessionId&&this.ot.setObservableSessionId(null),this.je&&(this.je.dispose(),this.qe.setSessionId(null)),I.global.__phenixInstantiatedPCastCount--,this.v.dispose()}}},R.prototype.getUserMedia=function(t,n,i){if("IE"===I.browser)throw new Error("Publishing not supported on IE");return e.st(t,"options"),e.rt(n,"callback"),i&&e.rt(i,"onScreenShare"),new f(this.ot,this.fe,i).getUserMedia(t,n)},R.prototype.publish=function(n,i,r,s,o){if("IE"===I.browser)throw new Error("Publishing not supported on IE");if(!this.De)throw new Error("PCast not started. Unable to publish. Please start pcast first.");if(s=s||[],o=o||{},e.wt(n,"streamToken"),e.rt(r,"callback"),e.isArray(s,"tags"),e.st(o,"options"),!t.st(i)&&!t.lt(i))throw new Error('"streamToPublish" must be an object or URI');var a=this,u=t.assign({},o,{negotiate:!0});t.lt(i)?(u.negotiate=!1,u.connectUri=i):u.connectUri=o.connectUri,s.length>0&&(u.tags=s);var c=new m(this.getProtocol().getSessionId(),this.ot,this.he);c.setProperty("resource","upload"),this.Se.setupStream("upload",n,u,2*a.xe,function(n,s){if(n)return a.ot.error("Failed to create uploader [%s]",n),r.call(a,a,"failed");if("ok"===s.status){var h=s.createStreamResponse.streamId;if(c.setStreamId(h),c.setStartOffset(s.createStreamResponse.offset),c.recordMetric("Provisioned"),c.recordMetric("RoundTripTime",{uint64:2*a.xe},null,{resource:a.Fe,kind:"https"}),!0===u.negotiate){var f=s.createStreamResponse.createOfferDescriptionResponse.sessionDescription.sdp,l=$(X(s.createStreamResponse.rtcConfiguration));if("Opera"===I.browser&&a.ge.length>0){var p=t.get(E.getH264ProfileIds(f),[0]),m=E.getH264ProfileIdWithSameProfileAndEqualToOrHigherLevel(a.ge,p);m?p!==m&&(a.ot.info("[%s] Replacing publisher h264 profile level id [%s] with new value [%s] in offer sdp",h,p,m),f=E.replaceH264ProfileId(f,p,m)):a.ot.warn("[%s] Unable to find new publisher h264 profile level id to replace [%s]. Rejected environment defaults of [%s]",h,p,a.ge)}return function(n,i,r,s,o,a,u,c){var h=this,f={failed:!1,stopped:!1},l=s.match(/a=crypto:/i),p=s.match(/m=application /i),m=new I.RTCPeerConnection(n,{optional:[{DtlsSrtpKeyAgreement:!l},{RtpDataChannels:p}]}),v=null,y=null;if(nt(m),h.Te[r]=m,m.addStream(i),"Firefox"===I.browser||"Edge"===I.browser){if(s.match(/(\nm=video)/g)&&s.match(/(\nm=audio)/g)){var w=/(a=candidate)((.|\n)*)(?=m=)/g;s=s.replace(w,s.match(w)+"a=end-of-candidates\n")}s=(s+="a=end-of-candidates").replace(/(\na=ice-options:trickle)/g,"")}var b=function(t){f.failed||(f.failed=!0,f.stopped=!0,delete h.Te[r],delete h.Ce[r],delete h.Oe[r],Q.call(h,r,m,"failure"),a.call(h,void 0,t||"failed"))},k=function(){var n=/(b=AS:([0-9]*)[\n\r]*)/gi,o=/(mid:video)([\n\r]*)/gi,u=0,l=n.exec(s);l&&l.length>=3&&(u=1e3*l[2]);var p={getStreamId:function(){return r},getStream:function(){return i},isActive:function(){return!f.stopped},hasEnded:function(){switch(m.iceConnectionState){case"new":case"checking":case"connected":case"completed":return!1;case"disconnected":case"failed":case"closed":default:return!0}},stop:function(t){!f.stopped&&h.Se&&(h.ot.info("[%s] stopping publisher with reason [%s]",r,t||"client-action"),Q.call(h,r,m,"closed"),h.Se.destroyStream(r,t||"",function(t,e){t?h.ot.error("[%s] failed to destroy stream [%s]",r,t):"ok"===e.status?h.ot.info("[%s] destroyed stream",r):h.ot.warn("[%s] failed to destroy stream, status [%s]",r,e.status)}),f.stopped=!0)},setPublisherEndedCallback:function(t){e.rt(t,"callback"),this.publisherEndedCallback=t},setDataQualityChangedCallback:function(t){e.rt(t,"callback"),this.dataQualityChangedCallback=t},limitBandwidth:function(t){if("Edge"===I.browser)return h.ot.warn("Limit bandwidth not support on [%s]",I.browser);e.Dt(t,"bandwidthLimit");var i=u?Math.min(t,u):t,r=m.remoteDescription;h.ot.info("Changing bandwidth limit to [%s]",i);var s=r.sdp.replace(n,"");s=s.replace(o,function(t,e,n,r,s){return[e,n,"b=AS:",Math.ceil(i/1e3),n].join("")});var a=new I.RTCSessionDescription({type:r.type,sdp:s});return m.setRemoteDescription(a),{dispose:function(){m.setRemoteDescription(r)}}},getMonitor:function(){return y},monitor:function(n,s){e.st(n,"options"),e.rt(s,"callback");var o=new d(r,m,h.ot);return n.direction="outbound",o.start(n,function(){return h.Ce[r]===p&&!f.stopped},function(t,e){return t&&h.ot.warn("[%s] Publisher monitor triggered unrecoverable error [%s]",t),h.ot.warn("[%s] Publisher triggered monitor condition for [%s]",r,e.type),s(p,"client-side-failure",e)}),t.forEach(i.getTracks(),function(e){t.addEventListener(e,"readystatechange",function(){if("ended"===e.readyState)return h.ot.warn("[%s] Publisher track has failed [%s]",r,e),s(p,"camera-track-failure",{type:e.kind+"-track-ended",message:"Publisher "+e.kind+" track has ended in an unrecoverable way. This may require reconfiguring your camera or microphone."})})}),y=o,o},setRemoteMediaStreamCallback:function(t){e.rt(t,"callback"),this.remoteMediaStreamCallback=t,v&&t(p,v)},getOptions:function(){return c},getStats:function(t){e.rt(t,"callback"),this.Nt||(this.Nt={});var n=this;return I.getStats(m,null,function(e){t(g.convertPeerConnectionStats(e,n.Nt))})}};h.Ce[r]=p,a.call(h,p)};F.call(h,r,f,m,o,function(t){var e=h.Ce[r];v=t,e&&e.remoteMediaStreamCallback&&e.remoteMediaStreamCallback(e,t)},u),j.call(h,r,m,function(t){h.Oe[r]&&h.Oe[r](t)}),U.call(h,r,m);var S=new I.RTCSessionDescription({type:"offer",sdp:s}),E={mandatory:{}};if("Chrome"===I.browser||"ReactNative"===I.browser?(E.mandatory.OfferToReceiveVideo=!0===u.receiveVideo,E.mandatory.OfferToReceiveAudio=!0===u.receiveAudio):(E.mandatory.offerToReceiveVideo=!0===u.receiveVideo,E.mandatory.offerToReceiveAudio=!0===u.receiveAudio),"function"==typeof I.global.Promise)return m.setRemoteDescription(S).then(t.bind(W,h)).then(function(){return m.createAnswer(E)}).then(t.bind(V,h)).then(function(t){return new I.global.Promise(function(e,n){z.call(h,r,t,e,n)})}).then(function(t){return m.setLocalDescription(t)}).then(t.bind(B,h)).then(k).catch(b);h.ot.info("[%s] Using legacy callback api",r),m.setRemoteDescription(S,function(){W.call(h),m.createAnswer(function(t){V.call(h,t),z.call(h,r,t,function(t){m.setLocalDescription(t,function(){B.call(h),k()},b)},b)},b,E)},b)}.call(a,l,i,h,f,c,function(t,e){c.recordMetric("SetupCompleted",{string:e?"failed":"ok"}),e?r.call(a,a,"failed",null):r.call(a,a,"ok",t)},o,s.createStreamResponse.options)}return function(t,n,i){var r=this,s={stopped:!1},o={getStreamId:function(){return t},getStream:function(){return r.ot.debug("[%s] Unable to get stream on publisher of remote origin.",t),null},getStats:function(){return r.ot.debug("[%s] Unable to get stream stats on publisher of remote origin.",t),null},isActive:function(){return!s.stopped},hasEnded:function(){return s.stopped},stop:function(e){s.stopped||(r.ot.info("[%s] stopping publisher with reason [%s]",t,e),r.Se.destroyStream(t,e||"",function(e,n){e?r.ot.error("[%s] failed to destroy stream [%s]",t,e):"ok"===n.status?r.ot.info("[%s] destroyed stream",t):r.ot.warn("[%s] failed to destroy stream, status [%s]",t,n.status)}),s.stopped=!0)},setPublisherEndedCallback:function(t){e.rt(t,"callback"),this.publisherEndedCallback=t},setDataQualityChangedCallback:function(t){e.rt(t,"callback"),this.dataQualityChangedCallback=t},getOptions:function(){return i},monitor:function(t,n){e.st(t,"options"),e.rt(n,"callback")},getMonitor:function(){return null}};r.Ce[t]=o,n(o)}.call(a,h,function(t,e){c.recordMetric("SetupCompleted",{string:e?"failed":"ok"}),e?r.call(a,a,"failed",null):r.call(a,a,"ok",t)},s.createStreamResponse.options)}switch(a.ot.warn("Failed to create uploader, status [%s]",s.status),s.status){case"timeout":case"capacity":case"unauthorized":return r.call(a,a,s.status);default:return r.call(a,a,"failed")}})},R.prototype.subscribe=function(n,i,r){if(!this.De)throw new Error("PCast not started. Unable to subscribe. Please start pcast first.");r=r||{},e.wt(n,"streamToken"),e.rt(i,"callback"),e.st(r,"options");var s=this;L.call(s,function(){var e=t.assign({},r,{negotiate:!1!==r.negotiate}),o=new m(s.getProtocol().getSessionId(),s.ot,s.he),a=t.assign({},r);a.canPlaybackAudio=s.ve,!s.ve&&r.disableAudioIfNoOutputFound&&!1!==r.receiveAudio&&(e.receiveAudio=!1,a.receiveAudio=!1,a.forcedAudioDisabled=!0),o.setProperty("resource","download"),s.Se.setupStream("download",n,e,2*s.xe,function(e,n){if(e)return s.ot.error("Failed to create downloader [%s]",e),i.call(s,s,"failed");if("ok"===n.status){var r=n.createStreamResponse.streamId,u=n.createStreamResponse.createOfferDescriptionResponse.sessionDescription.sdp,c=$(X(n.createStreamResponse.rtcConfiguration)),h=t.bind(_,s,c),f=u.match(/a=x-playlist:/)||u.match(/a=x-rtmp:/);if(f&&(h=J),o.setStreamId(r),o.setStartOffset(n.createStreamResponse.offset),o.recordMetric("Provisioned"),o.recordMetric("RoundTripTime",{uint64:2*s.xe},null,{resource:s.getBaseUri(),kind:"https"}),a.originStartTime=t.now()-n.createStreamResponse.offset+s.xe,!f&&("Chrome"===I.browser&&I.browserVersion>=62&&Y()||"Opera"===I.browser)&&s.ge.length>0){var d=t.get(E.getH264ProfileIds(u),[0]),l=E.getH264ProfileIdWithSameOrHigherProfileAndEqualToOrHigherLevel(s.ge,d);l?d!==l&&(s.ot.info("[%s] Replacing subscriber h264 profile level id [%s] with new value [%s] in offer sdp",r,d,l),u=E.replaceH264ProfileId(u,d,l)):s.ot.warn("[%s] Unable to find new subscriber h264 profile level id to replace [%s]. Rejected environment defaults of [%s]",r,d,s.ge)}return h.call(s,r,u,o,function(t,e){o.recordMetric("SetupCompleted",{string:e?"failed":"ok"}),e?i.call(s,s,"failed",null):i.call(s,s,"ok",t)},a)}switch(s.ot.warn("Failed to create downloader, status [%s]",n.status),n.status){case"capacity":case"stream-ended":case"origin-stream-ended":case"streaming-not-available":case"unauthorized":case"timeout":return i.call(s,s,n.status);default:return i.call(s,s,"failed")}})})},R.prototype.getProtocol=function(){return this.Se},R.prototype.getLogger=function(){return this.ot},R.prototype.toString=function(){var t=this.getProtocol();return"PCast["+(t?t.getSessionId():"")||"unauthenticated,"+(t?t.toString():"uninitialized")+"]"};var Y=function(){var e=t.get(I,["global","navigator","userAgent"],"");return tt()||/Android|webOS|BlackBerry|IEMobile|Opera Mini|Mobile|mobile|CriOS/i.test(e)},tt=function(){var e=t.get(I,["global","navigator","userAgent"],"");return/iPad|iPhone|iPod/.test(e)&&!I.global.MSStream},et=function(e){var n=e.match(/(?=a=group:BUNDLE).*/),i=t.get(t.get(n,[0],"").split("a=group:BUNDLE "),[1],""),r=i.split(" ").sort(function(t,n){return e.indexOf("m="+t)>e.indexOf("m="+n)});return r.length>0&&(e=e.replace(i,r.join(" "))),e},nt=function(e){if(t.isUndefined(e.onaddstream)){var n=[],i=[];t.addEventListener(e,"track",function(e){t.forEach(e.streams,function(e){t.includes(n,e)||n.push(e)})}),e.getRemoteStreams=function(){return n},e.getLocalStreams=function(){return i},e.addStream=function(n){t.includes(i,n)||i.push(n),t.forEach(n.getTracks(),function(t){e.addTrack(t,n)})}}};return R}.apply(e,i))||(t.exports=r)},function(t,e,n){var i,r;i=[n(0),n(1),n(3)],void 0===(r=function(t,e,n){"use strict";function i(){this.Ue=[]}function r(n,i,r){var s=this;t.isNullOrUndefined(n)&&(n=[]),e.isArray(n,"args");var o=function(){t.forEach(s.Ue,function(t){t.apply(i,n)})};r?setTimeout(function(){o(),r()},0):o()}return i.prototype.fire=function(t,e){r.call(this,t,e)},i.prototype.fireAsync=function(t,e,n){r.call(this,t,e,n||function(){})},i.prototype.listen=function(i){var r=this;return e.rt(i,"listener"),r.Ue.push(i),new n.Disposable(function(){r.Ue=t.remove(r.Ue,function(t){return t===i})})},i.prototype.size=function(){return this.Ue.length},i.prototype.dispose=function(){this.Ue=[]},i.prototype.toString=function(){return"Event|"+this.size()},i}.apply(e,i))||(t.exports=r)},function(t,e,n){var i,r;i=[n(0),n(1),n(3)],void 0===(r=function(t,e,n){"use strict";function i(t,e){this.latestValue=null,this.subscribeCallbacks={},this.subscriptionTimeout=100,this.subscriptionCount=0,this.resetOnChange=!1,this.lastChangeTime=0,this.isPendingChanges=!1,this.beforeChange=e,s.call(this,t)}function r(e){return void 0===e||null===e?e:t.isArray(e)?e.slice():e}function s(t){var e=t;this.beforeChange&&(e=this.beforeChange(t)),this.latestValue=r(e)}function o(e,n){if(this.lastChangeTime=t.now(),!this.isPendingChanges&&0!==this.subscriptionCount){if(this.isPendingChanges=!0,n)return a.call(this);(function e(n){var i=this;setTimeout(function(){var n=t.now()-i.lastChangeTime;i.resetOnChange&&n<i.subscriptionTimeout?e.call(i,i.subscriptionTimeout-n):a.call(i)},n)}).call(this,e)}}function a(){try{(function(){var e=this;t.forOwn(e.subscribeCallbacks,function(n){t.rt(n)&&n(e.latestValue)})}).call(this)}finally{this.isPendingChanges=!1}}return i.prototype.getValue=function(){return r(this.latestValue)},i.prototype.setValue=function(t){t!==this.latestValue&&(s.call(this,t),o.call(this,this.subscriptionTimeout))},i.prototype.subscribe=function(i,r){e.rt(i,"callback"),r&&e.st(r,"options");var s,a=this,u=t.uniqueId();return a.subscribeCallbacks[u]=i,a.subscriptionCount+=1,r&&("notify"===r.initial&&o.call(a,a.subscriptionTimeout,!0),r.listenForChanges&&(s=setInterval(function(){var t=r.listenForChanges.callback();t!==a.latestValue&&a.setValue(t)},r.listenForChanges.timeout))),new n.Disposable(function(){delete a.subscribeCallbacks[u],s&&(clearInterval(s),s=null),a.subscriptionCount-=1})},i.prototype.extend=function(n){switch(e.st(n,"options"),n.method){case"notifyWhenChangesStop":this.subscriptionTimeout=n.timeout,this.resetOnChange=!0;break;case"notifyAtFixedRate":this.subscriptionTimeout=n.timeout}return t.Dt(n.rateLimit)&&(this.subscriptionTimeout=n.rateLimit),this},i}.apply(e,i))||(t.exports=r)},function(t,e,n){var i;void 0===(i=function(){"use strict";return{errorSeverity:{recoverable:{id:1,name:"RECOVERABLE"},critical:{id:2,name:"CRITICAL"}}}}.apply(e,[]))||(t.exports=i)},function(t,e,n){var i,r;i=[n(0),n(1),n(7),n(11),n(16),n(17),n(25),n(2),n(28)],void 0===(r=function(t,e,n,i,r,s,o,a,u){"use strict";var c="unauthorized",h=1e3,f=2e4,d={maxOfflineTime:18e4,maxReconnectFrequency:6e4};function l(i){if(e.st(i,"options"),i.authToken&&e.wt(i.authToken,"options.authToken"),i.onError&&e.rt(i.onError,"options.onError"),!t.isNullOrUndefined(i.onlineTimeout)&&(e.Dt(i.onlineTimeout,"options.onlineTimeout"),i.onlineTimeout<0))throw new Error('"options.onlineTimeout" must be a positive number');i.reconnectOptions&&(e.st(i.reconnectOptions,"options.reconnectOptions"),e.Dt(i.reconnectOptions.maxOfflineTime,"options.reconnectOptions.maxOfflineTime"),e.Dt(i.reconnectOptions.maxReconnectFrequency,"options.reconnectOptions.maxReconnectFrequency")),i.adminApiProxyClient&&(e.st(i.adminApiProxyClient,"options.adminApiProxyClient"),e.rt(i.adminApiProxyClient.createAuthenticationToken,"options.adminApiProxyClient.createAuthenticationToken")),this.Le=new n.Observable(null).extend({rateLimit:0}),this._e={},this.Ce={},this.Be=i.adminApiProxyClient||new r,this.We=!1,this.Ve=0,this.ze=0,this.Ie=i.authToken,this.Ge=i.onError,this.h=i,this.Je=t.Dt(i.onlineTimeout)?i.onlineTimeout:f,this.He=i.reconnectOptions||d,this.ot=null,this.Ke={},i.adminApiProxyClient||(this.Be.setBackendUri(i.backendUri),this.Be.setAuthenticationData(i.authenticationData)),m.call(this),i.adminApiProxyClient||(i.backendUri&&this.ot.warn("Passing options.backendUri is deprecated. Please create an instance of the sdk.net.AdminApiProxyClient and pass that instead"),i.authenticationData&&this.ot.warn("Passing options.authenticationData is deprecated. Please create an instance of the sdk.net.AdminApiProxyClient and pass that instead"))}l.prototype.dispose=function(){this.Qe&&(this.Qe.dispose(),this.Qe=null),this.Le.getValue()&&(this.Le.getValue().stop(),this.Le.setValue(null)),t.Dt(this.Xe)&&(clearTimeout(this.Xe),this.Xe=null),this.Be.dispose(),this.ze=0,this.Ve=0,this.ot.info("Disposed PCast Express Instance")},l.prototype.getPCast=function(){return this.Le.getValue()},l.prototype.getPCastObservable=function(){return this.Le},l.prototype.getAdminAPI=function(){return this.Be},l.prototype.getUserMedia=function(t,n){var i=this;if(e.st(t.mediaConstraints,"options.mediaConstraints"),e.rt(n,"callback"),t.resolution&&e.Dt(t.resolution,"options.resolution"),t.frameRate&&e.Dt(t.frameRate,"options.frameRate"),t.aspectRatio&&e.wt(t.aspectRatio,"options.aspectRatio"),t.onResolveMedia&&e.rt(t.onResolveMedia,"options.onResolveMedia"),t.onScreenShare&&e.rt(t.onScreenShare,"options.onScreenShare"),i.Le.getValue())return b.call(i,i.Le.getValue(),t,n);var r=i.Le.subscribe(function(e){e&&(r.dispose(),b.call(i,e,t,n))})},l.prototype.publish=function(t,n){e.st(t,"options"),e.rt(n,"callback"),t.capabilities&&e.isArray(t.capabilities,"options.capabilities"),t.connectOptions&&e.isArray(t.connectOptions,"options.connectOptions"),t.mediaConstraints?e.st(t.mediaConstraints,"options.mediaConstraints"):e.st(t.userMediaStream,"options.userMediaStream"),t.videoElement&&e.st(t.videoElement,"options.videoElement"),t.monitor&&(e.st(t.monitor,"options.monitor"),e.rt(t.monitor.callback,"options.monitor.callback"),t.monitor.options&&e.st(t.monitor.options,"options.monitor.options")),t.streamToken&&e.wt(t.streamToken,"options.streamToken");var i=this;this.waitForOnline(function(e){return e?n(e):t.userMediaStream?k.call(i,t.userMediaStream,t,!1,n):void i.getUserMedia(t,function(e,r){return e?n(e):"ok"!==r.status?n(null,r):void k.call(i,r.userMedia,t,!0,n)})},t.isContinuation)};var p=["streaming","low-latency","on-demand","uld","vvld","vld","ld","sd","hd","fhd","uhd"];function m(){var e=this;if(!this.Le.getValue()){var n=t.assign({logger:this.ot},this.h);this.Le.setValue(new o(n))}if(this.ot||(this.ot=this.Le.getValue().getLogger()),this.Ze||(this.Ze=this.Le.getValue().getObservableStatus().subscribe(t.bind(v,this))),this.Ie)return this.Le.getValue().start(this.Ie,t.noop,t.noop,t.noop);this.Be.createAuthenticationToken(function(n,i){return n&&"timeout"===n.message?v.call(e,n.message):n?w.call(e,n):"ok"!==i.status?v.call(e,i.status):e.Le.getValue()?void e.Le.getValue().start(i.authenticationToken,t.noop,t.noop,t.noop):e.ot.warn("Unable to authenticate. PCast not instantiated.")})}function v(t){switch(t){case"timeout":case"critical-network-issue":return this.Le.getValue()&&(this.Le.getValue().stop("recovery"),this.Le.setValue(null)),this.Ze&&(this.Ze.dispose(),this.Ze=null),this.ze++,g.call(this);case"reconnect-failed":case"unauthorized":return delete this.Ie,this.Ve++,this.Ve>1?w.call(this,new Error(t)):(this.ot.info("[Express] Attempting to create new authToken and re-connect after [%s] response",c),y.call(this));case"capacity":case"network-unavailable":return this.ze++,g.call(this);case"online":return this.Ve=0,this.ze=0,this.We||this.ot.info("Express API successfully instantiated"),void(this.We=!0);case"reconnecting":case"reconnected":case"connecting":break;case"offline":return;case"failed":default:return w.call(this,new Error(t))}}function g(){var t=this,e=Math.min(h*t.ze*t.ze,this.He.maxReconnectFrequency),n=Math.min(e/1e4,5),i=e+Math.random()*n*1e3;this.ot.info("Waiting for [%s] ms before continuing to attempt to reconnect to PCast",i),this.Xe=setTimeout(function(){return t.Le.getValue()&&t.Le.getValue().isStarted()?y.call(t):m.call(t)},i)}function y(){var t=this;this.Be.createAuthenticationToken(function(e,n){return e&&"timeout"===e.message?v.call(t,e.message):e?w.call(t,e):"ok"!==n.status?v.call(t,n.status):t.Le.getValue()?void t.Le.getValue().reAuthenticate(n.authenticationToken):t.ot.warn("Unable to authenticate. PCast not instantiated.")})}function w(t){if(!this.Ge)throw t;this.Ge(t)}function b(n,i,r){new s(n,{aspectRatio:i.aspectRatio,resolutionHeight:i.resolution,frameRate:i.frameRate,resolutionSelectionStrategy:i.resolutionSelectionStrategy,onScreenShare:function(n){return(n=i.onScreenShare?i.onScreenShare(n):n).resolution&&e.Dt(n.resolution,"clientOptions.resolution"),n.frameRate&&e.Dt(n.frameRate,"screenOptions.frameRate"),n.aspectRatio&&e.wt(n.aspectRatio,"screenOptions.aspectRatio"),t.assign({resolutionHeight:n.resolution},n)}}).getUserMedia(i.mediaConstraints,function(e,n){if(e)return r(e);i.onResolveMedia&&i.onResolveMedia(n.options),r(null,t.assign({status:"ok"},n))})}function k(n,i,r,s){var o=this;if(e.isArray(i.capabilities,"options.capabilities"),i.streamToken)return S.call(o,i.streamToken,n,i,r,s);o.waitForOnline(function(e){if(e)return o.ot.error("Failed to create stream token for publishing after waiting for online status",e),s(e);var a=o.Le.getValue().getProtocol().getSessionId(),u=t.includes(i.capabilities,"egress"),c=t.bind(o.Be.createStreamTokenForPublishing,o.Be,a,i.capabilities);u&&(c=t.bind(o.Be.createStreamTokenForPublishingToExternal,o.Be,a,i.capabilities,i.streamId)),o.ot.info("[%s] Creating stream token for publishing",a),c(function(t,e){return t?(o.ot.error("[%s] Failed to create stream token for publishing",a,t),s(t)):"ok"!==e.status?(o.ot.warn("[%s] Failed to create stream token for publishing with status [%s]",a,e.status),s(null,e)):void S.call(o,e.streamToken,n,i,r,s)})},i.isContinuation)}function S(n,i,r,s,o){var u=this,h=!1,f=null;r.tags&&e.isArray(r.tags,"options.tags"),r.connectOptions&&e.isArray(r.connectOptions,"options.connectOptions");var d=function(e,d,l){var p=function(e){var a=t.uniqueId(),c=t.assign({streamToken:n,isContinuation:!0},r);u.Ce[a]=!0,u.ot.warn("Retrying publisher after failure with reason [%s]",e),u.Ke[l.getStreamId()]=!0,"camera-track-failure"===e?(l.stop(e,!1),u.publish(r,o)):(l.stop(e,!0),k.call(u,i,c,s,o)),delete u.Ce[a]};if(d===c&&(r.streamToken||!r.authFailure)||"timeout"===d){u.ot.info("[Express] Attempting to create new streamToken and re-publish after [%s] response",c);var m=t.assign({isContinuation:!0,authFailure:!0},r);return delete m.streamToken,k.call(u,i,m,s,o)}if("ok"!==d)return u.ot.warn("Failure to publish with status [%s]",d),f&&(u.Ke[f.getStreamId()]=!0),o(null,{status:d});delete r.authFailure,u.Ce[l.getStreamId()]=l,f=l,r.videoElement&&!h&&(a.attachMediaStream(r.videoElement,i),h=!0);var v=t.bind(x,u,function(){},p,!0);if(r.monitor){var g=t.bind(C,u,r.monitor.callback,p);l.monitor(r.monitor.options||{},g),v=t.bind(x,u,r.monitor.callback,p,!0)}l.setPublisherEndedCallback(v);var y=function(e,n,i){var r=t.bind(e.stop,e);return e.stop=function(t,s){if(r(t),n&&(n.src="",n.srcObject=null),i&&e.getStream()&&!s){var o=e.getStream();o&&o.getTracks().forEach(function(t){t.stop()})}},e.enableAudio=function(){return E(e.getStream(),!0)},e.disableAudio=function(){return E(e.getStream(),!1)},e.enableVideo=function(){return T(e.getStream(),!0)},e.disableVideo=function(){return T(e.getStream(),!1)},e.setPublisherEndedCallback=function(){},e}.call(u,l,r.videoElement,s);o(null,{status:"ok",publisher:y})};u.waitForOnline(function(t){if(t)return o(t);u.Le.getValue().publish(n,i,d,r.tags,{connectOptions:r.connectOptions})},r.isContinuation)}function I(e,n,r){var s=this,o=null,a=function(a,h,f){var d,l=function(i){var o=t.uniqueId(),a=t.assign({isContinuation:!0},n);s._e[o]=!0,s.Ke[f.getStreamId()]=!0,f.stop(i),s.ot.warn("[%s] Stream failure occurred with reason [%s]. Attempting to recover from failure.",n.streamId,i),I.call(s,e,a,r),delete s._e[o]};if(h===c&&(n.streamToken||!n.authFailure)||"timeout"===h){s.ot.info("[%s] [Express] Attempting to create new streamToken and re-subscribe after [%s] response",n.streamId,c);var p=t.assign({isContinuation:!0,authFailure:!0},n);return delete p.streamToken,s.subscribe(p,r)}if("streaming-not-ready"===h)return s.ot.warn("Failure to subscribe with status [%s]. Try again in a few seconds.",h),r(null,{status:h,retry:t.bind(l,s,h)});if("ok"!==h)return s.ot.warn("Failure to subscribe with status [%s]",h),o&&(s.Ke[o.getStreamId()]=!0),r(null,{status:h});delete n.authFailure,s._e[f.getStreamId()]=f,o=f,n.videoElement&&(d=f.createRenderer()).start(n.videoElement);var m=t.noop,v=t.bind(x,s,m,l,!1);if(n.monitor){var g=t.bind(C,s,n.monitor.callback,l);f.monitor(n.monitor.options||{},g),v=t.bind(x,s,n.monitor.callback,l,!1)}f.setStreamEndedCallback(v);var y=function(e,n){var i=t.bind(e.stop,e);return e.stop=function(t){n&&n.stop(t),i(t)},e.enableAudio=function(){return E(e.getStream(),!0)},e.disableAudio=function(){return E(e.getStream(),!1)},e.enableVideo=function(){return T(e.getStream(),!0)},e.disableVideo=function(){return T(e.getStream(),!1)},e.setStreamEndedCallback=function(){},e}.call(s,f,d),w={status:"ok",mediaStream:y};f.setStreamErrorCallback(function(e,o,a){if("real-time"===o&&"connection-timeout"===a.message)return l.call(s,a.message);if("shaka"!==o||a.severity===u.errorSeverity.critical.id){if("phenix-player"===o&&a.severity===i.errors.severity.RECOVERABLE){s.ot.warn("[%s] Recoverable error occurred while playing stream with Express API. Attempting to subscribe again.",y.getStreamId(),a);var c=t.assign({isContinuation:!0},n);return delete c.streamToken,s.subscribe(c,r)}return s.ot.warn("[%s] Error occurred while playing stream with Express API. Stopping stream.",y.getStreamId(),a),y.stop(),r(a)}}),d&&(w.renderer=d),r(null,w)};s.waitForOnline(function(t){if(t)return r(t);s.Le.getValue().subscribe(e,a,n.subscriberOptions)},n.isContinuation)}function E(t,e){if(t)return R(t.getAudioTracks(),e),e}function T(t,e){if(t)return R(t.getVideoTracks(),e),e}function R(n,i){e.isArray(n,"tracks"),t.forEach(n,function(t){t.enabled=i})}function C(e,n,i,r,s){switch(r){case"camera-track-failure":case"client-side-failure":e(null,t.assign({status:r,retry:t.bind(n,null,r)},s))}}function x(t,e,n,i,r,s){var o={status:"stream-ended",reason:r,description:s};if(this.Ke[i.getStreamId()])return this.ot.info("Ignoring stream end due to recovery in progress [%s]",i.getStreamId());switch(r){case"egress-setup-failed":case"ended":case"censored":var a={status:r,reason:r,description:s};return n?a.publisher=i:a.mediaStream=i,t(null,a);case"custom":return t(null,o);case"egress-failed":case"capacity":return setTimeout(function(){return e(r)},h);case"failed":case"maintenance":return e(r);case"app-background":default:return o.retry=e,t(null,o)}}return l.prototype.publishRemote=function(n,i){if(e.st(n,"options"),e.rt(i,"callback"),e.wt(n.streamUri,"options.streamUri"),n.capabilities&&e.isArray(n.capabilities,"options.capabilities"),n.connectOptions&&e.isArray(n.connectOptions,"options.connectOptions"),n.mediaConstraints)throw new Error("Invalid argument: mediaConstraints, passed on publishRemote. Local media not allowed when publishing remote content.");if(n.videoElement)throw new Error("May not view remote stream publisher. Please subscribe to view.");n.prerollSkipDuration&&e.Dt(n.prerollSkipDuration,"options.prerollSkipDuration"),n.monitor&&(e.st(n.monitor,"options.monitor"),e.rt(n.monitor.callback,"options.monitor.callback"),n.monitor.options&&e.st(n.monitor.options,"options.monitor.options")),n.frameRate&&(e.st(n.frameRate,"options.frameRate"),n.frameRate.exact&&e.Dt(n.frameRate.exact,"options.frameRate.exact"),n.frameRate.max&&e.Dt(n.frameRate.max,"options.frameRate.max")),n.streamToken&&e.wt(n.streamToken,"options.streamToken");var r=this;this.waitForOnline(function(e){if(e)return i(e);var s=t.assign({connectOptions:[],capabilities:[]},n);t.includes(s.capabilities,"publish-uri")||s.capabilities.push("publish-uri"),t.forEach(p,function(e){t.includes(s.capabilities,e)&&s.connectOptions.push("publisher-capability="+e)}),n.frameRate&&n.frameRate.exact&&s.connectOptions.push("source-uri-video-fps="+n.frameRate.exact),n.frameRate&&n.frameRate.max&&s.connectOptions.push("source-uri-video-fps-max="+n.frameRate.max),s.connectOptions.push("source-uri-preroll-skip-duration="+(t.Dt(n.prerollSkipDuration)?n.prerollSkipDuration:500).toString()),k.call(r,s.streamUri,s,!1,i)})},l.prototype.publishStreamToExternal=function(n,i){if(e.st(n,"options"),e.rt(i,"callback"),e.wt(n.streamId,"options.streamId"),e.wt(n.externalUri,"options.externalUri"),n.capabilities&&e.isArray(n.capabilities,"options.capabilities"),n.connectOptions&&e.isArray(n.connectOptions,"options.connectOptions"),n.mediaConstraints)throw new Error("Invalid argument: mediaConstraints, passed on publishStreamToExternal. Local media not allowed when publishing remote content.");if(n.videoElement)throw new Error("May not view remote stream publisher. Please subscribe to view.");n.monitor&&(e.st(n.monitor,"options.monitor"),e.rt(n.monitor.callback,"options.monitor.callback"),n.monitor.options&&e.st(n.monitor.options,"options.monitor.options")),n.streamToken&&e.wt(n.streamToken,"options.streamToken");var r=this;this.waitForOnline(function(e){if(e)return i(e);var s=t.assign({connectOptions:[],capabilities:[]},n);t.includes(s.capabilities,"egress")||s.capabilities.push("egress"),t.includes(s.capabilities,"egress-own-stream")||s.capabilities.push("egress-own-stream"),k.call(r,s.externalUri,s,!1,i)})},l.prototype.publishScreen=function(e,n){var i=t.assign({mediaConstraints:{screen:!0}},e);return t.set(i,["monitor","options"],t.assign({},{monitorFrameRate:!1,videoBitRateThreshold:100,conditionCountForNotificationThreshold:8},t.get(i,["monitor","options"],{}))),this.publish(i,n)},l.prototype.subscribe=function(t,n){e.st(t,"options"),e.rt(n,"callback"),e.wt(t.streamId,"options.streamId"),e.st(t.capabilities,"options.capabilities"),t.videoElement&&e.st(t.videoElement,"options.videoElement"),t.monitor&&(e.st(t.monitor,"options.monitor"),e.rt(t.monitor.callback,"options.monitor.callback"),t.monitor.options&&e.st(t.monitor.options,"options.monitor.options")),t.streamToken&&e.wt(t.streamToken,"options.streamToken"),t.subscriberOptions&&e.st(t.subscriberOptions,"options.subscriberOptions");var i=this;this.waitForOnline(function(e){return e?(i.ot.error("Failed to subscribe after error waiting for online status",e),n(e)):t.streamToken?I.call(i,t.streamToken,t,n):(i.ot.info("[%s] Generating stream token for subscribing to origin [%s]",i.Le.getValue().getProtocol().getSessionId(),t.streamId),void i.Be.createStreamTokenForSubscribing(i.Le.getValue().getProtocol().getSessionId(),t.capabilities,t.streamId,null,function(e,r){return e?(i.ot.error("Failed to create stream token for subscribing",e),n(e)):"ok"!==r.status?(i.ot.warn("Failed to create stream token for subscribing with status [%s]",r.status),n(null,r)):void I.call(i,r.streamToken,t,n)}))},t.isContinuation)},l.prototype.subscribeToScreen=function(e,n){var i=t.assign({},e);return t.set(i,["monitor","options"],t.assign({},{monitorFrameRate:!1,videoBitRateThreshold:100,conditionCountForNotificationThreshold:8},t.get(i,["monitor","options"],{}))),this.subscribe(i,n)},l.prototype.waitForOnline=function(n,i){if(e.rt(n,"callback"),this.Le.getValue()&&"online"===this.Le.getValue().getStatus())return n();var r=this,s=i?t.get(r.He,["maxOfflineTime"]):this.Je,o=null,a=null,u=setTimeout(function(){r.ot.info("Disposing of Express Online listener after [%s] ms",s),o&&o.dispose(),a&&a.dispose(),n(new Error("timeout"))},s);this.ot.info("Waiting for Online status before continuing. Timeout set to [%s]",s);var c=function(t){a&&a.dispose(),t&&(a=t.getObservableStatus().subscribe(function(t){if("online"===t)return clearTimeout(u),a.dispose(),o.dispose(),n()},{initial:"notify"}))};this.Le.getValue()&&c(this.Le.getValue()),o=this.Le.subscribe(c)},l}.apply(e,i))||(t.exports=r)},function(t,e,n){var i,r;i=[n(0),n(1)],void 0===(r=function(t,e){"use strict";var n=[{"16x9":[{2160:3840},{1080:1920},{768:1366},{720:1280},{576:1024},{480:853},{360:640},{180:320}]},{"4x3":[{1200:1600},{1080:1440},{720:960},{600:800},{576:768},{480:640},{360:480},{288:352},{240:320},{144:176},{120:160}]}],i={fallbackToLower:{id:0,name:"fallbackToLower"},fallbackToHigher:{id:1,name:"fallbackToHigher"},fallbackToLowerThenHigher:{id:2,name:"fallbackToLowerThenHigher"},exact:{id:3,name:"exact"}};function r(t){e.st(t,"options"),t.resolutionSelectionStrategy&&e.bt(t.resolutionSelectionStrategy,i,"options.resolutionSelectionStrategy"),t.aspectRatio&&e.wt(t.aspectRatio,"options.aspectRatio"),t.resolutionHeight&&e.Dt(t.resolutionHeight,"options.resolutionHeight"),t.frameRate&&e.Dt(t.frameRate,"options.frameRate"),this.$e=t.resolutionSelectionStrategy||i.fallbackToLowerThenHigher.name,this.Ye=t.aspectRatio||"16x9",this.tn=t.resolutionHeight||720,this.en=t.frameRate||15}function s(t){return e.Dt(t,"value"),2*Math.floor((t+1)/2)}function o(e,i){var r,s,o,a,l=u(i,n),p=c(i,n),m=c(e.toString(),l),v=0===m,g=n.length-1===p;if(t.Dt(m)){if(v)return g?null:(s=u(r=h(++p,n),n),o=h(m=d(this.tn,s),l),a=this.calculateWidthByAspectRatio(o,r),{aspectRatio:r,height:parseInt(o),width:parseInt(a)});m--}else if(!(m=d(e,l)))return;return r=h(p,n),o=h(m,s=f(p,n)),a=s[m][o],{aspectRatio:r,height:parseInt(o),width:parseInt(a)}}function a(e,i){var r,s,o,a,d,l,p=u(i,n),m=c(i,n),v=c(e.toString(),p),g=v===p.length-1,y=n.length-1===m;if(t.Dt(v)){if(g)return y?null:(r=h(++m,n),o=this.tn,a=this.calculateWidthByAspectRatio(o,r),{aspectRatio:r,height:parseInt(o),width:parseInt(a)});v++}else if(d=e,l=p,!(v=t.keys(l[l.length-1])[0]>d?null:t.reduce(l,function(e,n,i){if(!e)return i;var r=t.keys(l[e])[0],s=t.keys(n)[0];return s>d?e:Math.abs(d-s)<Math.abs(d-r)?i:e})))return;return r=h(m,n),o=h(v,s=f(m,n)),a=s[v][o],{aspectRatio:r,height:parseInt(o),width:parseInt(a)}}function u(e,n){var i=t.find(n,function(t){return t.hasOwnProperty(e)});return i?i[e]:null}function c(e,n){return t.findIndex(n,function(t){return t.hasOwnProperty(e)})}function h(e,n){return t.keys(n[e])[0]}function f(e,n){var i=t.keys(n[e]);return n[e][i[0]]}function d(e,n){return t.keys(n[0])[0]<e?null:t.reduce(n,function(i,r,s){if(!i)return s;var o=t.keys(n[i])[0],a=t.keys(r)[0];return a<e?i:Math.abs(e-a)<Math.abs(e-o)?s:i})}return r.prototype.getDefaultResolution=function(){var t=u(this.Ye,n),e=u(this.tn,t)||this.calculateWidthByAspectRatio(this.tn,this.Ye);return{height:this.tn,width:e,aspectRatio:this.Ye}},r.prototype.getDefaultFrameRate=function(){return this.en},r.prototype.getNextResolution=function(t,n){switch(e.Dt(t,"height"),e.wt(n,"aspectRatio"),this.$e){case i.fallbackToLower.name:return a.call(this,t,n);case i.fallbackToHigher.name:return o.call(this,t,n);case i.fallbackToLowerThenHigher.name:var r=null;return t>this.tn?r=o.call(this,t,n):(r=a.call(this,t,n))&&r.height||(r=o.call(this,this.tn,this.Ye)),r;case i.exact.name:default:return}},r.prototype.canResolveNextResolution=function(){return this.$e!==i.exact.name},r.prototype.calculateWidthByAspectRatio=function(t,e){switch(e){case"16x9":return s(16/9*t);case"4x3":return s(4/3*t);default:throw new Error("Aspect Ratio not supported")}},r}.apply(e,i))||(t.exports=r)},function(t,e,n){var i,r;i=[n(0),n(1),n(2),n(18),n(5)],void 0===(r=function(t,e,n,i,r){"use strict";var s,o=[r.types.realTime.name,r.types.dash.name,r.types.hls.name];function a(n){n=n||o,e.isArray(n,"features"),t.forEach(n,function(t,n){e.bt(t,r.types,"FeatureType["+n+"]")}),this.nn=t.map(n,t.bind(t.getEnumName,t,r.types))}function u(e,n){return t.includes(e,n)||e.push(n),e}return a.isFeatureSupported=function(s){switch(s&&e.wt(s,"feature"),t.getEnumName(r.types,s)){case r.types.realTime.name:return n.webrtcSupported;case r.types.dash.name:case r.types.hls.name:case r.types.rtmp.name:return i.canPlaybackType(s);default:return!1}},a.mapFeatureToPCastCapability=function(n){switch(n&&e.wt(n,"feature"),t.getEnumName(r.types,n)){case r.types.realTime.name:return"real-time";case r.types.dash.name:case r.types.hls.name:return"streaming";case r.types.rtmp.name:return"rtmp";default:return""}},a.mapPCastCapabilitiesToFeatures=function(n){return e.isArray(n,"capabilities"),t.reduce(n,function(t,e){return t.concat(a.mapPCastCapabilityToFeatures(e))},[])},a.mapPCastCapabilityToFeatures=function(t){return t&&e.wt(t,"capability"),"real-time"===t?[r.types.realTime.name]:"streaming"===t?[r.types.dash.name,r.types.dash.name]:"rtmp"===t?[r.types.rtmp.name]:[]},a.prototype.getFeatures=function(){return this.nn},a.prototype.getFeaturePCastCapabilities=function(){var e=t.map(this.nn,a.mapFeatureToPCastCapability);return t.reduce(e,u,[])},a.prototype.getPreferredFeatureFromPublisherCapabilities=function(n,i){e.isArray(n,"capabilities");var s=t.reduce(this.nn,function(e,r){var s=a.mapFeatureToPCastCapability(r),o=a.isFeatureSupported(r)&&(t.includes(n,s)||"real-time"===r&&!i);return e||(o?r:null)},null);return s===r.types.dash.name&&a.shouldUseNativeHls&&t.includes(n,a.mapFeatureToPCastCapability(r.types.hls.name))&&t.includes(this.nn,r.types.hls.name)?s=r.types.hls.name:s===r.types.hls.name&&!a.shouldUseNativeHls&&t.includes(n,a.mapFeatureToPCastCapability(r.types.dash.name))&&t.includes(this.nn,r.types.dash.name)&&(s=r.types.dash.name),s},a.shouldUseNativeHls=(s=t.get(n,["global","navigator","userAgent"],""),/iPad|iPhone|iPod/.test(s)&&!n.global.MSStream||"Safari"===n.browser||function(){var e=t.get(n,["global","navigator","userAgent"],"");return/SamsungBrowser/.test(e)}()),a}.apply(e,i))||(t.exports=r)},function(t,e,n){var i,r;i=[n(0),n(1),n(4),n(6),n(3),n(2),n(8),n(5)],void 0===(r=function(t,e,n,i,r,s,o,a){"use strict";function u(e,i,s,a,u){this.ot=u,this.Et=e,this.in=i,this.Rt=s,this.h=a,this.dt=null,this.J=null,this.Ot=new o(u),this.Pt=new n.NamedEvents,this.v=new r.DisposableList,this.rn=t.bind(c,this),this.sn=t.bind(h,this)}function c(t){this.ot.info("[%s] Loading Phenix Real-Time stream player stalled caused by [%s] event.",this.Et,t.type)}function h(){this.ot.info("[%s] Phenix Real-Time stream ended.",this.Et)}return u.prototype.on=function(t,e){return this.Pt.listen(t,e)},u.prototype.start=function(e){var n=!!t.find(this.in.getTracks(),function(t){return"audio"===t.kind});return this.h.canPlaybackAudio||(this.h.disableAudioIfNoOutputFound&&this.h.forcedAudioDisabled?this.ot.warn("[%s] Missing audio playback device. Audio has been disabled on stream. Try setting up an audio device and re-subscribe in order to receive audio.",this.Et):!this.h.disableAudioIfNoOutputFound&&n&&this.ot.warn("[%s] Missing audio playback device. May experience audio and/or video failure. Try setting up an audio device OR pass the [disableAudioIfNoOutputFound] option when subscribing to disable audio playback when no devices are attached.",this.Et)),this.J=s.attachMediaStream(e,this.in),this.v.add(this.Rt.recordTimeToFirstFrame(e)),this.v.add(this.Rt.recordRebuffering(e)),this.v.add(this.Rt.recordVideoResolutionChanges(this,e)),this.v.add(this.Rt.recordVideoPlayingAndPausing(e)),!1===this.h.receiveAudio&&(e.muted=!0),t.addEventListener(e,"stalled",this.rn,!1),t.addEventListener(e,"pause",this.rn,!1),t.addEventListener(e,"suspend",this.rn,!1),t.addEventListener(e,"ended",this.sn,!1),this.Ot.start(this,e),e},u.prototype.stop=function(e){this.Ot.stop(),this.v.dispose(),this.J&&(t.removeEventListener(this.J,"stalled",this.rn,!1),t.removeEventListener(this.J,"pause",this.rn,!1),t.removeEventListener(this.J,"suspend",this.rn,!1),t.removeEventListener(this.J,"ended",this.sn,!1),t.rt(this.J.pause)&&this.J.pause(),"Edge"===s.browser&&(this.J.src=""),this.J.src&&"IE"===s.browser?this.J.src=null:this.J.src&&(this.J.src=""),this.J.srcObject&&(this.J.srcObject=null),this.J=null),this.ot.info("[%s] Phenix real-time renderer has been destroyed",this.Et),this.Pt.fire(a.rendererEvents.ended.name,[e])},u.prototype.getStats=function(){if(!this.J)return{width:0,height:0,currentTime:0,lag:0,networkState:a.networkStates.networkNoSource.id};var e=(t.now()-this.h.originStartTime)/1e3,n=this.h.networkLag/1e3;return{width:this.J.videoWidth||this.J.width,height:this.J.videoHeight||this.J.height,currentTime:e,lag:n,networkState:this.J.networkState}},u.prototype.setDataQualityChangedCallback=function(t){e.rt(t,"callback"),this.dataQualityChangedCallback=t},u.prototype.addVideoDisplayDimensionsChangedCallback=function(t,e){return this.Ot.addVideoDisplayDimensionsChangedCallback(t,e)},u}.apply(e,i))||(t.exports=r)},function(t,e,n){var i,r;i=[n(0),n(1),n(4),n(2),n(12),n(20),n(32),n(5)],void 0===(r=function(t,e,n,i,r,s,o,a){"use strict";var u=5e3;function c(e,i,r,s,o,a){this.Et=e,this.in=i,this.At=r,this.Rt=s,this.h=o,this.ot=a,this.xt=[],this.Ot=null,this.Pt=new n.NamedEvents,this.an=[],t.addEventListener(r,"iceconnectionstatechange",t.bind(f,this))}function h(n){return t.reduce(n.getTracks(),function(t,n){return t&&function(t){return e.st(t,"track"),"ended"===t.readyState}(n)},!0)}function f(){var e=this;switch(this.At.iceConnectionState){case"checking":case"connecting":if(t.Dt(this.un))return;this.cn=t.now(),this.un=setTimeout(function(){e.ot.warn("[%s] Stream has not connected withing [%s] ms.",e.Et,u),e.Pt.fire(a.streamEvents.playerError.name,["real-time",new Error("connection-timeout")])},u);break;case"connected":t.Dt(this.un)&&(clearTimeout(this.un),this.un=null),this.ot.info("[%s] Ice Connection completed after [%s] ms",this.Et,t.now()-this.cn),this.cn=null}}return c.prototype.on=function(t,e){this.Pt.listen(t,e)},c.prototype.createRenderer=function(){var e=this,n=new o(this.Et,this.in,this.Rt,this.h,this.ot);return n.on(a.rendererEvents.error.name,function(t,n){e.Pt.fire(a.streamEvents.playerError.name,[t,n])}),n.on(a.rendererEvents.ended.name,function(i){e.xt=t.filter(e.xt,function(t){return t!==n}),0===e.xt.length&&(e.Rt.stop(),e.Pt.fire(a.streamEvents.playerEnded.name,[i]))}),this.xt.push(n),n},c.prototype.select=function(t){e.rt(t,"trackSelectCallback"),e.rt(i.global.MediaStream,"rtc.global.MediaStream");for(var n=this.in.getTracks(),r=new i.global.MediaStream,s=0;s<n.length;s++)t(n[s],s)&&r.addTrack(n[s]);if(0===r.getTracks().length)return this.ot.warn("No tracks selected");var o=this,u=new c(this.Et,r,this.At,this.Rt,this.h,this.ot);return u.on(a.streamEvents.stopped.name,function(t){h(o.in)&&o.Pt.fire(a.streamEvents.stopped.name,[t])}),this.an.push(u),u},c.prototype.setStreamEndedCallback=function(t){e.rt(t,"callback"),this.hn=t},c.prototype.setStreamErrorCallback=function(t){e.rt(t,"callback"),this.fn=t},c.prototype.streamEndedCallback=function(e,n,i){t.forEach(this.an,function(t){t.streamEndedCallback(n,i)}),t.rt(this.hn)&&this.hn(this,n,i)},c.prototype.streamErrorCallback=function(e,n,i){t.forEach(this.an,function(t){t.streamErrorCallback(n,i)}),t.rt(this.fn)&&this.fn(e,n,i)},c.prototype.stop=function(e){var n;this.isActive()&&((n=this.in)&&t.rt(n.stop,"stream.stop")&&n.stop(),t.forEach(n&&n.getTracks?n.getTracks():[],function(t){t.stop()}),this.ot.info("[%s] stop [real-time] media stream with reason [%s]",this.Et,e),this.Pt.fire(a.streamEvents.stopped.name,[e]),this.Mt=!0)},c.prototype.monitor=function(t,n){e.st(t,"options"),e.rt(n,"callback");var i=this,r=new s(i.Et,i.At,i.ot);return t.direction="inbound",r.start(t,function(){return i.isActive()},function(t,e){return t&&i.ot.warn("[%s] Media stream monitor triggered unrecoverable error [%s]",t),i.ot.warn("[%s] Media stream triggered monitor condition for [%s]",i.Et,e.type),n(i,"client-side-failure",e)}),this.dn=r,r},c.prototype.getMonitor=function(){return this.dn},c.prototype.getStream=function(){return this.in},c.prototype.isActive=function(){return!this.Mt&&!h(this.in)},c.prototype.getStreamId=function(){return this.Et},c.prototype.getStats=function(t){e.rt(t,"callback"),this.Nt||(this.Nt={});var n=this;return i.getStats(this.At,null,function(e){t(r.convertPeerConnectionStats(e,n.Nt))})},c.prototype.getRenderer=function(){return t.get(this.xt,[0],null)},c}.apply(e,i))||(t.exports=r)},function(t,e,n){var i,r;i=[n(0),n(1),n(10),n(4),n(6),n(3),n(11),n(2),n(8),n(5)],void 0===(r=function(t,e,n,i,r,s,o,a,u,c){"use strict";var h=6e3,f=15e3,d={local:"https://local.phenixrts.com/public/rtmp/rtmp-flash-renderer-2018.3.13.swf",staging:"https://stg.phenixrts.com/public/rtmp/rtmp-flash-renderer-2018.3.13.swf",production:"https://phenixrts.com/public/rtmp/rtmp-flash-renderer-2018.3.13.swf"};function l(n,r,o,a,c){e.st(a,"options"),a.env&&e.wt(a.env,"options.env");var h=d[a.env||"production"];this.ot=c,this.Et=n,this.ln=t.map(r,function(t){return t.uri=encodeURI(t.uri).replace(/[#]/g,"%23"),t}),this.Rt=o,this.h=a,this.dt=null,this.pn=null,this.mn=null,this.Pt=new i.NamedEvents,this.Ot=new u(c),this.v=new s.DisposableList,this.rn=t.bind(v,this),this.sn=t.bind(g,this),this.Ge=t.bind(p,this),this.W=a.swfSrc||h}function p(t){this.Pt.fire(c.rendererEvents.error.name,["flash-player",t])}function m(){var e=!this.vn||t.now()-this.vn>f;return this.mn&&!this.gn&&this.yn&&0!==this.mn.buffered.length&&e}function v(e){var n=this;n.ot.info("[%s] Loading flash player stalled caused by [%s] event.",n.Et,e.type);var i=n.mn.currentTime;setTimeout(function(){n.mn&&n.mn.currentTime===i&&!n.mn.paused&&m.call(n)&&(n.ot.warn("Reloading stream after being stalled for [%s] seconds",h/1e3),function(){m.call(this)&&(this.ot.warn("Reloading unhealthy stream that was active for at least [%s] seconds",f/1e3),this.vn=t.now(),function(){this.pn.destroy(),this.start(this.wn)}.call(this))}.call(n))},h)}function g(){this.ot.info("[%s] Flash player ended.",this.Et)}l.isSupported=function(){return function(){var e=[10,0,0],n=[0,0,0];if(t.Jt(y))return y;if(t.get(a.global.navigator,["plugins","Shockwave Flash"])){var i=a.global.navigator.plugins["Shockwave Flash"].description;if(i&&t.get(a.global.navigator,["mimeTypes","application/x-shockwave-flash","enabledPlugin"],!1))for(var r=0,s=(n=i.replace("Shockwave Flash","").replace(/^\s+/,"").replace(/\sr/gi,".").split(".")).length;r<s;r++)n[r]=parseInt(n[r].match(/\d+/),10)}else if(a.global.ActiveXObject)try{var o=new a.global.ActiveXObject("ShockwaveFlash.ShockwaveFlash");if(o){var u=o.GetVariable("$version")||"",c=t.get(u.split(" "),[1],n).split(",");n=[parseInt(c[0],10),parseInt(c[1],10),parseInt(c[2],10)]}}catch(t){console.error(t)}return y=n[0]>e[0]||n[0]===e[0]&&n[1]>0||n[0]===e[0]&&0===n[1]&&n[2]>=0}()},l.prototype.on=function(t,e){return this.Pt.listen(t,e)},l.prototype.start=function(e){var n={streamId:this.Et,swfSrc:this.W};return this.wn=e,this.pn=new a.PhenixVideo(e,this.ln,"flash",n),this.pn.hookUpEvents(),this.mn=this.pn.getElement(),this.v.add(this.Rt.recordTimeToFirstFrame(this.wn)),this.v.add(this.Rt.recordRebuffering(this.wn)),this.v.add(this.Rt.recordVideoResolutionChanges(this,this.wn)),this.v.add(this.Rt.recordVideoPlayingAndPausing(this.wn)),this.mn&&this.mn.play(),t.addEventListener(this.wn,"stalled",this.rn,!1),t.addEventListener(this.wn,"pause",this.rn,!1),t.addEventListener(this.wn,"suspend",this.rn,!1),t.addEventListener(this.wn,"ended",this.sn,!1),t.addEventListener(this.wn,"error",this.Ge,!1),e},l.prototype.stop=function(e){var n=this;if(this.v.dispose(),this.pn){var i=function(){n.mn&&(t.removeEventListener(n.wn,"stalled",n.rn,!1),t.removeEventListener(n.wn,"pause",n.rn,!1),t.removeEventListener(n.wn,"suspend",n.rn,!1),t.removeEventListener(n.wn,"ended",n.sn,!1),t.removeEventListener(n.wn,"error",n.Ge,!1)),n.mn=null,n.wn=null,n.Pt.fire(c.rendererEvents.ended.name,[e])};try{this.pn.destroy(),this.pn=null,i(),this.ot.info("[%s] Flash player has been destroyed",this.Et)}catch(t){n.ot.error("[%s] Error while destroying Flash player [%s]",n.Et,t.code,t),i(),n.Pt.fire(c.rendererEvents.error.name,["flash-player",t])}}},l.prototype.getStats=function(){if(!this.mn)return{width:0,height:0,currentTime:0,lag:0,networkState:c.networkStates.networkNoSource.id};var e={},n=this.mn.currentTime,i=(t.now()-this.h.originStartTime)/1e3;return e.lag=Math.max(0,i-n),e.estimatedBandwidth>0?e.networkState=c.networkStates.networkLoading.id:e.playTime>0?e.networkState=c.networkStates.networkIdle.id:e.video?e.networkState=c.networkStates.networkEmpty.id:e.networkState=c.networkStates.networkNoSource.id,e},l.prototype.setDataQualityChangedCallback=function(t){e.rt(t,"callback"),this.dataQualityChangedCallback=t},l.prototype.getPlayer=function(){return this.yn},l.prototype.addVideoDisplayDimensionsChangedCallback=function(t,e){return this.Ot.addVideoDisplayDimensionsChangedCallback(t,e)};var y=null;return l}.apply(e,i))||(t.exports=r)},function(t,e,n){var i,r;i=[n(0),n(1),n(10),n(4),n(6),n(3),n(11),n(2),n(8),n(5)],void 0===(r=function(t,e,n,i,r,s,o,a,u,c){"use strict";var h=6e3,f=15e3;function d(e,n,r,o,a){this.ot=a,this.Et=e,this.bn=encodeURI(n).replace(/[#]/g,"%23"),this.Rt=r,this.h=o,this.dt=null,this.J=null,this.Ot=new u(a),this.kn={time:0,buffered:null,averageLength:0,count:0,lastCurrentTime:0,lastCurrentTimeOccurenceTimestamp:0},this.Pt=new i.NamedEvents,this.v=new s.DisposableList,this.rn=t.bind(g,this),this.Sn=t.bind(v,this),this.sn=t.bind(w,this)}function l(t){if(m.call(this)&&t&&(3===t.code||t.severity===o.errors.severity.RECOVERABLE))return this.ot.warn("Reloading unhealthy stream after error event [%s]",t),p.call(this);this.Pt.fire(c.rendererEvents.error.name,["phenix-player",t])}function p(){m.call(this)&&(this.ot.warn("Reloading unhealthy stream that was active for at least [%s] seconds",f/1e3),this.vn=t.now(),function(){this.yn.dispose(),this.yn=null,this.start(this.J)}.call(this))}function m(){var e=!this.vn||t.now()-this.vn>f;return this.J&&!this.gn&&this.yn&&0!==this.J.buffered.length&&e}function v(){if(this.kn.time=t.now(),0===this.J.buffered.length)return this.ot.debug("[%s] Phenix live stream player progress event fired without any buffered content",this.Et);var e=this.J.buffered.end(this.J.buffered.length-1);if(this.kn.buffered!==e){if(null!==this.kn.buffered){var n=this.kn.averageLength*this.kn.count+(e-this.kn.buffered),i=this.kn.lastCurrentTime===this.J.currentTime;this.kn.count+=1,this.kn.averageLength=n/this.kn.count,i||(this.kn.lastCurrentTimeOccurenceTimestamp=t.now());var r=this.kn.lastCurrentTimeOccurenceTimestamp&&t.now()-this.kn.lastCurrentTimeOccurenceTimestamp>h;i&&r&&this.J&&!this.J.paused&&m.call(this)&&(this.ot.warn("Reloading stream after current time has not changed for [%s] seconds due to unregistered stall.",h/1e3),p.call(this))}this.kn.buffered=e,this.kn.lastCurrentTime=this.J.currentTime}}function g(e){var n=this;if(n.ot.info("[%s] Loading Phenix Live stream player stalled caused by [%s] event.",n.Et,e.type),0!==n.kn.time&&!n.J.paused){var i=n.J.currentTime;setTimeout(function(){t.now()-n.kn.time>y.call(n)&&n.gn&&n.stop("ended")},y.call(n)),setTimeout(function(){n.J&&n.J.currentTime===i&&!n.J.paused&&m.call(n)&&(n.ot.warn("Reloading stream after being stalled for [%s] seconds",h/1e3),p.call(n))},h)}}function y(){return 1.5*this.kn.averageLength<2e3?2e3:1.5*this.kn.averageLength}function w(){this.ot.info("[%s] Phenix live stream player ended.",this.Et)}return d.isSupported=function(){return o.isSupported},d.prototype.on=function(t,e){return this.Pt.listen(t,e)},d.prototype.start=function(e){var i,r,s,a=(r=(i=this.ot).getAppenders(),s=new n.Logger,t.forEach(r,function(t){t instanceof n.ConsoleAppender&&(t=new n.ConsoleAppender).setThreshold(n.level.INFO),s.addAppender(t)}),s.setUserId(i.getUserId()),s.setEnvironment(i.getEnvironment()),s.setApplicationVersion(i.getApplicationVersion()),s.setObservableSessionId(i.getObservableSessionId()),s);return this.In=a,this.J=e,this.v.add(this.Rt.recordTimeToFirstFrame(e)),this.v.add(this.Rt.recordRebuffering(e)),this.v.add(this.Rt.recordVideoResolutionChanges(this,e)),this.v.add(this.Rt.recordVideoPlayingAndPausing(e)),function(){var e=t.assign({bandwidthToStartAt:3e6},this.h);t.includes(this.bn,".mpd")&&this.h.isDrmProtectedContent&&(e.drm={"com.widevine.alpha":{serverCertificateUrl:this.h.widevineServiceCertificateUrl,mediaKeySystemConfiguration:{persistentState:"required"}},"com.microsoft.playready":{licenseServerUrl:this.h.playreadyLicenseUrl}});var n=new o.WebPlayer(this.In,this.J,e);t.now()-this.h.originStartTime<6e3&&this.h.isDrmProtectedContent&&t.includes(this.bn,".m3u8")?setTimeout(t.bind(n.start,n,this.bn),6e3):n.start(this.bn),this.yn=n,t.addEventListener(this.yn,"error",t.bind(l,this))}.call(this),!1===this.h.receiveAudio&&(e.muted=!0),t.addEventListener(e,"stalled",this.rn,!1),t.addEventListener(e,"pause",this.rn,!1),t.addEventListener(e,"suspend",this.rn,!1),t.addEventListener(e,"progress",this.Sn,!1),t.addEventListener(e,"ended",this.sn,!1),this.Ot.start(this,e),e},d.prototype.stop=function(e,n){var i=this;if(!i.En){if(n)return i.gn=!0;if(this.Ot.stop(),this.v.dispose(),this.yn){var r=function(){i.J&&(t.removeEventListener(i.J,"stalled",i.rn,!1),t.removeEventListener(i.J,"pause",i.rn,!1),t.removeEventListener(i.J,"suspend",i.rn,!1),t.removeEventListener(i.J,"progress",i.Sn,!1),t.removeEventListener(i.J,"ended",i.sn,!1),"Edge"===a.browser&&(i.J.src="")),i.Pt.fire(c.rendererEvents.ended.name,[""]),i.yn=null,i.J=null};i.En=!0;try{i.yn.dispose(),i.ot.info("[%s] Phenix live stream has been destroyed",i.Et),r()}catch(t){i.ot.error("[%s] Error while destroying Phenix live stream player [%s]",i.Et,t.code,t),r(),i.Pt.fire(c.rendererEvents.error.name,["phenix-player",t])}}}},d.prototype.getStats=function(){if(!this.yn)return{width:0,height:0,currentTime:0,lag:0,networkState:c.networkStates.networkNoSource.id};var e=this.yn.getStats(),n=e.currentTime||this.J.currentTime,i=(t.now()-this.h.originStartTime)/1e3;return e.isNative&&"Hls"===e.deliveryType&&(e.currentTime=i-e.lag),e.isNative||(e.lag=Math.max(0,i-n)),e.estimatedBandwidth>0?e.networkState=c.networkStates.networkLoading.id:e.playTime>0?e.networkState=c.networkStates.networkIdle.id:e.video?e.networkState=c.networkStates.networkEmpty.id:e.networkState=c.networkStates.networkNoSource.id,e},d.prototype.setDataQualityChangedCallback=function(t){e.rt(t,"callback"),this.dataQualityChangedCallback=t},d.prototype.getPlayer=function(){return this.yn},d.prototype.addVideoDisplayDimensionsChangedCallback=function(t,e){return this.Ot.addVideoDisplayDimensionsChangedCallback(t,e)},d}.apply(e,i))||(t.exports=r)},function(t,e,n){var i,r;i=[n(0),n(1),n(4),n(6),n(3),n(2),n(8),n(5)],void 0===(r=function(t,e,n,i,r,s,o,a){"use strict";var u=null;function c(e,i,s,a,u,c){this.ot=c,this.Et=e,this.bn=encodeURI(i).replace(/[#]/g,"%23"),this.Rt=s,this.h=a,this.dt=null,this.J=null,this.Ot=new o(c),this.kn={time:0,buffered:null,averageLength:0,count:0},this.Pt=new n.NamedEvents,this.v=new r.DisposableList,this.Ct=u,this.rn=t.bind(f,this),this.Sn=t.bind(h,this),this.sn=t.bind(l,this)}function h(){if(this.kn.time=t.now(),0===this.J.buffered.length)return this.ot.debug("[%s] Shaka live stream player progress event fired without any buffered content",this.Et);var e=this.J.buffered.end(this.J.buffered.length-1);if(this.kn.buffered!==e){if(null!==this.kn.buffered){var n=this.kn.averageLength*this.kn.count+(e-this.kn.buffered);this.kn.count+=1,this.kn.averageLength=n/this.kn.count}this.kn.buffered=e}}function f(){var e=this;e.ot.info("[%s] Loading Shaka live stream player stream stalled.",e.Et),0!==e.kn.time&&setTimeout(function(){t.now()-e.kn.time>d.call(e)&&e.gn&&e.stop("ended")},d.call(e))}function d(){return 1.5*this.kn.averageLength<2e3?2e3:1.5*this.kn.averageLength}function l(){this.ot.info("[%s] Shaka live stream player ended.",this.Et)}return c.prototype.on=function(t,e){return this.Pt.listen(t,e)},c.prototype.start=function(e){var n=this;n.yn=new this.Ct.Player(e),this.v.add(this.Rt.recordTimeToFirstFrame(e)),this.v.add(this.Rt.recordRebuffering(e)),this.v.add(this.Rt.recordVideoResolutionChanges(this,e));var r={abr:{defaultBandwidthEstimate:2e6},manifest:{retryParameters:{timeout:1e4}},streaming:{rebufferingGoal:2,bufferingGoal:10,bufferBehind:30,retryParameters:{timeout:1e4,maxAttempts:10,backoffFactor:1.1}}};function o(i){n.yn.configure(i),!1===n.h.receiveAudio&&(e.muted=!0),t.addEventListener(n.yn,"error",function(t){n.Pt.fire(a.rendererEvents.error.name,["player",t])}),t.addEventListener(e,"stalled",n.rn,!1),t.addEventListener(e,"pause",n.rn,!1),t.addEventListener(e,"suspend",n.rn,!1),t.addEventListener(e,"progress",n.Sn,!1),t.addEventListener(e,"ended",n.sn,!1),n.yn.load(n.bn).then(function(){n.ot.info("[%s] DASH live stream has been loaded",n.Et),t.rt(e.play)&&e.play()}).catch(function(t){n.ot.error("[%s] Error while loading DASH live stream [%s]",n.Et,t.code,t),n.Pt.fire(a.rendererEvents.error.name,["shaka",t])}),n.Ot.start(this,e),n.J=e}return this.h.isDrmProtectedContent?(function(){var e;if(!t.rt(Uint8Array))throw e="Uint8Array support required for DRM",this.ot.error(e),new Error(e);if(!t.rt(s.global.atob))throw e="rtc.global.atob support required for DRM",this.ot.error(e),new Error(e)}.call(n),function(t){var e=this;t.getNetworkingEngine().registerResponseFilter(function(n,i){if(n.toString()===e.Ct.net.NetworkingEngine.RequestType.LICENSE.toString()){var r=new Uint8Array(i.data),o=String.fromCharCode.apply(null,r),a=JSON.parse(o),u=a.license,c=s.global.atob(u);i.data=new Uint8Array(c.length);for(var h=0;h<c.length;++h)i.data[h]=c.charCodeAt(h);a.trackRestrictions&&t.configure({restrictions:a.trackRestrictions})}})}.call(n,n.yn),function(t,e,n){t.drm||(t.drm={}),t.drm.advanced||(t.drm.advanced={}),t.manifest||(t.manifest={}),t.manifest.dash||(t.manifest.dash={}),function(t,e,n){function r(e,i){e?n(e):(u=i.data,t.drm.advanced["com.widevine.alpha"]={serverCertificate:function(t){for(var e=t.length,n=new Uint8Array(e),i=0;i<e;i++)n[i]=t.charCodeAt(i);return n}(i.data),persistentStateRequired:!0,distinctiveIdentifierRequired:!1},n(null,t))}t.manifest.dash.customScheme=function(t){if("com.phenixrts.widevine"===t.getAttribute("schemeIdUri")||"com.phenixp2p.widevine"===t.getAttribute("schemeIdUri"))return[{keySystem:"com.widevine.alpha",licenseServerUri:decodeURIComponent(t.getAttribute("widevineLicenseServerUrl"))}]},u?r(null,u):i.get(e.widevineServiceCertificateUrl,{mimeType:"text/plain; charset=x-user-defined"},r)}.call(this,t,e,n)}.call(n,r,n.h,function(t,e){if(t)throw n.ot.error("Failed to add DRM configuration to shaka player",t),t;o(e)})):o(r),e},c.prototype.stop=function(e,n){var i=this;if(!i.En){if(n)return i.gn=!0;if(this.Ot.stop(),this.v.dispose(),this.yn){var r=function(){i.J&&(t.removeEventListener(i.J,"stalled",i.rn,!1),t.removeEventListener(i.J,"pause",i.rn,!1),t.removeEventListener(i.J,"suspend",i.rn,!1),t.removeEventListener(i.J,"progress",i.Sn,!1),t.removeEventListener(i.J,"ended",i.sn,!1),"Edge"===s.browser&&(i.J.src="")),i.Pt.fire(a.rendererEvents.ended.name,[""]),i.yn=null,i.J=null};i.yn.destroy().then(function(){i.ot.info("[%s] Shaka live stream player has been destroyed",i.Et)}).then(function(){r()}).catch(function(t){i.ot.error("[%s] Error while destroying shaka live stream player [%s]",i.Et,t.code,t),r(),i.Pt.fire(a.rendererEvents.error.name,["shaka",t])}),i.En=!0}}},c.prototype.getStats=function(){if(!this.yn)return{width:0,height:0,currentTime:0,lag:0,networkState:a.networkStates.networkNoSource.id};var e=t.assign(this.yn.getStats(),{currentTime:0,lag:0}),n=t.get(this.J,["currentTime"],0),i=(t.now()-this.h.originStartTime)/1e3,r=Math.max(0,i-n);return this.J&&(e.currentTime=n,e.lag=r),e.estimatedBandwidth>0?e.networkState=a.networkStates.networkLoading.id:e.playTime>0?e.networkState=a.networkStates.networkIdle.id:e.video?e.networkState=a.networkStates.networkEmpty.id:e.networkState=a.networkStates.networkNoSource.id,e},c.prototype.setDataQualityChangedCallback=function(t){e.rt(t,"callback"),this.dataQualityChangedCallback=t},c.prototype.getPlayer=function(){return this.yn},c.prototype.addVideoDisplayDimensionsChangedCallback=function(t,e){return this.Ot.addVideoDisplayDimensionsChangedCallback(t,e)},c}.apply(e,i))||(t.exports=r)},function(t,e,n){var i,r;i=[n(0),n(1),n(5)],void 0===(r=function(t,e,n){"use strict";function i(t,i,r){e.wt(t,"type"),e.st(i,"stream"),e.st(r,"logger"),this.It=t,this.e=i,this.ot=r,this.Tn=null;var s=this;this.e.on(n.streamEvents.playerEnded.name,function(t){if(s.ot.info("[%s] [%s] player ended.",s.e.getStreamId(),s.It),s.Rn=!0,s.Tn)return s.Tn();s.streamEndedCallback(function(e){switch(t){case"":case"none":case"ended":return"ended";case"server-error":case"session-error":case"not-ready":case"error":case"died":return"failed";case"censored":return"censored";case"maintenance":return"maintenance";case"capacity":return"capacity";case"app-background":return"app-background";default:return"custom"}}(),t)})}return i.prototype.on=function(t,e){return this.e.on(t,e)},i.prototype.streamErrorCallback=function(e,n){t.rt(this.e.streamErrorCallback)?(this.ot.debug("[%s] [%s] live stream error event [%s]",this.e.getStreamId(),this.It,n),this.e.streamErrorCallback(this.e,e,n)):this.ot.error("[%s] [%s] live stream error event [%s]",this.e.getStreamId(),this.It,n)},i.prototype.streamEndedCallback=function(e,n,i){var r=this.e.getRenderer();if(!this.Cn){if(i&&!this.Tn&&this.e.isActive()&&r&&!this.Rn)return this.Tn=t.bind(this.streamEndedCallback,this,e,n),this.ot.info("[%s] [%s] stream ended. Waiting for end of player.",this.e.getStreamId(),this.It),void(r&&r.stop(n,i));this.Cn=!0,t.rt(this.e.streamEndedCallback)&&this.e.streamEndedCallback(this.e,e,n),this.e.stop(n),r&&r.stop(n,i)}},i.prototype.dataQualityChangedCallback=function(e,n){var i=this.e.getRenderer();i&&t.rt(i.dataQualityChangedCallback)&&i.dataQualityChangedCallback(i,e,n)},i.prototype.getPhenixMediaStream=function(){return this.e},i}.apply(e,i))||(t.exports=r)},function(t,e,n){var i,r;i=[n(0),n(1),n(4),n(3),n(2)],void 0===(r=function(t,e,n,i,r){function s(t){if(e.st(t,"logger"),this.ot=t,this.Pt=new n.NamedEvents,this.v=new i.DisposableList,this.v.add(this.Pt),!this.isSupported())return this.ot.info("Network monitor is not supported.");this.xn=o.call(this),function(){var t=this;navigator.connection.addEventListener("change",function(){t.Pt.fireAsync("NetworkChange",[o.call(t),t.xn]),t.xn=o.call(t)})}.call(this)}function o(){return{downlinkThroughputCapacity:this.getDownlinkThroughputCapacity(),effectiveType:this.getEffectiveType(),rtt:this.getRoundTripTime()}}return s.prototype.isSupported=function(){return r.global.navigator&&r.global.navigator.connection},s.prototype.getDownlinkThroughputCapacity=function(){return this.isSupported()?r.global.navigator.connection.downlink||r.global.navigator.connection.downlinkMax:-1},s.prototype.getEffectiveType=function(){return this.isSupported()?r.global.navigator.connection.effectiveType||r.global.navigator.connection.type:"Unknown"},s.prototype.getRoundTripTime=function(){return this.isSupported()?r.global.navigator.connection.rtt||r.global.navigator.connection.type:-1},s.prototype.onNetworkChange=function(t){if(this.isSupported())return e.rt(t,"callback"),this.Pt.listen("NetworkChange",t)},s.prototype.dispose=function(){this.v.dispose()},s}.apply(e,i))||(t.exports=r)},function(t,e,n){var i,r;i=[n(0),n(1),n(4),n(3)],void 0===(r=function(t,e,n,i){"use strict";var r=3e3;function s(){this.Pt=new n.NamedEvents,this.On=t.now(),this.v=new i.DisposableList,this.Pn=!0,this.v.add(this.Pt),function(){if(o())return function(){if(o()){var t=this;chrome.extension.onRequest.addListener(function(e,n,i){"is_selected"===e&&chrome.tabs.getSelected(null,function(e){var r=e.id===n.tab.id;a.call(t,r),i(!!r)})})}}.call(this);(function(){var e,n,s=this;function o(){var t=!document[e];a.call(s,t)}"object"==typeof document&&(void 0!==document.msHidden?(e="msHidden",n="msvisibilitychange"):void 0!==document.webkitHidden?(e="webkitHidden",n="webkitvisibilitychange"):void 0!==document.hidden&&(e="hidden",n="visibilitychange"),void 0!==document.addEventListener&&void 0!==document[e]?(t.addEventListener(document,n,o,!1),s.v.add(new i.Disposable(function(){t.removeEventListener(document,n,o,!1)}))):function(){var e=this;e.Mn=setInterval(function(){var t=document.hasFocus();a.call(e,t)},r),e.v.add(new i.Disposable(function(){t.Dt(e.Mn)&&clearInterval(e.Mn),e.Mn=null}))}.call(s))}).call(this)}.call(this)}function o(){return"undefined"!=typeof chrome&&chrome.extension&&chrome.extension.onRequest}function a(t){if(e.Jt(t,"isForeground"),this.Pn!==t)return t?(this.Pn=!0,u.call(this,"foreground")):(this.Pn=!1,u.call(this,"background"))}function u(e){var n=t.now(),i=n-this.On;this.On=n,this.Pt.fire(e,[i])}return s.prototype.isForeground=function(){return this.Pn},s.prototype.getTimeSinceLastChange=function(){return t.now()-this.On},s.prototype.onForeground=function(t){return e.rt(t,"callback"),this.Pt.listen("foreground",t)},s.prototype.onBackground=function(t){return e.rt(t,"callback"),this.Pt.listen("background",t)},s}.apply(e,i))||(t.exports=r)},function(t,e,n){var i,r;i=[n(39)],void 0===(r=function(t){"use strict";return new t}.apply(e,i))||(t.exports=r)},function(t,e,n){var i,r;i=[n(0),n(1),n(3),n(40),n(38),n(2)],void 0===(r=function(t,e,n,i,r,s){"use strict";var o=s.global.__phenixPageLoadTime||s.global.__pageLoadTime||t.now(),a="production",u="2018-09-17T15:08:57Z";function c(e,s){this.Dn=a,this.tt=u,this.qn=null,this.An={resource:"session",kind:"event"},this.ot=e,this.he=s,this.Nn=new r(this.ot),this.Fn=t.now(),this.v=new n.DisposableList,this.jn=[],this.v.add(i.onBackground(t.bind(h,this,!1))),this.v.add(i.onForeground(t.bind(h,this,!0))),this.Nn.isSupported()&&(this.v.add(this.Nn.onNetworkChange(t.bind(p,this))),this.v.add(this.Nn),f.call(this),l.call(this),d.call(this))}function h(t,e){var n=t?"ApplicationForeground":"ApplicationBackground";this.recordMetric(n,{uint64:e}),m.call(this,"Application has gone into the [%s] after [%s] ms",t?"foreground":"background",e)}function f(){var t=this.Nn.getEffectiveType();this.recordMetric("NetworkType",{string:t},null,{resource:s.browser}),m.call(this,"[%s] has started with Network effective type of [%s]",this.qn?"Session":"Application",t)}function d(e,n){var i=e||this.Nn.getRoundTripTime(),r=n||-1;if(this.recordMetric("RoundTripTime",{uint32:i},{uint32:r},{resource:s.browser}),t.isNullOrUndefined(n))return m.call(this,"Network RTT [%s]",i);m.call(this,"Network RTT changed to [%s] from [%s]",i,r)}function l(e,n){var i=e||this.Nn.getDownlinkThroughputCapacity(),r=n||-1;if(this.recordMetric("DownlinkThroughputCapacity",{float:i},{float:r},{resource:s.browser}),t.isNullOrUndefined(n))return m.call(this,"Network downlink throughput capacity [%s]",i);m.call(this,"Network downlink throughput capacity changed to [%s] from [%s]",i,r)}function p(t,e){e.downlinkThroughputCapacity!==t.downlinkThroughputCapacity&&l.call(this,t.downlinkThroughputCapacity,e.downlinkThroughputCapacity),e.rtt!==t.rtt&&d.call(this,t.rtt,e.rtt),e.effectiveType!==t.effectiveType&&function(t,e){var n=t||this.Nn.getEffectiveType(),i=e;this.recordMetric("NetworkType",{string:n},{string:i},{resource:s.browser}),m.call(this,"Network effective type has changed to [%s] from [%s]",n,i||"New")}.call(this,t.effectiveType,e.effectiveType)}function m(){var e=Array.prototype.slice.call(arguments);if(0===e.length)throw new Error("Invalid logging arguments.");var n="[%s] [SessionTelemetry] [%s] "+e[0],i=e.slice(1),r=[n,this.qn,t.now()-this.Fn].concat(i);this.ot.info.apply(this.ot,r)}function v(){return(t.now()-o)/1e3}function g(n,i){if(e.wt(n.metric,"record.metric"),!this.qn)return this.jn.push({record:n,since:i});var r=t.assign({},this.An,n);this.he.submitMetric(n.metric,i,this.qn,null,this.Dn,this.tt,r)}return c.prototype.setSessionId=function(t){!t&&this.qn&&g.call(this,{metric:"Stopped",elapsed:this.elapsed()},v()),this.qn=t,t&&(g.call(this,{metric:"Initialized",elapsed:this.elapsed()},v()),function(){if(this.qn)for(var t=this.jn.length;t>0;){var e=this.jn.splice(t-1,1);1===e.length&&g.call(this,e[0].record,e[0].since),t--}}.call(this),function(){var t=i.isForeground(),e=i.getTimeSinceLastChange(),n=t?"ApplicationForeground":"ApplicationBackground";this.recordMetric(n,{uint64:e}),m.call(this,"Session has started in the [%s] after [%s] ms",t?"foreground":"background",e)}.call(this),this.Nn.isSupported()&&(f.call(this),l.call(this),d.call(this)))},c.prototype.setProperty=function(t,n){e.wt(t,"name"),e.wt(n,"value"),this.An[t]=n},c.prototype.recordMetric=function(n,i,r,s){e.wt(n,"metric");var o=t.assign({},{metric:n,elapsed:this.elapsed(),value:i,previousValue:r},s||{});g.call(this,o,v())},c.prototype.elapsed=function(){return t.now()-this.Fn},c.prototype.dispose=function(){this.v.dispose(),this.recordMetric("Stopped"),m.call(this,"Session telemetry stopped")},c}.apply(e,i))||(t.exports=r)},function(t,e,n){var i,r;i=[n(0),n(1),n(3),n(2)],void 0===(r=function(t,e,n,i){"use strict";var r=i.global.__phenixPageLoadTime||i.global.__pageLoadTime||t.now(),s="production",o="2018-09-17T15:08:57Z";function a(i,r,a){e.wt(i,"sessionId"),this.Dn=s,this.tt=o,this.qn=i,this.An={},this.ot=r,this.he=a,this.Fn=t.now(),this.v=new n.DisposableList,this.Un=[],this.Ln=[],this._n=[],this.Bn=null,u.call(this,"Stream initializing")}function u(){var e=Array.prototype.slice.call(arguments);if(0===e.length)throw new Error("Invalid logging arguments.");var n="[%s] [StreamTelemetry] [%s] "+e[0],i=e.slice(1),r=[n,this.Et,t.now()-this.Fn].concat(i);this.ot.debug.apply(this.ot,r)}function c(){return(t.now()-r)/1e3}function h(n,i){e.wt(n.metric,"record.metric");var r=t.assign({},this.An,n);this.he.submitMetric(n.metric,i,this.qn,this.Et,this.Dn,this.tt,r)}return a.prototype.setProperty=function(t,n){e.wt(t,"name"),e.wt(n,"value"),this.An[t]=n},a.prototype.recordMetric=function(n,i,r,s){e.wt(n,"metric");var o=t.assign({},{metric:n,elapsed:this.elapsed(),value:i,previousValue:r},s||{});h.call(this,o,c())},a.prototype.setStreamId=function(n){if(e.wt(n,"streamId"),this.Et)throw new Error("Stream ID can only be set once.");this.Et=n;var i=t.now();h.call(this,{metric:"Initialized",elapsed:this.elapsed()-i+this.Fn},c()-(i-this.Fn)/1e3)},a.prototype.setStartOffset=function(t){if(e.Dt(t,"startOffset"),this.Wn)throw new Error("Start offset can only be set once.");this.Wn=t,this.recordMetric("Offset",{uint64:t})},a.prototype.getStartOffset=function(){return this.Wn},a.prototype.elapsed=function(){return t.now()-this.Fn},a.prototype.stop=function(){this.v.dispose(),this.recordMetric("Stopped"),u.call(this,"Stream stopped")},a.prototype.recordTimeToFirstFrame=function(e){var i=this,r=t.now(),s=function(){i.Bn||(i.Bn=t.now()-r,i.recordMetric("TimeToFirstFrame",{uint64:i.Bn}),u.call(i,"First frame [%s]",i.Bn),o.dispose())};t.addEventListener(e,"loadeddata",s),t.addEventListener(e,"loadedmetadata",s);var o=new n.Disposable(function(){t.removeEventListener(e,"loadeddata",s),t.removeEventListener(e,"loadedmetadata",s)});return this.v.add(o),o},a.prototype.recordVideoResolutionChanges=function(e,i){var r=this,s={width:i.videoWidth,height:i.videoHeight};if(t.find(this.Un,function(t){return t===i}))return new n.Disposable(t.noop);this.Un.push(i);var o=e.addVideoDisplayDimensionsChangedCallback(function(t,e){s.width===e.width&&s.height===e.height||(r.recordMetric("ResolutionChanged",{string:e.width+"x"+e.height},{string:s.width+"x"+s.height}),s={width:e.width,height:e.height},u.call(r,"Resolution changed: width [%s] height [%s]",e.width,e.height))});return this.v.add(o),o},a.prototype.recordRebuffering=function(e){var r,s,o=this;if(t.find(this.Ln,function(t){return t===e}))return new n.Disposable(t.noop);this.Ln.push(e);var a=function(){r||(o.recordMetric("Stalled"),r=t.now(),u.call(o,"[buffering] Stream has stalled"))},c=function(n){var a=e.buffered.length,c=!("playing"===n.type||a>0)||("progress"===n.type||"timeupdate"===n.type)&&e.buffered.end(a-1)===s;if(r&&(a||"Edge"===i.browser)&&!c){"progress"===n.type&&(s=e.buffered.end(a-1));var h=t.now()-r;o.recordMetric("Buffering",{uint64:h}),u.call(o,"[buffering] Stream has recovered from stall after [%s] milliseconds",h),r=null}};t.addEventListener(e,"stalled",a),t.addEventListener(e,"pause",a),t.addEventListener(e,"suspend",a),t.addEventListener(e,"play",c),t.addEventListener(e,"playing",c),t.addEventListener(e,"progress",c),t.addEventListener(e,"timeupdate",c);var h=new n.Disposable(function(){t.removeEventListener(e,"stalled",a),t.removeEventListener(e,"pause",a),t.removeEventListener(e,"suspend",a),t.removeEventListener(e,"play",c),t.removeEventListener(e,"playing",c),t.removeEventListener(e,"progress",c),t.removeEventListener(e,"timeupdate",c)});return this.v.add(h),h},a.prototype.recordVideoPlayingAndPausing=function(e){var i=this;if(t.find(this._n,function(t){return t===e}))return new n.Disposable(t.noop);this._n.push(e);var r=function(){e.paused?i.recordMetric("Playing",{boolean:!1}):i.recordMetric("Playing",{boolean:!0})};t.addEventListener(e,"pause",r),t.addEventListener(e,"playing",r);var s=new n.Disposable(function(){t.removeEventListener(e,"pause",r),t.removeEventListener(e,"playing",r)});return this.v.add(s),s},a}.apply(e,i))||(t.exports=r)},function(t,e,n){var i,r;i=[n(0),n(1),n(13),n(2),n(21)],void 0===(r=function(t,e,n,i,r){function s(s){e.lt(s,"uri"),this.Vn="/telemetry/metrics",this.zn="object"==typeof location?location.hostname:i.browser+"-"+i.browserVersion+"-unknown",this.Gn=!0,this.Jn=(i.browser||"Browser")+"/"+(i.browserVersion||"?"),this.Hn=new n.BatchHttpProto(s+this.Vn,[r],"telemetry.SubmitMetricRecords",{maxAttempts:3,maxBufferedRecords:1e3,maxBatchSize:512}),this.Hn.on("capacity",t.bind(o,this))}function o(e){this.Hn.addRecordToBeginning({metric:"MetricDropped",value:{uint64:e},timestamp:t.isoString(),sessionId:this.Kn,streamId:this.Qn,source:this.Jn,fullQualifiedName:this.zn,environment:this.Xn,version:this.Zn,runtime:this.$n})}return s.prototype.isEnabled=function(){return this.Gn},s.prototype.setEnabled=function(t){e.Jt(t,"enabled"),this.Gn=t},s.prototype.submitMetric=function(n,i,r,s,o,a,u){this.Gn&&(e.wt(n,"metric"),e.st(u,"value"),this.$n=i,this.Kn=r,this.Qn=s,this.Xn=o,this.Zn=a,function(e,n){var i=t.assign({},n,{metric:e,timestamp:t.isoString(),sessionId:this.Kn,streamId:this.Qn,source:this.Jn,fullQualifiedName:this.zn,environment:this.Xn,version:this.Zn,runtime:this.$n});this.Hn.addRecord(i)}.call(this,n,u))},s}.apply(e,i))||(t.exports=r)},function(t,e,n){var i,r;i=[n(0),n(1),n(14),n(43)],void 0===(r=function(t,e,n,i){var r={urls:{local:"",staging:"https://telemetry-stg.phenixrts.com",production:"https://telemetry.phenixrts.com"}};function s(){this.Yn={}}return s.prototype.createMetricsTransmitter=function(t){var e=n.parseEnvFromPcastBaseUri(t||""),s=r.urls[e];return this.Yn[e]||(this.Yn[e]=function(t){var e=new i(t);return t||e.setEnabled(!1),e}.call(this,s)),this.Yn[e]},new s}.apply(e,i))||(t.exports=r)},function(t,e,n){var i,r;i=[n(0),n(1),n(2)],void 0===(r=function(t,e,n){"use strict";var i=2e3;function r(t,n,i){e.st(t,"logger"),e.st(n,"screenShareExtensionManager"),i&&e.rt(i,"onScreenShare"),this.ot=t,this.fe=n,this.St=i}function s(r,s,a){var u=this,c=function(t){a(o(t),void 0,t)},h=function(r){(function(r){var s={},o={},a=this;setTimeout(function u(){(function(n){return t.reduce(n.getTracks(),function(t,n){return t&&function(t){return e.ti(t,"track"),"ended"===t.readyState}(n)},!0)})(r)||(t.forEach(r.getTracks(),function(e){if(n.global.Event&&t.hasIndexOrKey(s,e.id)&&s[e.id]!==e.enabled){var i=new n.global.Event("trackenabledchange");i.data=e,e.dispatchEvent(i),a.ot.info("[%s] Detected track [%s] enabled change to [%s]",r.id,e.id,e.enabled)}if(n.global.Event&&t.hasIndexOrKey(o,e.id)&&o[e.id]!==e.readyState){var u=new n.global.Event("readystatechange");u.data=e,e.dispatchEvent(u),a.ot.info("[%s] Detected track [%s] Ready State change to [%s]",r.id,e.id,e.readyState)}s[e.id]=e.enabled,o[e.id]=e.readyState}),setTimeout(u,i))},i)}).call(u,r),s("ok",r)};return function(t,e){var n=this;if(t.screen)return n.fe.isScreenSharingEnabled(function(i){return i?n.fe.getScreenSharingConstraints(t,e):n.fe.installExtension(function(i,r){return i||r&&"ok"!==r.status?e(i,r):n.fe.getScreenSharingConstraints(t,e)})});var i={audio:t.audio||!1,video:t.video||!1};e(null,{status:"ok",constraints:i})}.call(this,r,function(e,i){if("ok"!==t.get(i,["status"]))return c(e);if("cancelled"!==i.status){var s=i.constraints;if(u.St&&(r.screen||r.screenAudio)&&"Chrome"===n.browser&&!(s=u.St(s)))throw new Error("onScreenShare must return an object of user media constraints");try{n.getUserMedia(s,h,c)}catch(t){c(t)}}else a("cancelled",null)})}r.prototype.getUserMedia=function(n,i){e.st(n,"options"),e.rt(i,"callback"),function(e,n){var i=this,r=function(t,e){i.Ne&&i.Ne.push(e),n(i,t,e)},o=function(t,r,s){e.screenAudio&&i.ot.warn("Screen capture with audio is only supported on Windows or Chrome OS."),n(i,t,r,s)},a=e.screen||e.screenAudio,u=e.video||e.audio;return a&&u?s.call(i,{screen:e.screen},function(n,a){return s.call(i,{audio:e.audio,video:e.video},function(e,n){!function(e,n){e&&t.rt(e.addTrack)&&t.forEach(n,function(t){e.addTrack(t)})}(n,a.getTracks()),r(e,n)},function(e,n,i){!function(e){if(e&&t.rt(e.stop)&&e.stop(),e&&t.rt(e.getTracks))for(var n=e.getTracks(),i=0;i<n.length;i++){n[i].stop()}}(a),o(e,n,i)})},o):s.call(i,e,r,o)}.call(this,n,i)};var o=function(t){return"unavailable"===t.code?"conflict":"permission-denied"===t.message?"permission-denied":"PermissionDeniedError"===t.name?"permission-denied":"InternalError"===t.name&&"Starting video failed"===t.message?"conflict":"SourceUnavailableError"===t.name?"conflict":"SecurityError"===t.name&&"The operation is insecure."===t.message?"permission-denied":"failed"};return r}.apply(e,i))||(t.exports=r)},function(t,e,n){var i,r;i=[n(0),n(1),n(7),n(2)],void 0===(r=function(t,e,n,i){"use strict";var r="icngjadgidcmifnehjcielbmiapkhjpn",s=t.freeze({url:"https://addons.mozilla.org/firefox/downloads/file/474686/pcast_screen_sharing-1.0.3-an+fx.xpi",iconUrl:"https://phenixp2p.com/public/images/phenix-logo-unicolor-64x64.png",hash:"sha256:4972e9718ea7f7c896abc12d1a9e664d5f3efe498539b082ab7694f9d7af4f3b"}),o=100,a=450,u=52;function c(o,a){o=o||{},e.st(o,"options"),e.st(a,"logger"),this.ot=a,this.ei=o.screenSharingExtensionId||function(){switch(i.browser){case"Chrome":return r;case"Firefox":default:return""}}(),this.ni=o.screenSharingAddOn||s,this.ii=!1,this.ri=new n.Observable(!1),"Chrome"===i.browser&&this.ei&&function(){var t=l.call(this);if("object"==typeof document){for(var e=document.getElementsByTagName("link"),n=0;n<e.length;n++)if(e[n].href===t)return;this.ot.debug("Adding Chrome Web Store link [%s]",t);var i=document.createElement("link");i.rel="chrome-webstore-item",i.href=t,document.getElementsByTagName("head")[0].appendChild(i)}}.call(this),f.call(this,t.bind(h,this))}function h(t){this.ri.setValue(!0),this.ii=t}function f(e){var n=this;if("Chrome"===i.browser&&n.ei){var r=v.call(this);if(!r)return e(!1);try{r.sendMessage(n.ei,{type:"version"},function(t){t&&"ok"===t.status?(n.ot.info("Screen sharing enabled using version [%s]",t.version),e(!0)):(n.ot.info("Screen sharing NOT available"),e(!1))})}catch(t){t.message&&n.ot.warn(t.message,t),e(!1)}}else"Firefox"===i.browser&&i.browserVersion>=u?e(!0):"Firefox"===i.browser&&t.st(i.global.PCastScreenSharing)?e(!0):e(!1)}function d(t){if(this.ri.getValue())return t();var e=this.ri.subscribe(function(){return e.dispose(),t()})}function l(){return"https://chrome.google.com/webstore/detail/"+this.ei}function p(e,n){switch(i.browser){case"Chrome":return function(t){var e=this,n=v.call(this);if(!n)return t(new Error("not-available"));try{n.sendMessage(e.ei,{type:"get-desktop-media",sources:["screen","window","tab","audio"]},function(n){return!n?f.call(e,function(n){return h.call(e,n),t(new Error("extension-failure"))}):"ok"!==n.status?t(new Error(n.status),n):void t(null,n)})}catch(n){n.message&&e.ot.warn(n.message),t(n,{status:"failed"})}}.call(this,function(i,r){if(i||r&&"ok"!==r.status)return n(i,r);r.data||r.options||(r.options={canRequestAudioTrack:!0}),r.data&&t.hasIndexOrKey(r.data,"hasAudio")&&!r.options&&(r.options={canRequestAudioTrack:r.data.hasAudio}),n(null,{status:"ok",constraints:function(e,n,i){var r={};return t.st(e)&&t.st(e.screen)&&(r.video=e.screen),t.st(e)&&t.st(e.screenAudio)&&i.canRequestAudioTrack&&(r.audio=e.screenAudio),e.screen&&t.set(r,["video","mandatory"],{chromeMediaSource:"desktop",chromeMediaSourceId:n}),e.screenAudio&&i.canRequestAudioTrack&&t.set(r,["audio","mandatory"],{chromeMediaSource:"system",chromeMediaSourceId:n}),r}(e,r.streamId,r.options)})});case"Firefox":n(null,{status:"ok",constraints:function(e,n){var i={video:{}};return t.st(e)&&t.st(e.screen)&&(i.video=e.screen),i.video.mediaSource=i.video.mediaSource||"window",i}(e)});break;default:n(new Error("not-supported"),{status:"not-supported"})}}function m(e){var n=this;if(!n.ii){var r=function(t,i){return"cancelled"===i?e(null,{status:"cancelled"}):"ok"!==i?e(new Error("screen-sharing-installation-failed"),{status:i}):void f.call(n,function(t){if(n.ii=t,!n.ii)return e(new Error("screen-sharing-installation-failed"),{status:i});e(null,{status:"ok"})})};switch(i.browser){case"Chrome":(function(t){var e=this,n=l.call(this);try{chrome.webstore.install(n,function(){return t(null,"ok")},function(n){if(n){if(n.match(/cancelled/gi))return e.ot.info("User cancelled screen sharing"),t(new Error(n),"cancelled");e.ot.warn(n)}return t(new Error(n||"failed"),"failed")})}catch(n){n.message&&e.ot.warn(n.message),t(n,"failed")}}).call(n,r);break;case"Firefox":(function(e){try{var n,r={"PCast Screen Sharing":{URL:this.ni.url,IconURL:this.ni.iconUrl,Hash:this.ni.hash,toString:function(){return this.URL}}},s=a,u=function(){n&&clearInterval(n),e(null,"ok")},c=function(){n&&clearInterval(n),e(new Error("failed"),"failed")};n=setInterval(function(){return t.st(i.global.PCastScreenSharing)?u():s--<0?c():void 0},o),InstallTrigger.install(r,function(t,e){0===e?u():c()})}catch(t){t.message&&this.ot.warn(t.message),e("failed",t)}}).call(n,r);break;default:e(new Error("not-supported"),{status:"not-supported"})}}}function v(){switch(i.browser){case"Chrome":return"undefined"!=typeof chrome&&chrome.runtime&&chrome.runtime.sendMessage?chrome.runtime:(this.ot.info("Screen sharing NOT available. Runtime not supported"),null);case"Firefox":default:return null}}return c.prototype.isScreenSharingEnabled=function(t){var e=this;return d.call(this,function(){return t(e.ii)})},c.prototype.installExtension=function(e){return d.call(this,t.bind(m,this,e))},c.prototype.getScreenSharingConstraints=function(e,n){return d.call(this,t.bind(p,this,e,n))},c.prototype.toString=function(){return"ScreenShareExtensionManager["+i.browser+"]"},c}.apply(e,i))||(t.exports=r)},function(t,e,n){var i,r;i=[n(0),n(1),n(6),n(3)],void 0===(r=function(t,e,n,i){"use strict";function r(t,n,r,s){e.st(t,"logger"),e.wt(n,"version"),e.rt(r,"onClosestEndpointFound"),s&&e.rt(s,"onAnEndpointResolved"),this.ot=t,this.tt=n,this.si=r,s&&(this.oi=s),this.ai=!1,this.ui=Number.MAX_VALUE,this.ci="",this.v=new i.DisposableList}return r.prototype.isResolved=function(){return this.ai},r.prototype.dispose=function(){this.v.dispose()},r.prototype.measurementCallback=function(t,e,n){return e<this.ui&&(this.ot.info("Current closest end point is [%s] with latency of [%s] ms",n,e),this.ui=e,this.ci=n),this.isResolved()},r.prototype.completeCallback=function(t){if(this.ci&&this.ui<Number.MAX_VALUE&&!this.isResolved())return this.ai=!0,this.si(null,{uri:this.ci,roundTripTime:this.ui})},r.prototype.resolveAll=function(t){for(var e=0;e<t.length;e++)this.resolve(t[e],4)},r.prototype.resolve=function(e,i){var r=this,s=1,o=0;!function e(a){var u=t.now();r.ot.info("[%s] Checking end point [%s]",s,a);var c=n.getWithRetry(a,{timeout:15e3,queryParameters:{version:r.tt,_:t.now()},retryOptions:{maxAttempts:1}},function(n,c){var h=t.now()-u,f=h>30;if(r.oi&&(n?r.oi(n):r.oi(null,{time:h,endPoint:a})),s++,!n){if(r.measurementCallback(a,h,c.data))return;o++}return s<=i&&!r.isResolved()&&(f||n)?(n&&r.ot.info("Retrying after failure to resolve end point [%s] with [%s]",a,n),e(a)):0===o?r.ot.warn("Unable to resolve end point [%s] with [%s]",a,n):r.completeCallback(a)});r.v.add(c)}(e)},r}.apply(e,i))||(t.exports=r)},function(t,e,n){var i,r;i=[n(47)],void 0===(r=function(t){return t}.apply(e,i))||(t.exports=r)},function(t,e,n){var i,r;i=[n(1),n(0),n(6),n(3),n(48)],void 0===(r=function(t,e,n,i,r){"use strict";function s(e,n,r,s){t.wt(e,"version"),t.wt(n,"baseUri"),t.st(r,"logger"),this.tt=e,this.ue=n,this.ot=r,this.v=new i.DisposableList,this.qe=s}return s.DefaultPCastUri="https://pcast.phenixrts.com",s.prototype.getBaseUri=function(){return this.ue},s.prototype.resolveUri=function(t){return function(t,i){if(0===t.lastIndexOf("wss:",0))i(void 0,{uri:t+"/ws",roundTripTime:0});else if(0===t.lastIndexOf("https:",0)){var s=this;(function(t,i){var r=n.getWithRetry(t+"/pcast/endPoints",{timeout:15e3,queryParameters:{version:"2018-09-17T15:08:57Z",_:e.now()},retryOptions:{maxAttempts:4}},function(t,e){if(t)return i(new Error("Failed to resolve an end point",t));var n=e.data.split(",");n.length<1&&i(new Error("Failed to discover end points")),i(void 0,n)});this.v.add(r)}).call(s,t,function(t,e){if(t)return i(t);var n=new r(s.ot,s.tt,i,function(t,e){t?s.ot.warn("An error occured in resolving an endpoint",t):s.qe.recordMetric("RoundTripTime",{uint64:e.time},null,{resource:e.endPoint,kind:"https"})});n.resolveAll(e),s.v.add(n)})}else i(new Error("Uri not supported"))}.call(this,this.ue,t)},s.prototype.dispose=function(){this.v.dispose()},s.prototype.toString=function(){return"PCastEndPoint["+this.ue+"]"},s}.apply(e,i))||(t.exports=r)},function(t,e,n){var i;void 0===(i=function(){"use strict";return{package:"shim",messages:[]}}.apply(e,[]))||(t.exports=i)},function(t,e,n){var i;void 0===(i=function(){"use strict";return{package:"pcast",options:{optimize_for:"LITE_RUNTIME"},messages:[{name:"Authenticate",fields:[{rule:"optional",type:"uint32",name:"apiVersion",id:9,options:{default:0}},{rule:"required",type:"string",name:"clientVersion",id:1},{rule:"optional",type:"string",name:"device",id:12},{rule:"required",type:"string",name:"deviceId",id:2},{rule:"optional",type:"string",name:"manufacturer",id:13},{rule:"required",type:"string",name:"platform",id:3},{rule:"required",type:"string",name:"platformVersion",id:4},{rule:"required",type:"string",name:"authenticationToken",id:5},{rule:"optional",type:"string",name:"connectionId",id:6},{rule:"optional",type:"string",name:"connectionRouteKey",id:10},{rule:"optional",type:"string",name:"remoteAddress",id:11},{rule:"optional",type:"string",name:"sessionId",id:7},{rule:"optional",type:"string",name:"applicationId",id:8}]},{name:"AuthenticateResponse",fields:[{rule:"required",type:"string",name:"status",id:1},{rule:"optional",type:"string",name:"sessionId",id:2},{rule:"optional",type:"string",name:"redirect",id:3},{rule:"repeated",type:"string",name:"roles",id:4}]},{name:"Bye",fields:[{rule:"required",type:"string",name:"sessionId",id:1},{rule:"required",type:"string",name:"reason",id:2}]},{name:"ByeResponse",fields:[{rule:"required",type:"string",name:"status",id:1}]},{name:"SessionDescription",fields:[{rule:"required",type:"Type",name:"type",id:1,options:{default:"Offer"}},{rule:"required",type:"string",name:"sdp",id:2}],enums:[{name:"Type",values:[{name:"Offer",id:0},{name:"Answer",id:1}]}]},{name:"CreateStream",fields:[{rule:"required",type:"string",name:"sessionId",id:1},{rule:"optional",type:"string",name:"originStreamId",id:2},{rule:"repeated",type:"string",name:"originStreamIds",id:10},{rule:"repeated",type:"string",name:"options",id:3},{rule:"optional",type:"string",name:"connectUri",id:8},{rule:"repeated",type:"string",name:"connectOptions",id:9},{rule:"repeated",type:"string",name:"tags",id:4},{rule:"optional",type:"string",name:"userAgent",id:11},{rule:"optional",type:"SetRemoteDescription",name:"setRemoteDescription",id:5},{rule:"optional",type:"CreateOfferDescription",name:"createOfferDescription",id:6},{rule:"optional",type:"CreateAnswerDescription",name:"createAnswerDescription",id:7}]},{name:"IceServer",fields:[{rule:"repeated",type:"string",name:"urls",id:1},{rule:"optional",type:"string",name:"username",id:2},{rule:"optional",type:"string",name:"credential",id:3}]},{name:"RtcConfiguration",fields:[{rule:"optional",type:"BundlePolicy",name:"bundlePolicy",id:1},{rule:"optional",type:"uint32",name:"iceCandidatePoolSize",id:3},{rule:"repeated",type:"IceServer",name:"iceServers",id:4},{rule:"optional",type:"IceTransportPolicy",name:"iceTransportPolicy",id:5},{rule:"optional",type:"string",name:"peerIdentity",id:6},{rule:"optional",type:"RtcpMuxPolicy",name:"rtcpMuxPolicy",id:7}],enums:[{name:"BundlePolicy",values:[{name:"BundlePolicyBalanced",id:1},{name:"BundlePolicyMaxCompat",id:2},{name:"BundlePolicyMaxBundle",id:3}]},{name:"IceTransportPolicy",values:[{name:"IceTransportPolicyAll",id:1},{name:"IceTransportPolicyPublic",id:2},{name:"IceTransportPolicyRelay",id:3}]},{name:"RtcpMuxPolicy",values:[{name:"RtcpMuxPolicyNegotiate",id:1},{name:"RtcpMuxPolicyRequire",id:2}]}]},{name:"CreateStreamResponse",fields:[{rule:"required",type:"string",name:"status",id:1},{rule:"optional",type:"string",name:"streamId",id:2},{rule:"optional",type:"string",name:"instanceRouteKey",id:5},{rule:"repeated",type:"string",name:"streamUris",id:8},{rule:"optional",type:"RtcConfiguration",name:"rtcConfiguration",id:9},{rule:"optional",type:"SetRemoteDescriptionResponse",name:"setRemoteDescriptionResponse",id:3},{rule:"optional",type:"CreateOfferDescriptionResponse",name:"createOfferDescriptionResponse",id:4},{rule:"optional",type:"CreateAnswerDescriptionResponse",name:"createAnswerDescriptionResponse",id:6},{rule:"repeated",type:"string",name:"options",id:7},{rule:"optional",type:"uint64",name:"offset",id:10,options:{default:0}}]},{name:"SetLocalDescription",fields:[{rule:"required",type:"string",name:"streamId",id:1},{rule:"required",type:"SessionDescription",name:"sessionDescription",id:2},{rule:"optional",type:"uint32",name:"apiVersion",id:3,options:{default:0}}]},{name:"SetLocalDescriptionResponse",fields:[{rule:"required",type:"string",name:"status",id:1},{rule:"repeated",type:"string",name:"options",id:2}]},{name:"SetRemoteDescription",fields:[{rule:"required",type:"string",name:"streamId",id:1},{rule:"required",type:"SessionDescription",name:"sessionDescription",id:2},{rule:"optional",type:"uint32",name:"apiVersion",id:3,options:{default:0}}]},{name:"SetRemoteDescriptionResponse",fields:[{rule:"required",type:"string",name:"status",id:1},{rule:"optional",type:"SessionDescription",name:"sessionDescription",id:2},{rule:"repeated",type:"string",name:"options",id:3}]},{name:"CreateOfferDescription",fields:[{rule:"required",type:"string",name:"streamId",id:1},{rule:"repeated",type:"string",name:"options",id:2},{rule:"optional",type:"uint32",name:"apiVersion",id:3,options:{default:0}}]},{name:"CreateOfferDescriptionResponse",fields:[{rule:"required",type:"string",name:"status",id:1},{rule:"optional",type:"SessionDescription",name:"sessionDescription",id:2},{rule:"repeated",type:"string",name:"options",id:3}]},{name:"CreateAnswerDescription",fields:[{rule:"required",type:"string",name:"streamId",id:1},{rule:"repeated",type:"string",name:"options",id:2},{rule:"optional",type:"uint32",name:"apiVersion",id:3,options:{default:0}}]},{name:"CreateAnswerDescriptionResponse",fields:[{rule:"required",type:"string",name:"status",id:1},{rule:"optional",type:"SessionDescription",name:"sessionDescription",id:2},{rule:"repeated",type:"string",name:"options",id:3}]},{name:"IceCandidate",fields:[{rule:"required",type:"string",name:"candidate",id:1},{rule:"required",type:"uint32",name:"sdpMLineIndex",id:2},{rule:"required",type:"string",name:"sdpMid",id:3}]},{name:"AddIceCandidates",fields:[{rule:"required",type:"string",name:"streamId",id:1},{rule:"repeated",type:"IceCandidate",name:"candidates",id:2},{rule:"repeated",type:"string",name:"options",id:3},{rule:"optional",type:"uint32",name:"apiVersion",id:4,options:{default:0}}]},{name:"AddIceCandidatesResponse",fields:[{rule:"required",type:"string",name:"status",id:1},{rule:"repeated",type:"string",name:"options",id:2}]},{name:"UpdateStreamState",fields:[{rule:"required",type:"string",name:"streamId",id:1},{rule:"required",type:"string",name:"signalingState",id:2},{rule:"required",type:"string",name:"iceGatheringState",id:3},{rule:"required",type:"string",name:"iceConnectionState",id:4},{rule:"optional",type:"uint32",name:"apiVersion",id:5,options:{default:0}}]},{name:"UpdateStreamStateResponse",fields:[{rule:"required",type:"string",name:"status",id:1},{rule:"repeated",type:"string",name:"options",id:2}]},{name:"DestroyStream",fields:[{rule:"required",type:"string",name:"streamId",id:1},{rule:"optional",type:"string",name:"reason",id:2},{rule:"repeated",type:"string",name:"options",id:3}]},{name:"DestroyStreamResponse",fields:[{rule:"required",type:"string",name:"status",id:1}]},{name:"ConnectionDisconnected",fields:[{rule:"required",type:"string",name:"connectionId",id:1},{rule:"required",type:"uint32",name:"reasonCode",id:2},{rule:"optional",type:"string",name:"description",id:3}]},{name:"ConnectionDisconnectedResponse",fields:[{rule:"required",type:"string",name:"status",id:1}]},{name:"StreamStarted",fields:[{rule:"required",type:"string",name:"sessionId",id:1},{rule:"required",type:"string",name:"streamId",id:2},{rule:"repeated",type:"string",name:"tags",id:3}]},{name:"SourceStreamStarted",fields:[{rule:"required",type:"string",name:"sessionId",id:1},{rule:"required",type:"string",name:"streamId",id:2},{rule:"repeated",type:"string",name:"capabilities",id:3},{rule:"repeated",type:"string",name:"tags",id:4}]},{name:"StreamEnded",fields:[{rule:"required",type:"string",name:"sessionId",id:1},{rule:"required",type:"string",name:"streamId",id:2},{rule:"required",type:"string",name:"reason",id:3},{rule:"repeated",type:"string",name:"tags",id:4},{rule:"optional",type:"string",name:"continuationId",id:5},{rule:"optional",type:"string",name:"routeKey",id:6}]},{name:"SourceStreamEnded",fields:[{rule:"required",type:"string",name:"sessionId",id:1},{rule:"required",type:"string",name:"streamId",id:2},{rule:"required",type:"string",name:"reason",id:3},{rule:"repeated",type:"string",name:"capabilities",id:4},{rule:"repeated",type:"string",name:"tags",id:5}]},{name:"StreamEndedResponse",fields:[{rule:"required",type:"string",name:"status",id:1},{rule:"optional",type:"string",name:"continuationId",id:2},{rule:"optional",type:"string",name:"routeKey",id:3}]},{name:"StreamIdle",fields:[{rule:"required",type:"string",name:"sessionId",id:1},{rule:"required",type:"string",name:"streamId",id:2},{rule:"repeated",type:"string",name:"options",id:3},{rule:"repeated",type:"string",name:"tags",id:4}]},{name:"StreamArchived",fields:[{rule:"required",type:"string",name:"sessionId",id:1},{rule:"required",type:"string",name:"streamId",id:2},{rule:"required",type:"uint64",name:"startTime",id:4},{rule:"required",type:"string",name:"uri",id:3}]},{name:"SessionEnded",fields:[{rule:"required",type:"string",name:"sessionId",id:1},{rule:"required",type:"string",name:"reason",id:2},{rule:"required",type:"float",name:"duration",id:3}]},{name:"ResourceIdle",fields:[{rule:"required",type:"string",name:"sessionId",id:1},{rule:"required",type:"string",name:"routeKey",id:2}]},{name:"ResourceIdleResponse",fields:[{rule:"required",type:"string",name:"status",id:1}]},{name:"StreamPlaylist",fields:[{rule:"required",type:"string",name:"sessionId",id:1},{rule:"required",type:"string",name:"streamId",id:2},{rule:"required",type:"PlaylistType",name:"playlistType",id:3},{rule:"required",type:"string",name:"uri",id:4},{rule:"required",type:"bool",name:"isVariant",id:5,options:{default:!0}}],enums:[{name:"PlaylistType",values:[{name:"Live",id:0},{name:"OnDemand",id:1}]}]},{name:"StreamRtmp",fields:[{rule:"required",type:"string",name:"streamId",id:1},{rule:"required",type:"string",name:"uri",id:2},{rule:"required",type:"uint32",name:"height",id:3},{rule:"required",type:"uint32",name:"bitrate",id:4}]},{name:"SendEventToClient",fields:[{rule:"required",type:"string",name:"connectionId",id:1},{rule:"required",type:"string",name:"type",id:2},{rule:"required",type:"bytes",name:"payload",id:3}]},{name:"SendEventToClientResponse",fields:[{rule:"required",type:"string",name:"status",id:1}]},{name:"SendRequestToClient",fields:[{rule:"required",type:"string",name:"connectionId",id:1},{rule:"required",type:"string",name:"type",id:2},{rule:"required",type:"bytes",name:"payload",id:3}]},{name:"SendRequestToClientResponse",fields:[{rule:"required",type:"string",name:"status",id:1},{rule:"optional",type:"string",name:"type",id:2},{rule:"optional",type:"bytes",name:"payload",id:3}]},{name:"SetupStream",fields:[{rule:"required",type:"string",name:"streamToken",id:1},{rule:"required",type:"CreateStream",name:"createStream",id:2}]},{name:"SetupStreamResponse",fields:[{rule:"required",type:"string",name:"status",id:1},{rule:"optional",type:"CreateStreamResponse",name:"createStreamResponse",id:2}]},{name:"SetupPlaylistStream",fields:[{rule:"required",type:"string",name:"sessionId",id:1},{rule:"required",type:"string",name:"streamToken",id:2},{rule:"repeated",type:"string",name:"options",id:3},{rule:"repeated",type:"string",name:"tags",id:4}]},{name:"PlaylistStreamManifest",fields:[{rule:"required",type:"string",name:"manifest",id:1},{rule:"required",type:"bool",name:"isProtectedContent",id:2},{rule:"optional",type:"string",name:"drmToken",id:3}]},{name:"SetupPlaylistStreamResponse",fields:[{rule:"required",type:"string",name:"status",id:1},{rule:"repeated",type:"PlaylistStreamManifest",name:"manifests",id:2},{rule:"optional",type:"uint64",name:"offset",id:3,options:{default:0}}]},{name:"StreamDataQuality",fields:[{rule:"required",type:"string",name:"sessionId",id:1},{rule:"required",type:"string",name:"streamId",id:2},{rule:"required",type:"uint64",name:"timestamp",id:3},{rule:"required",type:"DataQualityStatus",name:"status",id:4},{rule:"required",type:"DataQualityReason",name:"reason",id:5}],enums:[{name:"DataQualityStatus",values:[{name:"NoData",id:0},{name:"AudioOnly",id:1},{name:"All",id:2}]},{name:"DataQualityReason",values:[{name:"None",id:0},{name:"UploadLimited",id:1},{name:"DownloadLimited",id:2},{name:"PublisherLimited",id:3},{name:"NetworkLimited",id:4}]}]},{name:"StreamDataQualityResponse",fields:[{rule:"required",type:"string",name:"status",id:1}]},{name:"CallbackEvent",fields:[{rule:"optional",type:"uint32",name:"apiVersion",id:1,options:{default:0}},{rule:"required",type:"string",name:"entity",id:2},{rule:"required",type:"string",name:"what",id:3},{rule:"required",type:"string",name:"data",id:4},{rule:"optional",type:"string",name:"sessionId",id:5}]},{name:"Uri",fields:[{rule:"optional",type:"string",name:"protocol",id:1,options:{default:"http"}},{rule:"required",type:"string",name:"host",id:2},{rule:"optional",type:"uint32",name:"port",id:3,options:{default:80}},{rule:"optional",type:"string",name:"method",id:4,options:{default:"POST"}},{rule:"optional",type:"string",name:"path",id:5,options:{default:"/"}}]},{name:"SetApplicationCallback",fields:[{rule:"required",type:"string",name:"applicationId",id:1},{rule:"required",type:"string",name:"secret",id:2},{rule:"required",type:"Uri",name:"callback",id:3}]},{name:"SetApplicationCallbackResponse",fields:[{rule:"required",type:"string",name:"status",id:1},{rule:"optional",type:"string",name:"endpoint",id:2}]},{name:"IssueAuthenticationToken",fields:[{rule:"required",type:"string",name:"applicationId",id:1},{rule:"required",type:"string",name:"secret",id:2},{rule:"repeated",type:"string",name:"capabilities",id:3}]},{name:"IssueAuthenticationTokenResponse",fields:[{rule:"required",type:"string",name:"status",id:1},{rule:"optional",type:"string",name:"authenticationToken",id:2}]},{name:"IssueStreamToken",fields:[{rule:"required",type:"string",name:"applicationId",id:1},{rule:"required",type:"string",name:"secret",id:2},{rule:"required",type:"string",name:"sessionId",id:3},{rule:"optional",type:"string",name:"originStreamId",id:4},{rule:"repeated",type:"string",name:"alternateOriginStreamIds",id:6},{rule:"repeated",type:"string",name:"capabilities",id:5},{rule:"optional",type:"bool",name:"permissive",id:7,options:{default:!1}}]},{name:"IssueStreamTokenResponse",fields:[{rule:"required",type:"string",name:"status",id:1},{rule:"optional",type:"string",name:"streamToken",id:2}]},{name:"IssueDrmToken",fields:[{rule:"required",type:"string",name:"applicationId",id:1},{rule:"required",type:"string",name:"secret",id:2},{rule:"optional",type:"string",name:"sessionId",id:3},{rule:"required",type:"string",name:"originStreamId",id:4},{rule:"repeated",type:"string",name:"capabilities",id:5}]},{name:"IssueDrmTokenResponse",fields:[{rule:"required",type:"string",name:"status",id:1},{rule:"optional",type:"string",name:"drmToken",id:2}]},{name:"TerminateStream",fields:[{rule:"required",type:"string",name:"applicationId",id:1},{rule:"required",type:"string",name:"secret",id:2},{rule:"optional",type:"string",name:"streamId",id:3,oneof:"streamOrToken"},{rule:"optional",type:"string",name:"streamToken",id:5,oneof:"streamOrToken"},{rule:"optional",type:"string",name:"reason",id:4}],oneofs:{streamOrToken:[3,5]}},{name:"TerminateStreamResponse",fields:[{rule:"required",type:"string",name:"status",id:1}]},{name:"DeleteStream",fields:[{rule:"required",type:"string",name:"applicationId",id:1},{rule:"required",type:"string",name:"secret",id:2},{rule:"optional",type:"string",name:"streamId",id:3,oneof:"streamOrToken"},{rule:"optional",type:"string",name:"streamToken",id:5,oneof:"streamOrToken"},{rule:"optional",type:"string",name:"reason",id:4}],oneofs:{streamOrToken:[3,5]}},{name:"DeleteStreamResponse",fields:[{rule:"required",type:"string",name:"status",id:1}]},{name:"Stream",fields:[{rule:"required",type:"string",name:"streamId",id:1}]},{name:"ListStreams",fields:[{rule:"required",type:"string",name:"applicationId",id:1},{rule:"required",type:"string",name:"secret",id:2},{rule:"optional",type:"string",name:"start",id:3},{rule:"required",type:"uint32",name:"length",id:4},{rule:"repeated",type:"string",name:"options",id:5}]},{name:"ListStreamsResponse",fields:[{rule:"required",type:"string",name:"status",id:1},{rule:"optional",type:"string",name:"start",id:2},{rule:"optional",type:"uint32",name:"length",id:3},{rule:"repeated",type:"Stream",name:"streams",id:4}]},{name:"GetPlaylistUris",fields:[{rule:"required",type:"string",name:"applicationId",id:1},{rule:"required",type:"string",name:"secret",id:2},{rule:"required",type:"string",name:"streamId",id:3},{rule:"repeated",type:"string",name:"options",id:4}]},{name:"GetPlaylistUrisResponse",fields:[{rule:"required",type:"string",name:"status",id:1},{rule:"repeated",type:"Playlist",name:"playlists",id:2},{rule:"optional",type:"StreamMetadata",name:"streamInfo",id:3}],messages:[{name:"PlaylistMetadata",fields:[{rule:"optional",type:"uint32",name:"bitrate",id:1},{rule:"optional",type:"uint32",name:"height",id:2},{rule:"optional",type:"float",name:"framesPerSecond",id:3}]},{name:"StreamMetadata",fields:[{rule:"required",type:"string",name:"startTime",id:1},{rule:"optional",type:"string",name:"endTime",id:2}]},{name:"Playlist",fields:[{rule:"required",type:"string",name:"name",id:1},{rule:"required",type:"PlaylistType",name:"type",id:2},{rule:"required",type:"string",name:"uri",id:3},{rule:"required",type:"bool",name:"isVariant",id:4},{rule:"required",type:"bool",name:"isProtected",id:5},{rule:"required",type:"PlaylistMetadata",name:"info",id:6}]}],enums:[{name:"PlaylistType",values:[{name:"Hls",id:0},{name:"Dash",id:1}]}]}]}}.apply(e,[]))||(t.exports=i)},function(t,e,n){var i,r;i=[n(0),n(1),n(7),n(13),n(2),n(51),n(50)],void 0===(r=function(t,e,n,i,r,s,o){"use strict";var a=5;function u(t,r,u,c){e.wt(t,"uri"),e.lt(r,"deviceId"),e.wt(u,"version"),e.st(c,"logger"),this.ce=r,this.tt=u,this.ot=c,this.hi=new i.MQWebSocket(t,this.ot,[s,o],a),this.fi=new n.Observable(null).extend({rateLimit:0})}return u.prototype.onEvent=function(t,e){return this.hi.onEvent(t,e)},u.prototype.disconnect=function(){return this.fi.setValue(null),this.hi.disconnect()},u.prototype.authenticate=function(t,n){e.wt(t,"authToken"),e.rt(n,"callback");var i={apiVersion:this.hi.getApiVersion(),clientVersion:this.tt,deviceId:this.ce,platform:r.browser,platformVersion:r.browserVersion.toString(),authenticationToken:t};this.getSessionId()&&(i.sessionId=this.getSessionId());var s=this;return this.hi.sendRequest("pcast.Authenticate",i,function(t,e){if(e){var i=s.fi.getValue();i&&i!==e.sessionId&&s.hi.disposeOfPendingRequests(),s.fi.setValue(e.sessionId)}return n(t,e)})},u.prototype.getSessionId=function(){return this.fi.getValue()},u.prototype.getObservableSessionId=function(){return this.fi},u.prototype.bye=function(t,n){e.wt(t,"reason"),e.rt(n,"callback");var i={sessionId:this.getSessionId(),reason:t};return this.hi.sendRequest("pcast.Bye",i,n)},u.prototype.setupStream=function(n,i,s,o,a){e.wt(n,"streamType"),e.wt(i,"streamToken"),e.st(s,"options"),e.rt(a,"callback");var u=r.browser||"UnknownBrowser",c=u+"-"+(r.browserVersion||0),h="rtt[http]="+o,f={streamToken:i,createStream:{sessionId:this.getSessionId(),options:["data-quality-notifications",h],connectUri:s.connectUri,connectOptions:s.connectOptions||[],tags:s.tags||[],userAgent:t.get(r,["global","navigator","userAgent"],c)}};return s.negotiate&&(f.createStream.createOfferDescription={streamId:"",options:[n,u,c],apiVersion:this.hi.getApiVersion()},"undefined"!=typeof screen&&f.createStream.createOfferDescription.options.push("screen="+screen.width+"x"+screen.height)),!1===s.receiveAudio&&f.createStream.options.push("no-audio"),!1===s.receiveVideo&&f.createStream.options.push("no-video"),this.hi.sendRequest("pcast.SetupStream",f,a)},u.prototype.setAnswerDescription=function(t,n,i){e.wt(t,"streamId"),e.wt(n,"sdp"),e.rt(i,"callback");var r={streamId:t,sessionDescription:{type:"Answer",sdp:n},apiVersion:this.hi.getApiVersion()};return this.hi.sendRequest("pcast.SetRemoteDescription",r,i)},u.prototype.addIceCandidates=function(n,i,r,s){e.wt(n,"streamId"),e.isArray(i,"candidates"),e.st(r,"options"),e.rt(s,"callback");var o={streamId:n,candidates:t.map(i,function(t,n){return e.wt(t.candidate,"candidate["+n+"].candidate"),e.Dt(t.sdpMLineIndex,"candidate["+n+"].sdpMLineIndex"),e.wt(t.sdpMid,"candidate["+n+"].sdpMid"),{candidate:t.candidate,sdpMLineIndex:t.sdpMLineIndex,sdpMid:t.sdpMid}}),options:r,apiVersion:this.hi.getApiVersion()};return this.hi.sendRequest("pcast.AddIceCandidates",o,s)},u.prototype.updateStreamState=function(t,n,i,r,s){e.wt(t,"streamId"),e.wt(n,"signalingState"),e.wt(i,"iceGatheringState"),e.wt(r,"iceConnectionState"),e.rt(s,"callback");var o={streamId:t,signalingState:n,iceGatheringState:i,iceConnectionState:r,apiVersion:this.hi.getApiVersion()};return this.hi.sendRequest("pcast.UpdateStreamState",o,s)},u.prototype.destroyStream=function(t,n,i){e.wt(t,"streamId"),e.lt(n,"reason"),e.rt(i,"callback");var r={streamId:t,reason:n};return this.hi.sendRequest("pcast.DestroyStream",r,i)},u.prototype.getRoomInfo=function(t,n,i){t?e.lt(t,"roomId"):e.lt(n,"alias"),e.rt(i,"callback");var r={roomId:t,alias:n,sessionId:this.getSessionId()};return this.hi.sendRequest("chat.GetRoomInfo",r,i)},u.prototype.createRoom=function(t,n){e.st(t,"room"),e.wt(t.name,"room.name"),e.wt(t.type,"room.type"),e.wt(t.description,"room.description"),e.rt(n,"callback");var i={sessionId:this.getSessionId(),room:t};return this.hi.sendRequest("chat.CreateRoom",i,n)},u.prototype.enterRoom=function(t,n,i,r,s){t?e.lt(t,"roomId"):e.lt(n,"alias"),e.st(i,"member"),e.Dt(r,"timestamp"),e.rt(s,"callback");var o={roomId:t,alias:n,sessionId:this.getSessionId(),member:i,timestamp:r};return this.hi.sendRequest("chat.JoinRoom",o,s)},u.prototype.leaveRoom=function(t,n,i){e.lt(t,"roomId"),e.Dt(n,"timestamp"),e.rt(i,"callback");var r={roomId:t,sessionId:this.getSessionId(),timestamp:n};return this.hi.sendRequest("chat.LeaveRoom",r,i)},u.prototype.updateMember=function(t,n,i,r){e.wt(t,"roomId"),e.st(n,"member"),e.Dt(i,"timestamp"),e.rt(r,"callback"),n.updateStreams=n.hasOwnProperty("streams");var s={sessionId:this.getSessionId(),roomId:t,member:n,timestamp:i};return this.hi.sendRequest("chat.UpdateMember",s,r)},u.prototype.updateRoom=function(t,n,i){e.st(t,"room"),e.Dt(n,"timestamp"),e.rt(i,"callback");var r={sessionId:this.getSessionId(),room:t,timestamp:n};return this.hi.sendRequest("chat.UpdateRoom",r,i)},u.prototype.sendMessageToRoom=function(t,n,i){e.wt(t,"roomId"),e.st(n,"chatMessage");var r={roomId:t,chatMessage:n};return this.hi.sendRequest("chat.SendMessageToRoom",r,i)},u.prototype.subscribeToRoomConversation=function(t,n,i,r){e.wt(t,"sessionId"),e.wt(n,"roomId"),e.Dt(i,"batchSize");var s={sessionId:t,roomId:n,limit:i,options:["Subscribe"]};return this.hi.sendRequest("chat.FetchRoomConversation",s,r)},u.prototype.getMessages=function(t,n,i,r,s,o){e.wt(t,"sessionId"),e.wt(n,"roomId"),s&&r||e.Dt(i,"batchSize");var a={sessionId:t,roomId:n,limit:i||0,options:[]};return s&&(e.wt(s,"beforeMessageId"),a.beforeMessageId=s),r&&(e.wt(r,"afterMessageId"),a.afterMessageId=r),this.hi.sendRequest("chat.FetchRoomConversation",a,o)},u.prototype.toString=function(){return"PCastProtocol["+this.hi.toString()+"]"},u}.apply(e,i))||(t.exports=r)},function(t,e,n){var i,r;i=[n(2)],void 0===(r=function(t){"use strict";function e(){this.init()}return e.prototype.init=function(){if(!t.global.AudioContext&&!t.global.webkitAudioContext)throw new Error("Browser does not support AudioContext");this.di=new(t.global.AudioContext||t.global.webkitAudioContext)},e.prototype.getNativeAudioContext=function(){return this.di},e.prototype.toString=function(){return"AudioContext"},e}.apply(e,i))||(t.exports=r)},function(t,e,n){var i,r;i=[n(1),n(9)],void 0===(r=function(t,e){"use strict";return{toString:function(t){var e=0,n=t.length,i=[],r=[];if(e===n)return"";for(;e<n;)i.push(t[e++]),i.length>=1024&&(r.push(String.fromCharCode.apply(String,i)),i=[]);return r.join("")+String.fromCharCode.apply(String,i)},toByteArray:function(n){t.lt(n,"data");for(var i,r=0,s=new e.Uint8Array(n.length);r<n.length;){if((i=n.charCodeAt(r))>255)throw RangeError("illegal char code: "+i);s[r++]=i}return s}}}.apply(e,i))||(t.exports=r)},function(t,e,n){var i,r;i=[n(0),n(1),n(3)],void 0===(r=function(t,e,n){"use strict";var i=1,r=2,s=1500,o={clientAborted:{id:4e3,name:"Aborted by Client"}};function a(){}function u(e,n,i,r,s){h(r=r||{});var o=d(e,f(r.queryParameters||{},n)),a=t.bind(v,this,t.now(),s);if(!o)return s(l());r.responseType&&(o.responseType=r.responseType),p(o,r),o.addEventListener("readystatechange",t.bind(m,this,o,r,a)),o.timeout=r.timeout||15e3,o.send(i)}function c(e,n,i,r,s){var o=t.bind(e,this,n,i,r),a={startTime:t.now(),isDisposed:!1};return g.call(this,n,r,o,a,s)}function h(n){e.st(n,"settings"),n.queryParameters&&e.st(n.queryParameters,"settings.queryParameters"),n.mimeType&&e.it(n.mimeType,"settings.mimeType"),n.accept&&e.it(n.accept,"settings.accept"),n.contentType&&e.it(n.contentType,"settings.contentType"),n.responseType&&e.it(n.responseType,"settings.responseType"),t.isNullOrUndefined(n.timeout)||e.Dt(n.timeout,"settings.timeout")}function f(e,n){var i=n.lastIndexOf("#"),r=n.indexOf("?"),s=t.reduce(e,function(t,e,n){return(t+=t?"&":"")+n.toString()+"="+e.toString()},""),o=-1===i?"":n.substring(i+1),a=-1===r?"":n.substring(r+1,o?i:n.length),u=s+(a?"&"+a:"");return n=n.replace("?"+a,"").replace("#"+o,""),u&&(n+="?"+u),o&&(n+="#"+o),n}function d(t,e){var n=new XMLHttpRequest;if("withCredentials"in n)n.open(t,e,!0);else{if("undefined"==typeof XDomainRequest)return;(n=new XDomainRequest).open(t,e)}return n}function l(){var t=new Error("unsupported");return t.code="unsupported",t}function p(e,n){var i=n.contentType||"application/json",r=n.accept||i,s=t.assign({},{"Content-Type":i,Accept:r},t.get(n,["headers"],{}));t.forOwn(s,function(t,n){e.setRequestHeader(n,t)})}function m(n,i,r){if(4===n.readyState)if(200===n.status){var s=function(e){var n=e.getAllResponseHeaders();return t.reduce(n.trim().split(/[\r\n]+/),function(t,e){var n=e.split(": "),i=n.shift(),r=n.join(": ");return i&&(t[i]=r),t},{})}(n);r(null,{data:n.response||n.responseText,headers:s,rawXhr:n})}else{var o=new Error(0===n.status?"timeout":n.statusText),a=t.get(i,["retryOptions","additionalRetryErrorCodes"],[]);t.forEach(a,function(t){e.Dt(t,"additionalRetryErrorCode")}),o.code=n.status,(n.status>=500&&n.status<600||t.includes(a,n.status))&&(o.retryable=!0),r(o)}}function v(e,n,i,r){r&&t.set(r,["stats","successResponseTime"],t.now()-e),n(i,r)}function g(e,a,u,c,h,f){f=f||1;var d=this,l=t.get(a,["delay"],null),p=t.get(a,["retryOptions","delay"],s),m=t.get(a,["retryOptions","backoff"],r),v=t.get(a,["retryOptions","maxAttempts"],i),w=f>1?p*Math.pow(f,m):l,b=function(n,i){return c.isDisposed?h(y(o.clientAborted)):n&&n.retryable&&f<v?g.call(d,e,a,u,c,h,f+1):function(e,n,i,r,s){s&&(t.set(s,["stats","totalResponseTimeForAllAttempts"],t.now()-e),t.set(s,["stats","attempts"],n)),i(r,s)}.call(d,c.startTime,f,h,n,i)},k=new n.Disposable(function(){t.Dt(c.mostRecentTimeout)&&clearTimeout(c.mostRecentTimeout),c.isDisposed=!0});return!t.Dt(l)&&1===f||t.get(a,["retryOptions","sync"],!1)?(u.call(d,b),k):(function(t,e,n,i,r,s){var a=this;i.mostRecentTimeout=setTimeout(function(){if(i.isDisposed)return s(y(o.clientAborted));n.call(a,s)},r)}.call(d,e,a,u,c,w,b),k)}function y(t){var e=new Error(t.name);return e.code=t.id,e}return a.prototype.get=function(e,n,i){h(n=n||{});var r=d("GET",f(n.queryParameters||{},e)),s=t.bind(v,this,t.now(),i);if(!r)return i(l());n.mimeType&&r.overrideMimeType(n.mimeType),n.responseType&&(r.responseType=n.responseType),p(r,n),r.addEventListener("readystatechange",t.bind(m,this,r,n,s)),r.timeout=n.timeout||3e3,r.send()},a.prototype.post=function(t,e,n,i){return u.call(this,"POST",t,e,n,i)},a.prototype.put=function(t,e,n,i){return u.call(this,"PUT",t,e,n,i)},a.prototype.delete=function(t,e,n,i){return u.call(this,"DELETE",t,e,n,i)},a.prototype.getWithRetry=function(e,n,i){var r=t.bind(this.get,this,e,n),s={startTime:t.now(),isDisposed:!1};return g.call(this,e,n,r,s,i)},a.prototype.postWithRetry=function(t,e,n,i){return c.call(this,this.post,t,e,n,i)},a.prototype.putWithRetry=function(t,e,n,i){return c.call(this,this.put,t,e,n,i)},a.prototype.deleteWithRetry=function(t,e,n,i){return c.call(this,this.delete,t,e,n,i)},new a}.apply(e,i))||(t.exports=r)},function(t,e,n){var i,r;i=[n(0),n(1),n(4),n(9),n(24),n(6),n(7),n(3)],void 0===(r=function(t,e,n,i,r,s,o,a){var u=0,c={capacity:"capacity",error:"error",response:"response"},h="__phenixBatchHttpMessages";function f(s,u,c,f){e.wt(s,"uri"),u=u||{},e.st(u,"options"),u.requestType&&e.wt(u.requestType,"options.requestType"),u.maxAttempts&&e.Dt(u.maxAttempts,"options.maxAttempts"),u.maxBufferedRecords&&e.Dt(u.maxBufferedRecords,"options.maxBufferedRecords"),u.maxBatchSize&&e.Dt(u.maxBatchSize,"options.maxBatchSize"),u.contentType&&e.wt(u.contentType,"options.maxBatchSize"),c&&e.rt(c,"serializeRequest"),f&&e.rt(f,"deserializeResponse"),this.li=h+"|"+s,this.pi=u.requestType||"POST",this.mi=u.requestTimeout||3e4,this.vi=u.maxAttempts||5,this.gi=u.maxBufferedRecords||1e3,this.yi=u.maxBatchSize||100,this.wi=u.contentType||"application/json",this.bi=c,this.ki=f,this.Tt=s,this.jn=m.call(this)||[],this.Gn=!0,this.Pt=new n.NamedEvents,this.Si=new o.Observable(!0),this.v=new a.DisposableList,this.Ii=!1,this.Ei=!1,this.v.add(this.Si.subscribe(t.bind(l,this))),this.v.add(function(){var t=this;return r.listenForNetworkChange(function(){p.call(t,t.Ii)})}.call(this)),this.v.add(this.Pt),g.call(this,[]),l.call(this);var d=this;t.addEventListener(i,"beforeunload",function(){v.call(d,d.jn),d.Ei=!0,d.jn=[]})}function d(){if(this.jn.length>this.gi){var t=this.jn.length-this.gi/2;this.jn=this.jn.slice(t),this.Pt.fireAsync(c.capacity,[null,{numberOfDeletedRecords:t}])}}function l(){if(this.Si.getValue()&&0!==this.jn.length&&this.jn.length===this.yi){p.call(this,!0);var e={records:t.take(this.jn,this.yi)};this.jn=this.jn.slice(this.yi);var n=this;try{(function(e,n,i){var r=this,o=this.bi?this.bi(t.assign({},n)):n;switch(this.pi){case"POST":return s.postWithRetry(e,o,{timeout:this.mi,contentType:this.wi,retryOptions:{maxAttempts:this.vi,additionalRetryErrorCodes:[0]}},function(t,e){if(t)return"timeout"!==t.message||function(){return this.jn.length>=this.gi}.call(r)?(p.call(r,!1),r.Pt.fire(c.error,[t])):i();p.call(r,!1);var n=r.ki?r.ki(e.data):e.data;return r.Pt.fire(c.response,[n])});default:throw new Error("Invalid request type")}}).call(this,this.Tt,e,function(){setTimeout(function(){n.jn=n.jn.concat(e.records),p.call(n,!1)},u)})}catch(t){setTimeout(function(){return p.call(n,!1),n.Pt.fire(c.error,[t])},u)}}}function p(t){this.Ii=t,this.Si.setValue(!t&&r.isOnline())}f.prototype.on=function(t,n){return e.wt(t,"eventName"),e.rt(n,"callback"),this.Pt.listen(t,n)},f.prototype.addRecord=function(t){if(this.Ei)return v.call(this,[t]);this.jn.push(t),l.call(this),d.call(this)},f.prototype.addRecordToBeginning=function(t){this.jn.unshift(t),l.call(this),d.call(this)},f.prototype.dispose=function(){this.jn=[],this.v.dispose()};var m=function(){if(!i.localStorage)return null;var t=i.localStorage.getItem(this.li);return t?JSON.parse(t):[]},v=function(t){if(!i.localStorage||!t||0===t.length)return null;var e=m.call(this).concat(t);return g.call(this,e)},g=function(t){return i.localStorage&&t?i.localStorage.setItem(this.li,JSON.stringify(t)):null};return f}.apply(e,i))||(t.exports=r)},function(t,e,n){var i,r;i=[n(56)],void 0===(r=function(t){"use strict";return t}.apply(e,i))||(t.exports=r)},function(t,e,n){var i,r;i=[n(0),n(1),n(57),n(22),n(54)],void 0===(r=function(t,e,n,i,r){"use strict";function s(t,e,n){return r.toString(t.encode(e,n))}function o(t,e,n){return t.decode(e+"Response",r.toByteArray(n))}return function(r,a,u,c,h){e.wt(r,"uri"),e.isArray(a,"protocols"),e.wt(u,"type"),e.st(c,"options");var f=t.assign({},c||{},{contentType:"application/protobuf"}),d=new i(a,h);return new n(r,f,t.bind(s,this,d,u),t.bind(o,this,d,u))}}.apply(e,i))||(t.exports=r)},function(t,e,n){var i;!function(){for(var r={},s=[65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,48,49,50,51,52,53,54,55,56,57,43,47],o=[],a=0,u=s.length;a<u;++a)o[s[a]]=a;r.encode=function(t,e){for(var n,i;null!==(n=t());)e(s[n>>2&63]),i=(3&n)<<4,null!==(n=t())?(e(s[63&((i|=n>>4&15)|n>>4&15)]),i=(15&n)<<2,null!==(n=t())?(e(s[63&(i|n>>6&3)]),e(s[63&n])):(e(s[63&i]),e(61))):(e(s[63&i]),e(61),e(61))},r.decode=function(t,e){var n,i,r;function s(t){throw Error("Illegal character code: "+t)}for(;null!==(n=t());)if(void 0===(i=o[n])&&s(n),null!==(n=t())&&(void 0===(r=o[n])&&s(n),e(i<<2>>>0|(48&r)>>4),null!==(n=t()))){if(void 0===(i=o[n])){if(61===n)break;s(n)}if(e((15&r)<<4>>>0|(60&i)>>2),null!==(n=t())){if(void 0===(r=o[n])){if(61===n)break;s(n)}e((3&i)<<6>>>0|r)}}},r.test=function(t){return/^(?:[A-Za-z0-9+/]{4})*(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=)?$/.test(t)},void 0!==t&&t.exports?t.exports=r:void 0===(i=function(){return r}.call(e,n,e,t))||(t.exports=i)}()},function(t,e,n){t.exports=n(59)},function(t,e,n){var i,r;i=[n(0),n(1),n(9),n(60)],void 0===(r=function(t,e,n,i){"use strict";function r(){this.Ti=[],this.Ri=""}return r.prototype.push=function(){this.Ti.length+arguments.length>1024&&(this.Ri+=String.fromCharCode.apply(String,this.Ti),this.Ti.length=0),Array.prototype.push.apply(this.Ti,arguments)},r.prototype.build=function(){return this.Ri+String.fromCharCode.apply(String,this.Ti)},{toString:function(e){var n=0,s=e.length,o=new r;return i.encode(function(){return n<s?e[n++]:null},t.bind(o.push,o)),o.build()},toByteArray:function(t){e.lt(t,"data");var r,s,o=[];return i.decode((r=t,s=0,function(){return s<r.length?r.charCodeAt(s++):null}),function(t){o.push(t)}),new n.Uint8Array(o)}}}.apply(e,i))||(t.exports=r)},function(t,e,n){var i;void 0===(i=function(){"use strict";return{package:"mq",messages:[{name:"Message",fields:[{rule:"optional",type:"MessageType",name:"messageType",id:7,options:{default:"Request"}},{rule:"optional",type:"string",name:"sessionId",id:1},{rule:"optional",type:"string",name:"requestId",id:2},{rule:"required",type:"string",name:"type",id:3},{rule:"optional",type:"string",name:"encoding",id:4},{rule:"required",type:"bytes",name:"payload",id:5},{rule:"repeated",type:"double",name:"wallTime",id:6}],enums:[{name:"MessageType",values:[{name:"Request",id:0},{name:"Response",id:1},{name:"Event",id:2}]}]},{name:"Error",fields:[{rule:"required",type:"string",name:"reason",id:1}]},{name:"PingPong",fields:[{rule:"required",type:"uint64",name:"originTimestamp",id:1},{rule:"optional",type:"uint64",name:"count",id:2}]}]}}.apply(e,[]))||(t.exports=i)},function(t,e,n){var i,r;i=[n(0)],void 0===(r=function(t){"use strict";function e(e){this.Ci=e,this.xi={},this.Oi={},function e(n,i){t.get(n,["messages","length"],0)>0&&function(n,i){var r=this;i.messages=t.reduce(n,function(n,s){if(!i[s.name]){var o=t.reduce(s.fields,function(t,e){return t[e.id]=!0,t},{});return n[s.name]={parent:i,type:s.name,fieldIds:o},e.call(r,s,n[s.name]),n}},{})}.call(this,n.messages,i),t.get(n,["enums","length"],0)>0&&function(e,n){n.enums=t.reduce(e,function(e,n){return e[n.name]=t.reduce(n.values,function(t,e){return t[e.name]=e,t},{}),e},{})}.call(this,n.enums,i)}.call(this,this.Ci,this.xi),function e(n,i){var s=this;t.forEach(n.messages,function(n){i.messages[n.name].fields=t.reduce(n.fields,t.bind(r,this,i.messages[n.name]),{}),n.messages&&e.call(s,n,i.messages[n.name])})}.call(this,this.Ci,this.xi)}function n(e,n,i,r){var o,a=this,u=(o=e.messages[n],t.reduce(o.fields,function(e,n){return e[n.name]=t.clone(n.defaultValue),e},{}));return i.readFields(function(t,i,r){if(e.messages[n].fieldIds[t]){var o=e.messages[n].fields[t];"repeated"===o.rule?i[o.name].push(s.call(a,e.messages[n],n,t,r)):i[o.name]=s.call(a,e.messages[n],n,t,r)}},u,r)}function i(e,n,r,s){var o=this,a=e.messages[n];t.forEach(t.keys(a.fields),function(a){return function e(n,r,s,o,a,u){var c=this,h=n.messages[r].fields[s],f=o[h.name];if(t.isUndefined(u)||(f=f[u]),h.defaultValue!==f&&!t.isUndefined(f)){if(t.isArray(f)){if("repeated"!==h.rule)throw new Error("Invalid type. Array is not valid with rule ["+h.rule+"]");return t.forEach(f,function(t,i){e.call(c,n,r,s,o,a,i)})}if(t.st(h.schema)&&t.st(f))return a.writeMessage(s,t.bind(i,this,h.schema.parent,h.type),f);var d=t.isUndefined(f)?h.defaultValue:f;if(t.st(h.schema)&&!h.schema.fields){var l=t.Dt(f)?f:t.get(h.schema,[d,"id"]);return a.writeVarintField(s,l)}switch(h.type){case"string":return a.writeStringField(s,d);case"float":return a.writeFloatField(s,d);case"double":return a.writeDoubleField(s,d);case"bool":return a.writeBooleanField(s,d);case"enum":case"uint32":case"uint64":case"int32":case"int64":return a.writeVarintField(s,d);case"sint32":case"sint64":return a.writeSVarintField(s,d);case"fixed32":return a.writeFixed32Field(s,d);case"fixed64":return a.writeFixed64Field(s,d);case"sfixed32":return a.writeSFixed32Field(s,d);case"sfixed64":return a.writeSFixed64Field(s,d);case"bytes":return a.writeBytesField(s,d);default:throw new Error("Unexpected type: "+h.type)}}}.call(o,e,n,parseInt(a),r,s)})}function r(e,n,i){return n[i.id]={rule:i.rule,type:i.type,name:i.name,schema:function e(n,i){return t.get(i,["messages",n])?i.messages[n]:t.get(i,["enums",n])?i.enums[n]:i.parent?e(n,i.parent):n}.call(this,i.type,e),defaultValue:function(e,n,i){if("repeated"===e)return[];switch(n){case"float":case"double":case"uint32":case"uint64":case"int32":case"int64":case"sint32":case"sint64":case"fixed32":case"fixed64":case"sfixed32":case"sfixed64":case"string":case"enum":case"bool":case"long":default:return t.isUndefined(i)?null:i}}(i.rule,i.type,t.get(i,["options","default"]))},n}function s(e,i,r,s){var o="int32"===i||"int64"===i?"true":"",a=e.fields[r];if(t.st(a.schema)){if(a.schema.fields)return n.call(this,a.schema.parent,a.type,s,s.readVarint()+s.pos);var u=s.readVarint(o),c=t.getEnumName(a.schema,u);if(t.isNullOrUndefined(c))throw new Error("Unsupported enum id ["+u+"] for field ["+a.name+"] on message ["+e.type+"]");return c}switch(a.type){case"string":return s.readString(o);case"float":return s.readFloat(o);case"double":return s.readDouble(o);case"bool":return s.readBoolean(o);case"enum":return s.readVarint(o);case"uint32":case"uint64":case"int32":case"int64":return s.readVarint(o);case"sint32":case"sint64":return s.readSVarint(o);case"fixed32":return s.readFixed32(o);case"fixed64":return s.readFixed64(o);case"sfixed32":return s.readSFixed32(o);case"sfixed64":return s.readSFixed64(o);case"bytes":return s.readBytes(o);default:throw new Error("Unexpected type: "+a.type)}}return e.prototype.read=function(t,e,i){if(!this.xi.messages[t])throw new Error("Unsupported proto type ["+t+"]");return n.call(this,this.xi,t,e,i)},e.prototype.write=function(t,e,n){if(!this.xi.messages[t])throw new Error("Unsupported proto type ["+t+"]");return i.call(this,this.xi,t,e,n)},e.prototype.getDefaults=function(){},e}.apply(e,i))||(t.exports=r)},function(t,e){e.read=function(t,e,n,i,r){var s,o,a=8*r-i-1,u=(1<<a)-1,c=u>>1,h=-7,f=n?r-1:0,d=n?-1:1,l=t[e+f];for(f+=d,s=l&(1<<-h)-1,l>>=-h,h+=a;h>0;s=256*s+t[e+f],f+=d,h-=8);for(o=s&(1<<-h)-1,s>>=-h,h+=i;h>0;o=256*o+t[e+f],f+=d,h-=8);if(0===s)s=1-c;else{if(s===u)return o?NaN:1/0*(l?-1:1);o+=Math.pow(2,i),s-=c}return(l?-1:1)*o*Math.pow(2,s-i)},e.write=function(t,e,n,i,r,s){var o,a,u,c=8*s-r-1,h=(1<<c)-1,f=h>>1,d=23===r?Math.pow(2,-24)-Math.pow(2,-77):0,l=i?0:s-1,p=i?1:-1,m=e<0||0===e&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(a=isNaN(e)?1:0,o=h):(o=Math.floor(Math.log(e)/Math.LN2),e*(u=Math.pow(2,-o))<1&&(o--,u*=2),(e+=o+f>=1?d/u:d*Math.pow(2,1-f))*u>=2&&(o++,u/=2),o+f>=h?(a=0,o=h):o+f>=1?(a=(e*u-1)*Math.pow(2,r),o+=f):(a=e*Math.pow(2,f-1)*Math.pow(2,r),o=0));r>=8;t[n+l]=255&a,l+=p,a/=256,r-=8);for(o=o<<r|a,c+=r;c>0;t[n+l]=255&o,l+=p,o/=256,c-=8);t[n+l-p]|=128*m}},function(t,e,n){"use strict";t.exports=r;var i=n(64);function r(t){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(t)?t:new Uint8Array(t||0),this.pos=0,this.type=0,this.length=this.buf.length}function s(t){return t.type===r.Bytes?t.readVarint()+t.pos:t.pos+1}function o(t,e,n){return n?4294967296*e+(t>>>0):4294967296*(e>>>0)+(t>>>0)}function a(t,e,n){var i=e<=16383?1:e<=2097151?2:e<=268435455?3:Math.ceil(Math.log(e)/(7*Math.LN2));n.realloc(i);for(var r=n.pos-1;r>=t;r--)n.buf[r+i]=n.buf[r]}function u(t,e){for(var n=0;n<t.length;n++)e.writeVarint(t[n])}function c(t,e){for(var n=0;n<t.length;n++)e.writeSVarint(t[n])}function h(t,e){for(var n=0;n<t.length;n++)e.writeFloat(t[n])}function f(t,e){for(var n=0;n<t.length;n++)e.writeDouble(t[n])}function d(t,e){for(var n=0;n<t.length;n++)e.writeBoolean(t[n])}function l(t,e){for(var n=0;n<t.length;n++)e.writeFixed32(t[n])}function p(t,e){for(var n=0;n<t.length;n++)e.writeSFixed32(t[n])}function m(t,e){for(var n=0;n<t.length;n++)e.writeFixed64(t[n])}function v(t,e){for(var n=0;n<t.length;n++)e.writeSFixed64(t[n])}function g(t,e){return(t[e]|t[e+1]<<8|t[e+2]<<16)+16777216*t[e+3]}function y(t,e,n){t[n]=e,t[n+1]=e>>>8,t[n+2]=e>>>16,t[n+3]=e>>>24}function w(t,e){return(t[e]|t[e+1]<<8|t[e+2]<<16)+(t[e+3]<<24)}r.Varint=0,r.Fixed64=1,r.Bytes=2,r.Fixed32=5,r.prototype={destroy:function(){this.buf=null},readFields:function(t,e,n){for(n=n||this.length;this.pos<n;){var i=this.readVarint(),r=i>>3,s=this.pos;this.type=7&i,t(r,e,this),this.pos===s&&this.skip(i)}return e},readMessage:function(t,e){return this.readFields(t,e,this.readVarint()+this.pos)},readFixed32:function(){var t=g(this.buf,this.pos);return this.pos+=4,t},readSFixed32:function(){var t=w(this.buf,this.pos);return this.pos+=4,t},readFixed64:function(){var t=g(this.buf,this.pos)+4294967296*g(this.buf,this.pos+4);return this.pos+=8,t},readSFixed64:function(){var t=g(this.buf,this.pos)+4294967296*w(this.buf,this.pos+4);return this.pos+=8,t},readFloat:function(){var t=i.read(this.buf,this.pos,!0,23,4);return this.pos+=4,t},readDouble:function(){var t=i.read(this.buf,this.pos,!0,52,8);return this.pos+=8,t},readVarint:function(t){var e,n,i=this.buf;return e=127&(n=i[this.pos++]),n<128?e:(e|=(127&(n=i[this.pos++]))<<7,n<128?e:(e|=(127&(n=i[this.pos++]))<<14,n<128?e:(e|=(127&(n=i[this.pos++]))<<21,n<128?e:function(t,e,n){var i,r,s=n.buf;if(i=(112&(r=s[n.pos++]))>>4,r<128)return o(t,i,e);if(i|=(127&(r=s[n.pos++]))<<3,r<128)return o(t,i,e);if(i|=(127&(r=s[n.pos++]))<<10,r<128)return o(t,i,e);if(i|=(127&(r=s[n.pos++]))<<17,r<128)return o(t,i,e);if(i|=(127&(r=s[n.pos++]))<<24,r<128)return o(t,i,e);if(i|=(1&(r=s[n.pos++]))<<31,r<128)return o(t,i,e);throw new Error("Expected varint not more than 10 bytes")}(e|=(15&(n=i[this.pos]))<<28,t,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var t=this.readVarint();return t%2==1?(t+1)/-2:t/2},readBoolean:function(){return Boolean(this.readVarint())},readString:function(){var t=this.readVarint()+this.pos,e=function(t,e,n){for(var i="",r=e;r<n;){var s,o,a,u=t[r],c=null,h=u>239?4:u>223?3:u>191?2:1;if(r+h>n)break;1===h?u<128&&(c=u):2===h?128==(192&(s=t[r+1]))&&(c=(31&u)<<6|63&s)<=127&&(c=null):3===h?(s=t[r+1],o=t[r+2],128==(192&s)&&128==(192&o)&&((c=(15&u)<<12|(63&s)<<6|63&o)<=2047||c>=55296&&c<=57343)&&(c=null)):4===h&&(s=t[r+1],o=t[r+2],a=t[r+3],128==(192&s)&&128==(192&o)&&128==(192&a)&&((c=(15&u)<<18|(63&s)<<12|(63&o)<<6|63&a)<=65535||c>=1114112)&&(c=null)),null===c?(c=65533,h=1):c>65535&&(c-=65536,i+=String.fromCharCode(c>>>10&1023|55296),c=56320|1023&c),i+=String.fromCharCode(c),r+=h}return i}(this.buf,this.pos,t);return this.pos=t,e},readBytes:function(){var t=this.readVarint()+this.pos,e=this.buf.subarray(this.pos,t);return this.pos=t,e},readPackedVarint:function(t,e){var n=s(this);for(t=t||[];this.pos<n;)t.push(this.readVarint(e));return t},readPackedSVarint:function(t){var e=s(this);for(t=t||[];this.pos<e;)t.push(this.readSVarint());return t},readPackedBoolean:function(t){var e=s(this);for(t=t||[];this.pos<e;)t.push(this.readBoolean());return t},readPackedFloat:function(t){var e=s(this);for(t=t||[];this.pos<e;)t.push(this.readFloat());return t},readPackedDouble:function(t){var e=s(this);for(t=t||[];this.pos<e;)t.push(this.readDouble());return t},readPackedFixed32:function(t){var e=s(this);for(t=t||[];this.pos<e;)t.push(this.readFixed32());return t},readPackedSFixed32:function(t){var e=s(this);for(t=t||[];this.pos<e;)t.push(this.readSFixed32());return t},readPackedFixed64:function(t){var e=s(this);for(t=t||[];this.pos<e;)t.push(this.readFixed64());return t},readPackedSFixed64:function(t){var e=s(this);for(t=t||[];this.pos<e;)t.push(this.readSFixed64());return t},skip:function(t){var e=7&t;if(e===r.Varint)for(;this.buf[this.pos++]>127;);else if(e===r.Bytes)this.pos=this.readVarint()+this.pos;else if(e===r.Fixed32)this.pos+=4;else{if(e!==r.Fixed64)throw new Error("Unimplemented type: "+e);this.pos+=8}},writeTag:function(t,e){this.writeVarint(t<<3|e)},realloc:function(t){for(var e=this.length||16;e<this.pos+t;)e*=2;if(e!==this.length){var n=new Uint8Array(e);n.set(this.buf),this.buf=n,this.length=e}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(t){this.realloc(4),y(this.buf,t,this.pos),this.pos+=4},writeSFixed32:function(t){this.realloc(4),y(this.buf,t,this.pos),this.pos+=4},writeFixed64:function(t){this.realloc(8),y(this.buf,-1&t,this.pos),y(this.buf,Math.floor(t*(1/4294967296)),this.pos+4),this.pos+=8},writeSFixed64:function(t){this.realloc(8),y(this.buf,-1&t,this.pos),y(this.buf,Math.floor(t*(1/4294967296)),this.pos+4),this.pos+=8},writeVarint:function(t){(t=+t||0)>268435455||t<0?function(t,e){var n,i;if(t>=0?(n=t%4294967296|0,i=t/4294967296|0):(i=~(-t/4294967296),4294967295^(n=~(-t%4294967296))?n=n+1|0:(n=0,i=i+1|0)),t>=0x10000000000000000||t<-0x10000000000000000)throw new Error("Given varint doesn't fit into 10 bytes");e.realloc(10),function(t,e,n){n.buf[n.pos++]=127&t|128,t>>>=7,n.buf[n.pos++]=127&t|128,t>>>=7,n.buf[n.pos++]=127&t|128,t>>>=7,n.buf[n.pos++]=127&t|128,t>>>=7,n.buf[n.pos]=127&t}(n,0,e),function(t,e){var n=(7&t)<<4;e.buf[e.pos++]|=n|((t>>>=3)?128:0),t&&(e.buf[e.pos++]=127&t|((t>>>=7)?128:0),t&&(e.buf[e.pos++]=127&t|((t>>>=7)?128:0),t&&(e.buf[e.pos++]=127&t|((t>>>=7)?128:0),t&&(e.buf[e.pos++]=127&t|((t>>>=7)?128:0),t&&(e.buf[e.pos++]=127&t)))))}(i,e)}(t,this):(this.realloc(4),this.buf[this.pos++]=127&t|(t>127?128:0),t<=127||(this.buf[this.pos++]=127&(t>>>=7)|(t>127?128:0),t<=127||(this.buf[this.pos++]=127&(t>>>=7)|(t>127?128:0),t<=127||(this.buf[this.pos++]=t>>>7&127))))},writeSVarint:function(t){this.writeVarint(t<0?2*-t-1:2*t)},writeBoolean:function(t){this.writeVarint(Boolean(t))},writeString:function(t){t=String(t),this.realloc(4*t.length),this.pos++;var e=this.pos;this.pos=function(t,e,n){for(var i,r,s=0;s<e.length;s++){if((i=e.charCodeAt(s))>55295&&i<57344){if(!r){i>56319||s+1===e.length?(t[n++]=239,t[n++]=191,t[n++]=189):r=i;continue}if(i<56320){t[n++]=239,t[n++]=191,t[n++]=189,r=i;continue}i=r-55296<<10|i-56320|65536,r=null}else r&&(t[n++]=239,t[n++]=191,t[n++]=189,r=null);i<128?t[n++]=i:(i<2048?t[n++]=i>>6|192:(i<65536?t[n++]=i>>12|224:(t[n++]=i>>18|240,t[n++]=i>>12&63|128),t[n++]=i>>6&63|128),t[n++]=63&i|128)}return n}(this.buf,t,this.pos);var n=this.pos-e;n>=128&&a(e,n,this),this.pos=e-1,this.writeVarint(n),this.pos+=n},writeFloat:function(t){this.realloc(4),i.write(this.buf,t,this.pos,!0,23,4),this.pos+=4},writeDouble:function(t){this.realloc(8),i.write(this.buf,t,this.pos,!0,52,8),this.pos+=8},writeBytes:function(t){var e=t.length;this.writeVarint(e),this.realloc(e);for(var n=0;n<e;n++)this.buf[this.pos++]=t[n]},writeRawMessage:function(t,e){this.pos++;var n=this.pos;t(e,this);var i=this.pos-n;i>=128&&a(n,i,this),this.pos=n-1,this.writeVarint(i),this.pos+=i},writeMessage:function(t,e,n){this.writeTag(t,r.Bytes),this.writeRawMessage(e,n)},writePackedVarint:function(t,e){this.writeMessage(t,u,e)},writePackedSVarint:function(t,e){this.writeMessage(t,c,e)},writePackedBoolean:function(t,e){this.writeMessage(t,d,e)},writePackedFloat:function(t,e){this.writeMessage(t,h,e)},writePackedDouble:function(t,e){this.writeMessage(t,f,e)},writePackedFixed32:function(t,e){this.writeMessage(t,l,e)},writePackedSFixed32:function(t,e){this.writeMessage(t,p,e)},writePackedFixed64:function(t,e){this.writeMessage(t,m,e)},writePackedSFixed64:function(t,e){this.writeMessage(t,v,e)},writeBytesField:function(t,e){this.writeTag(t,r.Bytes),this.writeBytes(e)},writeFixed32Field:function(t,e){this.writeTag(t,r.Fixed32),this.writeFixed32(e)},writeSFixed32Field:function(t,e){this.writeTag(t,r.Fixed32),this.writeSFixed32(e)},writeFixed64Field:function(t,e){this.writeTag(t,r.Fixed64),this.writeFixed64(e)},writeSFixed64Field:function(t,e){this.writeTag(t,r.Fixed64),this.writeSFixed64(e)},writeVarintField:function(t,e){this.writeTag(t,r.Varint),this.writeVarint(e)},writeSVarintField:function(t,e){this.writeTag(t,r.Varint),this.writeSVarint(e)},writeStringField:function(t,e){this.writeTag(t,r.Bytes),this.writeString(e)},writeFloatField:function(t,e){this.writeTag(t,r.Fixed32),this.writeFloat(e)},writeDoubleField:function(t,e){this.writeTag(t,r.Fixed64),this.writeDouble(e)},writeBooleanField:function(t,e){this.writeVarintField(t,Boolean(e))}}},function(t,e,n){var i,r;i=[n(0),n(9),n(4),n(7),n(3)],void 0===(r=function(t,e,n,i,r){"use strict";function s(){var r="undefined"==typeof navigator||navigator.onLine;this.Pi=new i.Observable(r).extend({timeout:0}),this.Pt=new n.NamedEvents,t.addEventListener(e,"online",t.bind(this.Pt.fire,this.Pt,"online",[])),t.addEventListener(e,"offline",t.bind(this.Pt.fire,this.Pt,"offline",[])),t.addEventListener(e,"unload",t.bind(this.Pt.dispose,this.Pt)),this.Pt.listen("online",t.bind(this.Pi.setValue,this.Pi,!0)),this.Pt.listen("offline",t.bind(this.Pi.setValue,this.Pi,!1))}function o(e,n){var i=this;if(this.Pi.setValue(!1),!t.Dt(n))return e(!1);i.offlineTimeout=setTimeout(function(){e&&!i.Pi.getValue()&&e(!1)},n)}function a(t){this.Pi.setValue(!0),t&&t(!0)}return s.prototype.listenForNetworkChange=function(e,n){var i=new r.DisposableList,s=t.bind(a,this,e),u=t.bind(o,this,e,n);return i.add(this.Pt.listen("online",s)),i.add(this.Pt.listen("offline",u)),i},s.prototype.isOnline=function(){return this.Pi.getValue()},new s}.apply(e,i))||(t.exports=r)},function(t,e,n){var i,r;i=[n(0),n(1),n(24)],void 0===(r=function(t,e,n){"use strict";var i=15e3,r=1e3,s=1e3,o=4,a={byebye:{code:1e3,reason:"byebye",desc:"Client closed"},backoffLimitReached:{code:4e3,reason:"backoff-limit-reached",desc:"Reached the limit in terms of the number of reconnects"},networkDisconnect:{code:4001,reason:"network-disconnect",desc:"Network connection monitor determined loss to internet connectivity"},reconnecting:{code:4002,reason:"reconnecting",desc:"Closing WebSocket in order to attempt to establish another connection"}},u={connecting:{code:0,state:"CONNECTING",desc:"The connection is not yet open"},open:{code:1,state:"OPEN",desc:"The connection is open and ready to communicate"},closing:{code:2,state:"CLOSING",desc:"The connection is in the process of closing"},closed:{code:3,state:"CLOSED",desc:"The connection is closed or could not be opened"}};function c(c,h,d,y){e.wt(c,"uri"),e.st(h,"logger"),t.isNullOrUndefined(d)?d=o:e.Dt(d,"maxReconnectAttempts"),this.Tt=c,this.ot=h,this.Mi=d,this.Di=y||s,this.qi=!1,this.ke=!1,this.Ai=[],this.Ni="connecting",this.ot.info("Connecting WebSocket to [%s]",c),this.oe=f.call(this,m,l);var w=this;this.Fi=null,this.ji=n.listenForNetworkChange(function(e){if(e)return t.Dt(w.Fi)&&(clearTimeout(w.Fi),w.Fi=null),function(){var t=this;setTimeout(function(){return t.ke?t.ot.info("Unable to go back online after network reconnect. Client has stopped WebSocket."):t.oe.readyState!==u.open.code?(t.ot.info("Network Reconnected. Attempting to reconnect WebSocket."),t.reconnect()):t.Ui?(t.ot.info("Network Reconnected with WebSocket status of [%s].",u.open.state),m.call(t)):("online"===t.Ni&&"reconnected"===this.Ni||v.call(t),void t.ot.info("Network Reconnected."))},r)}.call(w);t.Dt(w.Fi)||(p.call(w),w.Fi=setTimeout(function(){return function(){this.ot.warn("Network not reconnected after [%s]. Going Offline and disconnecting WebSocket connection.",i),this.Ui=!0,g.call(this,a.networkDisconnect)}.call(w)},i))},0)}function h(t){return this.oe.readyState===u.closed.code?l.call(this,t):this.oe.close(t.code,t.reason)}function f(e,n){var i=new WebSocket(this.Tt);return i.onopen=t.bind(e,this),i.onclose=t.bind(n,this),i.onmessage=t.bind(w,this),i.onerror=t.bind(y,this),i}function d(t){this.oe.readyState!==u.open.code&&this.reconnect(t+1)}function l(t){switch(t.code){case a.reconnecting.code:return;case a.byebye.code:case a.backoffLimitReached.code:case a.networkDisconnect.code:return g.call(this,t);default:if(this.qi)return;return p.call(this,t),this.ot.info("Attempting to re-establish socket connection after disconnect event with code [%s] and reason [%s]",t.code,t.reason),this.reconnect()}}function p(t){this.ot.info("WebSocket is reconnecting"),this.Ni="reconnecting",this.onreconnecting&&this.onreconnecting(t)}function m(t){this.ot.info("WebSocket Connected"),function(){var t=this.Ai.length;if(0!==t)for(this.ot.info("Sending [%s] queued messages",t);t>0;){t--;var e=this.Ai.shift();this.send(e)}}.call(this),this.Ni="connected",this.onconnected&&this.onconnected(t)}function v(t){this.ot.info("Successfully reconnected to WebSocket"),this.Ni="reconnected",this.onreconnected&&this.onreconnected(t)}function g(t){this.ot.info("WebSocket Disconnected [%s]: [%s]",t.code,t.reason),this.Ni="disconnected",this.ondisconnected&&this.ondisconnected(t)}function y(t){this.ot.error("An error occurred on the WebSocket connection [%s]",t.data||t),this.onerror&&this.onerror(t)}function w(t){this.ot.debug(">> [%s]",t.data),this.onmessage&&this.onmessage(t)}return c.prototype.onmessage=null,c.prototype.onconnected=null,c.prototype.onreconnecting=null,c.prototype.onreconnected=null,c.prototype.ondisconnected=null,c.prototype.onerror=null,c.prototype.send=function(t){return n.isOnline(),this.oe.send(t)},c.prototype.reconnect=function(e){this.oe.onclose=null,this.oe.onerror=null,this.qi=!0;var n,i=this;if(t.Dt(e)||(e=1),this.ke)return this.ot.info("Client has stopped WebSocket after [%s] reconnect attempts",e-1);if(e>this.Mi)return this.ot.warn("Unable to reconnect WebSocket after [%s] attempts",this.Mi),h.call(this,a.backoffLimitReached);h.call(this,a.reconnecting);try{this.oe=f.call(i,function(){return n&&clearTimeout(n),i.qi=!1,i.oe.onclose=t.bind(l,i),v.call(i)},function(){e+1>i.Mi&&(n&&clearTimeout(n),d.call(i,e))})}catch(t){this.ot.warn("Unable to create WebSocket connection [%s]",t)}n=function(t){var e=this;return setTimeout(function(){d.call(e,t)},t*t*this.Di)}.call(this,e)},c.prototype.disconnect=function(){return this.ji.dispose(),this.ke=!0,t.Dt(this.Fi)&&(clearTimeout(this.Fi),this.Fi=null),this.oe.close(a.byebye.code,a.byebye.reason)},c.prototype.toString=function(){return"ReconnectedWebSocket["+this.Tt+","+this.oe.readyState+"]"},c}.apply(e,i))||(t.exports=r)},function(t,e,n){var i,r;i=[n(67)],void 0===(r=function(t){"use strict";return t}.apply(e,i))||(t.exports=r)},function(t,e,n){var i,r;i=[n(0),n(1),n(4),n(68),n(23)],void 0===(r=function(t,e,n,i,r){"use strict";function s(s,o,p,m){e.wt(s,"uri"),e.st(o,"logger"),e.isArray(p,"protocols"),this.Tt=s,this.ot=o,this.ot.info("Connecting to [%s]",s),this.oe=new i(this.Tt,this.ot),this.Li=new r(this.ot,t.bind(l,this),t.bind(d,this),p,m),this.Pt=new n.NamedEvents,this.oe.onconnected=t.bind(u,this),this.oe.onreconnecting=t.bind(a,this),this.oe.onreconnected=t.bind(c,this),this.oe.ondisconnected=t.bind(h,this),this.oe.onerror=t.bind(f,this),this._i=!1}function o(t,e){this.Pt.fire(t,e,this)}function a(t){o.call(this,"reconnecting")}function u(t){o.call(this,"connected")}function c(t){o.call(this,"reconnected")}function h(t){o.call(this,"disconnected",[t.code,t.reason]),this._i&&(this.Pt.dispose(),this.Li.dispose())}function f(t){o.call(this,"error",[t.data])}function d(t){this.oe.onmessage=t}function l(t){this.oe&&this.oe.send(t)}return s.prototype.onEvent=function(t,e){return this.Pt.listen(t,e),this.Li.onEvent(t,e)},s.prototype.onRequest=function(t,e){return this.Li.onRequest(t,e)},s.prototype.sendRequest=function(t,e,n,i){return this.Li.sendRequest(t,e,n,i)},s.prototype.sendResponse=function(t,e,n,i){return this.Li.sendResponse(t,e,n,i)},s.prototype.disconnect=function(){return this._i=!0,this.oe.disconnect()},s.prototype.disposeOfPendingRequests=function(){return this.ot.info("Disposing of pending MQ WebSocket requests"),this.Li.disposeOfRequests()},s.prototype.getApiVersion=function(){return this.Li.getApiVersion()},s.prototype.toString=function(){return"MQWebSocket["+this.oe.toString()+"]"},s}.apply(e,i))||(t.exports=r)},function(t,e,n){var i,r;i=[n(0),n(1),n(2),n(10),n(13),n(21)],void 0===(r=function(t,e,n,i,r,s){function o(o){e.lt(o,"uri"),this.Vn="/telemetry/logs",this.zn="object"==typeof location?location.hostname:n.browser+"-"+n.browserVersion+"-unknown",this.Bi=i.level.TRACE,this.Gn=!0,this.Jn=(n.browser||"Browser")+"/"+(n.browserVersion||"?"),this.$n=0,this.Hn=new r.BatchHttpProto(o+this.Vn,[s],"telemetry.StoreLogRecords",{maxAttempts:3,maxBufferedRecords:1e3,maxBatchSize:512}),this.Hn.on("capacity",t.bind(a,this))}function a(e){this.Hn.addRecordToBeginning({level:"Warn",timestamp:t.isoString(),category:"websdk/telemetryLogger",message:"Deleted "+e+" records",source:this.Jn,fullQualifiedName:this.zn,sessionId:this.Kn,userId:this.Wi,environment:this.Xn,version:this.Zn,runtime:this.$n})}return o.prototype.setThreshold=function(t){e.Dt(t,"level"),this.Bi=t},o.prototype.getThreshold=function(){return this.Bi},o.prototype.isEnabled=function(){return this.Gn},o.prototype.setEnabled=function(t){e.Jt(t,"enabled"),this.Gn=t},o.prototype.log=function(n,i,r,s,o,a,u,c,h){h.level<this.Bi||!this.Gn||(e.isArray(s,"messages"),this.$n=n,this.Kn=o,this.Wi=a,this.Xn=u,this.Zn=c,function(e,n,i){this.Hn.addRecord({level:e,timestamp:t.isoString(),category:n,message:i.join(" "),source:this.Jn,fullQualifiedName:this.zn,sessionId:this.Kn,userId:this.Wi,environment:this.Xn,version:this.Zn,runtime:this.$n})}.call(this,i,r,s))},o}.apply(e,i))||(t.exports=r)},function(t,e,n){var i,r;i=[n(0),n(1),n(14),n(70)],void 0===(r=function(t,e,n,i){var r={urls:{local:"",staging:"https://telemetry-stg.phenixrts.com",production:"https://telemetry.phenixrts.com"}};function s(){this.Vi={}}return s.prototype.getAppender=function(t){var e=n.parseEnvFromPcastBaseUri(t||""),s=r.urls[e];return this.Vi[e]||(this.Vi[e]=function(t){var e=new i(t);return t||e.setEnabled(!1),e}.call(this,s)),this.Vi[e]},new s}.apply(e,i))||(t.exports=r)},function(t,e,n){var i,r;i=[n(0),n(1),n(10),n(71)],void 0===(r=function(t,e,n,i){"use strict";function r(){}return r.prototype.createPCastLogger=function(t,r){t&&e.wt(t,"baseUri");var s=new n.Logger,o=i.getAppender(t);return o.setThreshold(n.level.INFO),r||s.addAppender(new n.ConsoleAppender),s.addAppender(o),s.isPCastLogger=!0,s},new r}.apply(e,i))||(t.exports=r)},function(t,e,n){var i,r;i=[n(0),n(1),n(15)],void 0===(r=function(t,e,n){"use strict";function i(){this.Bi=n.level.TRACE}i.prototype.setThreshold=function(t){e.Dt(t,"level"),this.Bi=t},i.prototype.getThreshold=function(){return this.Bi},i.prototype.log=function(t,e,i,o,a,u,c,h,f){f.level<this.Bi||(o[0]=t+" ["+i+"] "+e+" "+o[0],f.level>n.level.INFO?s(o):r(o))};var r=function(t){console.log.apply(console,t)}||function(){},s=function(t){console.error.apply(console,t)}||r;return i}.apply(e,i))||(t.exports=r)},function(t,e){var n;n=function(){return this}();try{n=n||Function("return this")()||(0,eval)("this")}catch(t){"object"==typeof window&&(n=window)}t.exports=n},function(t,e,n){(function(n){var i;void 0===(i=function(){"use strict";return function(){return"undefined"!=typeof window?window:void 0!==n?n:"undefined"!=typeof self?self:{}}}.apply(e,[]))||(t.exports=i)}).call(this,n(74))},function(t,e,n){var i,r;i=[n(0),n(1),n(9),n(15)],void 0===(r=function(t,e,n,i){"use strict";var r="websdk",s=n.__phenixPageLoadTime||n.__pageLoadTime||t.now(),o="production",a="2018-09-17T15:08:57Z",u="2018.3.13";function c(){this.zi=[],this.Gi=null,this.qn=null,this.Dn=o,this.Ji=a}function h(t){this.qn=t,t?this.info("Session started on websdk version [%s] ([%s]), user agent [%s]",a,u,navigator.userAgent):this.info("Websdk version [%s] ([%s]), user agent [%s]",a,u,navigator.userAgent)}function f(e,n){var o=(t.now()-s)/1e3,a=function(t){switch(t){case i.level.TRACE:return"Trace";case i.level.DEBUG:return"Debug";case i.level.INFO:return"Info";case i.level.WARN:return"Warn";case i.level.ERROR:return"Error";case i.level.FATAL:return"Fatal";default:throw new Error("Unsupported Logging Level "+t)}}(n.level),u=n.name||r,c=this;t.forEach(this.zi,function(t){try{t.log(o,a,u,d(Array.prototype.slice.call(e)),c.qn,c.Gi,c.Dn,c.Ji,n)}catch(t){}})}c.prototype.trace=function(){return f.call(this,arguments,{level:i.level.TRACE})},c.prototype.debug=function(){return f.call(this,arguments,{level:i.level.DEBUG})},c.prototype.info=function(){return f.call(this,arguments,{level:i.level.INFO})},c.prototype.warn=function(){return f.call(this,arguments,{level:i.level.WARN})},c.prototype.error=function(){return f.call(this,arguments,{level:i.level.ERROR})},c.prototype.fatal=function(){return f.call(this,arguments,{level:i.level.FATAL})},c.prototype.addAppender=function(t){e.st(t,"appender"),e.rt(t.log,"appender.log"),this.zi.push(t)},c.prototype.getAppenders=function(){return this.zi},c.prototype.getUserId=function(){return this.Gi},c.prototype.setUserId=function(t){this.Gi=t},c.prototype.getEnvironment=function(){return this.Dn},c.prototype.setEnvironment=function(t){this.Dn=t},c.prototype.getApplicationVersion=function(){return this.Ji},c.prototype.setApplicationVersion=function(t){this.Ji=t},c.prototype.getObservableSessionId=function(){return this.fi},c.prototype.setObservableSessionId=function(n){this.fi=n,this.Hi&&this.Hi.dispose(),n&&(e.st(n,"observableSessionId"),this.Hi=this.fi.subscribe(t.bind(h,this),{initial:"notify"}))};var d=function(e){if(0!==e.length){var n=[],i=[];return t.forEach(e,function(e){n.push(t.toString(e)),e instanceof Error&&i.push(e.stack)}),l(n.concat(i))}},l=function(t){for(var e=t[0],n=0;e.indexOf&&t.length>1&&n>=0;)if((n=e.indexOf("%",n))>0)switch(e.substring(n+1,n+2)){case"%":e=e.substring(0,n)+e.substring(n+1),n++;break;case"s":case"d":t[0]=e=e.substring(0,n)+t[1]+e.substring(n+2),t.splice(1,1);break;default:return t}return t};return c}.apply(e,i))||(t.exports=r)},function(t,e,n){var i,r;i=[n(0),n(1),n(26)],void 0===(r=function(t,e,n){"use strict";function i(){this.f={}}return i.prototype.fire=function(n,i,r){e.wt(n,"name"),t.includes(t.keys(this.f),n)&&this.f[n].fire(i,r)},i.prototype.fireAsync=function(n,i,r){e.wt(n,"name"),t.includes(t.keys(this.f),n)&&this.f[n].fireAsync(i,r)},i.prototype.listen=function(i,r){return e.wt(i,"name"),(t.includes(t.keys(this.f),i)?this.f[i]:this.f[i]=new n).listen(r)},i.prototype.size=function(e){return t.includes(t.keys(this.f),e)?this.f[e].size():0},i.prototype.dispose=function(){t.forOwn(this.f,function(t){t.dispose()}),this.f={}},i.prototype.toString=function(){return"NamedEvents|"+t.keys(this.f).length},i}.apply(e,i))||(t.exports=r)},function(t,e,n){var i,r;i=[n(0),n(1)],void 0===(r=function(t,e){"use strict";function n(t){e.st(t,"observable"),this.Ki=t,this.Qi=null,this.Gn=!1}return n.prototype.start=function(e,n){this.Gn=!0,this.Qi=this.Ki.subscribe(t.noop,{listenForChanges:{callback:e,timeout:n||500}})},n.prototype.stop=function(){this.Gn=!1,this.Qi&&this.Qi.dispose(),this.Qi=null},n.prototype.isEnabled=function(){return this.Gn},n}.apply(e,i))||(t.exports=r)},function(t,e,n){var i,r;i=[n(0),n(1),n(27)],void 0===(r=function(t,e,n){"use strict";function i(t,i){var r=t;void 0!==r&&null!==r||(r=[]),e.isArray(r,"valuesToSet"),this.observableArray=new n(r,i)}return i.prototype.getValue=function(){return this.observableArray.getValue()},i.prototype.setValue=function(t){return void 0!==t&&null!==t||(t=[]),void 0!==t&&e.isArray(t,"values"),this.observableArray.setValue(t)},i.prototype.subscribe=function(t,e){return this.observableArray.subscribe(t,e)},i.prototype.push=function(t){var e=this.observableArray.getValue();e.push(t),this.observableArray.setValue(e)},i.prototype.pop=function(){var t=this.observableArray.getValue(),e=t.pop();return this.observableArray.setValue(t),e},i.prototype.remove=function(e){var n=this.observableArray.getValue(),i=function(n){return t.rt(e)?e(n):n===e},r=t.filter(n,i);return r.length>0&&this.observableArray.setValue(t.remove(n,i)),r},i.prototype.removeAll=function(){var t=this.observableArray.getValue();return this.observableArray.setValue([]),t},i.prototype.extend=function(t){return this.observableArray.extend(t),this},i}.apply(e,i))||(t.exports=r)},function(t,e,n){var i,r;i=[n(0)],void 0===(r=function(t){"use strict";function e(){this.Xi=[]}return e.prototype.add=function(e){if(!e||!t.rt(e.dispose))throw new Error('"disposable" must be a disposable or implement dispose');this.Xi.push(e)},e.prototype.dispose=function(){var e=[];return t.forEach(this.Xi,function(t){e.push(t.dispose())}),this.Xi=[],e},e.prototype.toString=function(){return t.toString(this)},e}.apply(e,i))||(t.exports=r)},function(t,e,n){var i,r;i=[n(0),n(1)],void 0===(r=function(t,e){"use strict";function n(t){e.rt(t,"cleanup"),this.Zi=t}return n.prototype.dispose=function(){return this.Zi.call()},n.prototype.toString=function(){return t.toString(this)},n}.apply(e,i))||(t.exports=r)},function(t,e,n){var i,r;i=[n(0)],void 0===(r=function(t){var e=function(){};return e.prototype.st=function(n,i){if(e.prototype.lt("name",i),!t.st(n))throw new Error('"'+i+'" must be an object. Received ['+typeof n+"]")},e.prototype.isArray=function(n,i){if(e.prototype.lt("name",i),!t.isArray(n))throw new Error('"'+i+'" must be an array. Received ['+typeof n+"]")},e.prototype.lt=function(e,n){if(!t.lt(n))throw new Error('"name" must be a string. Received ['+typeof n+"]");if(!t.lt(e))throw new Error('"'+n+'" must be a string. Received ['+typeof e+"]")},e.prototype.Jt=function(n,i){if(e.prototype.lt("name",i),!t.Jt(n))throw new Error('"'+i+'" must be a boolean. Received ['+typeof n+"]")},e.prototype.Dt=function(n,i){if(e.prototype.lt("name",i),!t.Dt(n))throw new Error('"'+i+'" must be a number. Received ['+typeof n+"]")},e.prototype.rt=function(n,i){if(e.prototype.lt("name",i),!t.rt(n))throw new Error('"'+i+'" must be a function. Received ['+typeof n+"]")},e.prototype.it=function(t,n){e.prototype.wt(t,n)},e.prototype.wt=function(t,n){if(e.prototype.lt("name",n),e.prototype.lt(t,n),""===t)throw new Error('"'+n+'" must not be empty')},e.prototype.$i=function(n,i,r){if(e.prototype.lt("name",r),!t.st(n))throw new Error('"'+r+'" must be an instance. Received ['+typeof n+"]");if(!(n instanceof i))throw new Error('"'+r+'" must be a valid instance of class '+t.get(i,["name"],"undefined"))},e.prototype.ti=function(n,i){if(e.prototype.lt("name",i),t.isUndefined(n))throw new Error('"'+i+'" must not be undefined')},e.prototype.bt=function(n,i,r){e.prototype.wt(r,"name");var s=t.getEnumName(i,n);if(t.isNullOrUndefined(s))throw new Error('"'+r+'" must be a valid type. Unable to locate type ['+n+"]");return s},e.prototype.Yi=function(n,i){e.prototype.lt(i,"name"),e.prototype.isArray(n,i),t.forEach(n,function(t,n){e.prototype.lt(t,i+"["+n+"]")})},new e}.apply(e,i))||(t.exports=r)},function(t,e,n){var i,r;i=[n(0)],void 0===(r=function(t){"use strict";function e(t){this.tr=t||""}return e.prototype.detect=function(){var e="Unknown",n="?",i=this.tr.match(/(Chrome|Chromium|Firefox|Opera|Safari)+\//),r=this.tr.match(/(Chrome|Chromium|Firefox|Version)+\/([0-9]+)\./),s=!1;return i&&i.length>=2?e=i[1]:this.tr.match(/^\(?Mozilla/)&&(e="Mozilla",(this.tr.match(/MSIE/)||this.tr.match(/; Trident\/.*rv:[0-9]+/))&&(e="IE",(r=this.tr.match(/MSIE ([0-9]+)/))?(n=parseInt(r[1],10),(r=this.tr.match(/MSIE [0-9]+.*MSIE ([0-9]+)/))&&(n=parseInt(r[1],10))):(r=this.tr.match(/rv:([0-9]+)/))&&(n=parseInt(r[1],10)))),"Chrome"===e&&this.tr.match(/OPR\//)?(e="Opera",r=this.tr.match(/(OPR)\/([0-9]+)\./)):"Chrome"===e&&this.tr.match(/Edge\//)?(e="Edge",r=this.tr.match(/(Edge)\/([0-9]+)\./)):"Firefox"!==e&&"IE"!==e||!this.tr.match(/Opera/)?"Mozilla"===e&&this.tr.match(/iphone|ipod|ipad/i)&&(e="Safari",n=parseInt(t.get(this.tr.match(/OS\s([0-9]+)/),[1]),10),s=!0):(e="Opera",r=this.tr.match(/(Opera) ([0-9]+)\./)),"Chrome"===e&&(this.tr.match(/; wv/)||this.tr.match(/Android/)&&this.tr.match(/Version\/[0-9].[0-9]/))&&(s=!0),"IE"!==e&&r&&r.length>=3&&(n=parseInt(r[2],10)),"ReactNative"===navigator.product&&(e="ReactNative",n=navigator.productSub||"?"),{browser:e,version:n,isWebview:s}},e}.apply(e,i))||(t.exports=r)},function(t,e,n){var i,r;i=[n(83)],void 0===(r=function(t){return t}.apply(e,i))||(t.exports=r)},function(t,e,n){var i;void 0===(i=function(){"use strict";var t=function(){};t.clone=function(e){return t.isArray(e)?e.slice():t.st(e)?t.assign({},e):e},t.get=function(e,n,r){if(t.isNullOrUndefined(e))return r;i(e,"objectToTraverse");var s=n;if(t.lt(s))s=o(n);else if(!t.isArray(s))throw new Error("Unsupported path type "+typeof n);var a=t.reduce(s,function(e,n){if(t.st(e)||t.isArray(e))return e[n]},e);return t.isUndefined(a)?r:a},t.set=function(e,n,r){if(!t.st(e))return e;i(e,"objectToTraverse");var s=e,a=n;if(t.lt(a))a=o(n);else if(!t.isArray(a))throw new Error("Unsupported path type "+typeof n);return t.forEach(a,function(e,n){!function(e,n,i){if(t.Dt(parseInt(n))&&t.isArray(e))return e[n]=i;if(t.lt(n)&&t.st(e))return e[n]=i;throw new Error("Unsupported type "+typeof n+" when setting property or index")}(s,e,function(e,n,i,r){if(e.length-1===n)return r;var s=e[n],o=e[n+1];if(t.isArray(i[s])||t.st(i[s]))return i[s];if(!t.isArray(i[s])&&t.Dt(parseInt(o)))return[];if(!t.st(i[s])&&t.lt(o))return{};throw new Error("Unsupported type "+typeof s+" when setting property or index")}(a,n,s,r)),s=s[e]}),e},t.bind=function(e,n){var i=Array.prototype.slice.call(arguments,2);return function(){if(!t.rt(e))throw new TypeError("_.bind - callback must be a function. Received ["+typeof e+"]");var r=i.concat(Array.prototype.slice.call(arguments));return e.apply(n,r)}},t.now=function(){return(new Date).getTime()},t.utc=function(e){return t.Dt(e)?e:e?Math.floor(e):NaN},t.isoString=function(){var e=new Date;return e.toISOString?e.toISOString():e.getUTCFullYear()+"-"+t.pad(e.getUTCMonth()+1,2)+"-"+t.pad(e.getUTCDate(),2)+"T"+t.pad(e.getUTCHours(),2)+":"+t.pad(e.getUTCMinutes(),2)+":"+t.pad(e.getUTCSeconds(),2)+"."+(e.getUTCMilliseconds()/1e3).toFixed(3).slice(2,5)+"Z"},t.map=function(e,n){i(e,"collection");var r=[];return e.constructor===Array?t.forEach(e,function(e,i){t.lt(n)&&t.st(e)?r.push(e[n]):t.rt(n)&&r.push(n(e,i))}):t.forOwn(e,function(e,i){t.rt(n)&&r.push(n(e,i))}),r},t.values=function(e){if(!t.st(e)||t.isArray(e))throw new Error("_.values argument, Collection, must be an object. Received ["+typeof e+"]");return t.map(e,function(t){return t})},t.keys=function(e){if(!t.st(e)||t.isArray(e))throw new Error("_.keys argument, Collection, must be an object. Received ["+typeof e+"]");return t.map(e,function(t,e){return e})},t.forEach=function(n,i){if(!t.rt(i))throw new Error("_.forEach argument, Callback, must be a function. Received ["+typeof i+"]");e(n,"collection");for(var r=0;r<n.length;r++)if(!1===i(n[r],r))return},t.forOwn=function(e,n){if(!t.rt(n))throw new Error("Callback must be a function. Received ["+typeof n+"]");i(e,"objectWithProperties");for(var r=Object.keys(e),s=0;s<r.length;s++){var o=r[s];(e.hasOwnProperty(o)||Object.prototype.hasOwnProperty.call(e,o))&&n(e[o],o)}},t.argumentsToArray=function(e){if(!t.st(e)||!e.length)throw new Error("Collection must be arguments. Received ["+typeof e+"]");for(var n=[],i=0;i<e.length;i++)n.push(e[i]);return n},t.assign=function(e){t.isNullOrUndefined(e)&&(e={}),i(e,"target");var n=t.argumentsToArray(arguments);return n.shift(),t.forEach(n,function(n,r){t.isNullOrUndefined(n)||(i(n,"_.assign(sources["+r+"])"),t.forOwn(n,function(t,n){e[n]=t}))}),e},t.includes=function(e,n){if(t.lt(e))return s(n,"Includes value and search parameter"),e.indexOf(n)>-1;if(t.isUndefined(e)||t.isUndefined(n))return!1;i(e,"collection");var r=!1,o=function(t){t===n&&(r=!0)};return e.constructor===Array?t.forEach(e,o):t.forOwn(e,o),r},t.reduce=function(e,n,r){i(e,"collection");var s=r===t.noop()?null:r;return e.constructor===Array?t.forEach(e,function(t,e){s=n(s,t,e)}):t.forOwn(e,function(t,e){s=n(s,t,e)}),s},t.sample=function(t){return e(t,"collection"),t[Math.floor(Math.random()*t.length)]},t.uniqueId=function(){return(t.now()*Math.random()).toString()},t.find=function(n,i,r){var s;return e(n,"collection"),t.forEach(n,function(t,e){if(i(t)&&e>=(r||0))return s=t}),s},t.findIndex=function(n,i,r){var s;return e(n,"collection"),t.forEach(n,function(t,e){if(i(t,e)&&e>=(r||0))return s=e}),s},t.filter=function(n,i){e(n,"collection");var r=[];return t.forEach(n,function(t){i(t)&&r.push(t)}),r},t.remove=function(n,i){return e(n,"collection"),t.filter(n,function(t){return!i(t)})},t.take=function(t,n){return e(t,"collection"),t.slice(0,n)},t.hasDifferences=function(e,n,i){return t.findDifferences(e,n,i).length>0},t.findDifferences=function(e,n,i){var r=[],s={};function o(o,a){s[a]=1,(t.st(o)||t.isArray(o))&&i?t.hasIndexOrKey(n,a)&&t.sameTypes(e[a],n[a])?t.hasDifferences(e[a],n[a],i)&&r.push(a):r.push(a):e[a]!==n[a]&&r.push(a)}if(t.isArray(e)&&t.isArray(n))e.length>n.length?t.forEach(e,o):t.forEach(n,o);else{if(!t.st(e)||!t.st(n)||t.isArray(e)||t.isArray(n))throw new Error("Object types do not match");t.forOwn(e,o),t.forOwn(n,function(t,e){s.hasOwnProperty(e)||r.push(e)})}return r},t.hasIndexOrKey=function(e,n){return t.isArray(e)?e.length>parseInt(n):!!t.st(e)&&e.hasOwnProperty(n)},t.startsWith=function(t,e){return s(t,"value"),s(e,"prefix"),0===t.indexOf(e)},t.sameTypes=function(e,n){return t.isNullOrUndefined(e)||t.isNullOrUndefined(n)?t.isNullOrUndefined(e)&&t.isNullOrUndefined(n):t.isArray(e)||t.isArray(n)?t.isArray(e)&&t.isArray(n):typeof e==typeof n},t.freeze=function(t){return"freeze"in Object?Object.freeze(t):t},t.noop=function(){},t.st=function(t){return null!==t&&"object"==typeof t},t.isArray=function(e){return!!t.st(e)&&e.constructor===Array},t.lt=function(t){return"string"==typeof t},t.Dt=function(t){return!isNaN(t)&&"number"==typeof t},t.Jt=function(t){return"boolean"==typeof t},t.rt=function(t){return"function"==typeof t},t.isNullOrUndefined=function(e){return null===e||t.isUndefined(e)},t.isUndefined=function(t){return void 0===t},t.getEnumName=function(e,n){var i=null,r=t.map(e,function(t){return t});return t.Dt(n)?i=t.find(r,function(t){return t.id===n}):t.lt(n)&&(i=t.find(r,function(t){return t.name.toLowerCase()===n.toLowerCase()})),i?i.name:null},t.toString=function(e){if(t.lt(e))return e;if(t.Jt(e))return e?"true":"false";if(t.Dt(e))return e.toString();var n="";if(e)if(t.rt(e.toString))n=e.toString();else if(t.st(e.toString))try{n=e.toString()}catch(t){n="[object invalid toString()]"}if(0!==n.indexOf("[object"))return n;var i=[];return n+JSON.stringify(e,function(e,n){if(t.st(n)&&!t.isNullOrUndefined(n)){if(t.includes(i,n))return"<recursive>";i.push(n)}return""===e?n:t.toString(n)})},t.pad=function(t,e){n(t,"value"),n(e,"numberToPad");for(var i=t.toString().length,r=0;r<e-i;r++)t="0"+t.toString();return t.toString()},t.addEventListener=function(t,e,n,o){i(t,"target"),s(e,"eventName"),r(n,"listener"),t.phenixAddEventListener?t.phenixAddEventListener.call(t,e,n,!!o):t.addEventListener?t.addEventListener(e,n,!!o):t.attachEvent&&t.attachEvent("on"+e,n)},t.removeEventListener=function(t,e,n,o){i(t,"target"),s(e,"eventName"),r(n,"listener"),t.phenixRemoveEventListener?t.phenixRemoveEventListener.call(t,e,n,!!o):t.removeEventListener?t.removeEventListener(e,n,!!o):t.detachEvent&&t.detachEvent("on"+e,n)};var e=function(e){if(!t.isArray(e))throw new Error("Input must be an array. Received ["+typeof e+"]")},n=function(e,n){if(s(n,"name"),!t.Dt(e))throw new Error(n+" must be a number. Received ["+typeof e+"]")},i=function(e,n){if(s(n,"name"),!t.st(e))throw new Error("collection type not supported - "+n+" must be an array or object. Received ["+typeof e+"]")},r=function(e,n){if(s(n,"name"),!t.rt(e))throw new Error(n+" must be a function. Received ["+typeof e+"]")},s=function(e,n){if(!t.lt(n))throw new Error("Name must be a string. Received ["+typeof n+"]");if(!t.lt(e))throw new Error(n+" must be a string. Received ["+typeof e+"]")};function o(e){var n=e.split("."),i=[];return t.forEach(n,function(e){i=i.concat(function(e){for(var n="",i=[],r=0,s=0;s<e.length;s++)if("["===e[s]){if(r++,!t.lt(n)||r>1)return[e];n&&(i.push(n),n="")}else if("]"===e[s]){if(0!=--r)return[e];i.push(n),n=""}else{if(s===e.length-1)return[e];n+=e[s]}return i}(e))}),i}return t}.apply(e,[]))||(t.exports=i)},function(t,e,n){"use strict";var i,r;i=[n(2),n(10),n(25),n(17),n(29),n(16)],void 0===(r=function(t,e,n,i,r,s){return t.global.PhenixPCast=n,{express:{PCastExpress:r},lowLevel:{PCast:n},media:{UserMediaResolver:i},net:{AdminApiProxyClient:s},utils:{logging:e,rtc:t},logging:e,PCast:n,RTC:t,UserMediaResolver:i}}.apply(e,i))||(t.exports=r)}])});